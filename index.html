<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>AW139 ÁGUILA 1 – Checklist</title>

<!-- --- PWA MANIFEST --- -->
<link rel="manifest" href="/aw139_CheckList/manifest.json">

<!-- --- PWA / iOS HOME SCREEN --- -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="ÁGUILA-1 AW139">
<meta name="mobile-web-app-capable" content="yes">
<meta name="theme-color" content="#0a0d14">

<!-- App icons + favicon -->
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" href="favicon.ico">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="192x192" href="icon-192.png">
<link rel="icon" type="image/png" sizes="512x512" href="icon-512.png">



<style>
  /* --- SPLASH SCREEN --- */
  #splash {
    position: fixed; inset: 0; z-index: 9999;
    background: #0a0d14;
    display: flex; flex-direction: column;
    align-items: center; justify-content: center; gap: 20px;
    transition: opacity 0.6s ease;
  }
  #splash.hidden { opacity: 0; pointer-events: none; }
  .splash-helo {
    width: 120px; height: 120px;
    object-fit: contain;
    filter: drop-shadow(0 0 12px rgba(201,168,76,0.35));
  }
  .splash-title {
    font-family: 'Bebas Neue', 'Arial Narrow', sans-serif;
    font-size: 36px; letter-spacing: 6px; color: #c9a84c;
    text-align: center;
  }
  .splash-sub {
    font-family: 'Courier New', monospace;
    font-size: 11px; letter-spacing: 3px;
    color: #3a5070; text-align: center; line-height: 1.8;
  }
  .splash-bar-wrap {
    width: 160px; height: 3px; background: #1a2535; border-radius: 2px; overflow: hidden;
  }
  .splash-bar {
    height: 100%; width: 0%; background: linear-gradient(90deg, #c9a84c, #ffdd80);
    border-radius: 2px; animation: splashload 1.4s ease forwards;
  }
  @keyframes splashload { to { width: 100%; } }

  /* --- iOS SAFE AREA --- */
  body { padding-top: env(safe-area-inset-top); }
  #sidebar { padding-bottom: env(safe-area-inset-bottom); }
</style>

<style>
  @import url('https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Share+Tech+Mono&family=Barlow+Condensed:wght@400;600;700&display=swap');

  /* --- PALETA NOCTURNA (defecto) --- */
  :root {
    --bg: #1a1f2e;
    --panel: #1e2538;
    --border: #2e3a50;
    --gold: #e8c060;
    --red: #dd2222;
    --amber: #f09800;
    --green: #2a8a3b;
    --text: #eef2ff;
    --dim: #8a96b0;
    --header-bg: #111828;
    --row-alt: #1e2638;
    --row-hover: #252e42;
    --accent: #4a6abf;
    --white: #ffffff;
    --title: #c8dd40;
  }

  /* --- PALETA DIURNA --- */
  :root[data-mode="day"] {
    --bg: #d8dce8;
    --panel: #e4e8f0;
    --border: #a0aabf;
    --gold: #7a5a00;
    --red: #b81010;
    --amber: #b06000;
    --green: #1a6828;
    --text: #0a0e1a;
    --dim: #3a4460;
    --header-bg: #bcc4d8;
    --row-alt: #cdd2e0;
    --row-hover: #b8c0d4;
    --accent: #1a40a0;
    --white: #0a0e1a;
    --title: #1a4a00;
  }

  /* Ajustes día para colores hardcoded */
  :root[data-mode="day"] .nav-btn.blue.active  { background: #b0c0e0 !important; color: #0a2060 !important; }
  :root[data-mode="day"] .nav-btn.teal.active  { background: #a0d4cc !important; color: #004438 !important; }
  :root[data-mode="day"] .nav-btn.olive.active { background: #c0d880 !important; color: #1a3800 !important; }
  :root[data-mode="day"] .nav-btn.amber.active { background: #f0c860 !important; color: #3a1800 !important; }
  :root[data-mode="day"] .nav-btn.red.active   { background: #f0a0a0 !important; color: #3a0000 !important; }
  :root[data-mode="day"] .row-repeat           { background: linear-gradient(90deg,#f8e090,#ffe8a0,#f8e090) !important; }
  :root[data-mode="day"] .row-repeat td        { color: #6a3800 !important; }
  :root[data-mode="day"] .banner.note          { background: #c8d8f0 !important; color: #1a3080 !important; border-color: #6090d0 !important; }
  :root[data-mode="day"] .row-note td          { color: #3a4460 !important; background: #ccd4e4 !important; }
  :root[data-mode="day"] .info-block           { background: #c8d4ec !important; border-color: #3a60b0 !important; }
  /* -------------------------------------------------------
     PALETA NVG – MIL-STD-3009 Clase A compatible
     Principio: Canal R=0 en todos los colores base.
     Rango espectral seguro: 450–580 nm (azul-verde).
     Los intensificadores Gen III (GaAs) son sensibles
     600–930 nm – fuera de este rango = NVG-safe.
     Luminancia mínima para preservar adaptación escotópica.
  -------------------------------------------------------- */
  :root[data-mode="nvg"] {
    /* Fondos – negro puro + azul profundo ~460nm, R=0 */
    --bg:        #000000;   /* Cero emisión total */
    --panel:     #000810;   /* Azul muy oscuro, R=0 */
    --border:    #002818;   /* Verde oscuro ~535nm, R=0 */
    --header-bg: #000510;   /* Azul-negro, R=0 */
    --row-alt:   #000C10;   /* Fondo alterno sutil, R=0 */
    --row-hover: #001A14;   /* Hover verde-negro, R=0 */

    /* Texto – verde NVIS Green A (~530nm), R=0 */
    --text:   #00AA44;      /* Texto principal – pico bastones ~507nm */
    --dim:    #005522;      /* Texto secundario – luminancia reducida */
    --white:  #55AA77;      /* NVIS White equiv. – azul-verde, R=0 */
    --title:  #00CC44;      /* TÍtulos – verde brillante, R=0 */

    /* Colores funcionales – todos R=0 */
    --gold:   #00AA00;      /* Reemplaza dorado ? verde NVIS */
    --green:  #008833;      /* Verde confirmación */
    --accent: #0055AA;      /* Azul ~470nm – fuera banda NVG completamente */
    --amber:  #00BB00;      /* Reemplaza ámbar ? verde intenso */

    /* WARNING: verde intenso + pulso. Rojo PROHIBIDO con NVG */
    --red:    #00CC22;      /* Reemplaza rojo ? verde brillante pulsante */
  }

  /* Overrides hardcoded para NVG – R=0 absoluto */
  :root[data-mode="nvg"] .nav-btn.blue.active  { background: #001830 !important; color: #0077CC !important; }
  :root[data-mode="nvg"] .nav-btn.teal.active  { background: #001A14 !important; color: #00AA77 !important; }
  :root[data-mode="nvg"] .nav-btn.olive.active { background: #001400 !important; color: #00BB33 !important; }
  :root[data-mode="nvg"] .nav-btn.amber.active { background: #001800 !important; color: #00DD22 !important; }
  :root[data-mode="nvg"] .nav-btn.red.active   { background: #001800 !important; color: #00EE33 !important; border-left-color: #00CC22 !important; }
  :root[data-mode="nvg"] .nav-btn.red          { border-left-color: #00AA22 !important; }
  :root[data-mode="nvg"] .nav-btn              { color: #005522; }
  :root[data-mode="nvg"] .nav-btn:hover        { color: #00AA44; }

  /* Filas especiales NVG */
  :root[data-mode="nvg"] .row-repeat {
    background: linear-gradient(90deg, #001800, #002200, #001800) !important;
    border-top: 1px solid #00AA00 !important;
    border-bottom: 1px solid #00AA00 !important;
  }
  :root[data-mode="nvg"] .row-repeat td        { color: #00DD22 !important; }
  :root[data-mode="nvg"] .banner.red           { background: #001800 !important; color: #00EE33 !important; animation: nvgPulse 1.2s ease-in-out infinite; }
  :root[data-mode="nvg"] .banner.amber         { background: #001400 !important; color: #00CC22 !important; animation: nvgPulse 2s ease-in-out infinite; }
  :root[data-mode="nvg"] .banner.note          { background: #000C18 !important; color: #0077CC !important; border-color: #003388 !important; }
  :root[data-mode="nvg"] .row-note td          { color: #005522 !important; background: #000810 !important; }
  :root[data-mode="nvg"] .info-block           { background: #000810 !important; border-color: #003388 !important; color: #005599 !important; }
  :root[data-mode="nvg"] .cl-table tr.checked .item-name { color: #003318 !important; }
  :root[data-mode="nvg"] .cl-table tr.checked .check-box { background: #005522 !important; border-color: #008833 !important; }
  :root[data-mode="nvg"] .ff-row               { border-left-color: #00AA22 !important; background: #001200 !important; }
  :root[data-mode="nvg"] .cl-table tr.ff-row td.item-name { color: #00CC44 !important; }
  :root[data-mode="nvg"] .first-flight-badge   {
    background: linear-gradient(90deg, #001800, #003300, #001800) !important;
    border-color: #00AA22 !important;
    color: #00EE33 !important;
  }
  :root[data-mode="nvg"] #topbar               { border-bottom-color: #00AA44 !important; }
  :root[data-mode="nvg"] .cl-section-header    { border-bottom-color: #008833 !important; }
  :root[data-mode="nvg"] .sidebar-logo .aircraft { color: #00AA44 !important; }
  :root[data-mode="nvg"] .sidebar-logo .aircraft span { color: #00CC22 !important; }
  :root[data-mode="nvg"] .progress-fill        { background: linear-gradient(90deg, #008833, #00CC44) !important; }

  /* Animación pulso NVG para warnings */
  @keyframes nvgPulse {
    0%, 100% { opacity: 1; box-shadow: 0 0 0px #00CC22; }
    50%       { opacity: 0.6; box-shadow: 0 0 8px #00AA0066; }
  }

  /* Topbar NVG badge */
  :root[data-mode="nvg"] #topbar .meta         { color: #005522 !important; }
  :root[data-mode="nvg"] #topbar .section-title { color: #00AA44 !important; }
  :root[data-mode="nvg"] .check-box            { border-color: #003318 !important; }
  :root[data-mode="nvg"] .reset-btn            { color: #005522 !important; border-color: #003318 !important; }
  :root[data-mode="nvg"] .reset-btn:hover      { background: #001800 !important; color: #00CC22 !important; border-color: #00AA22 !important; }
  :root[data-mode="nvg"] .check-all-btn        { color: #005522 !important; border-color: #003318 !important; }
  :root[data-mode="nvg"] .check-all-btn:hover  { background: #001800 !important; color: #00CC22 !important; border-color: #00AA22 !important; }
  :root[data-mode="nvg"] .progress-label       { color: #005522 !important; }

  /* Indicador NVG en el topbar */
  .nvg-badge {
    display: none;
    font-family: 'Share Tech Mono', monospace;
    font-size: 9px;
    letter-spacing: 2px;
    color: #00AA44;
    border: 1px solid #008833;
    padding: 2px 8px;
    border-radius: 2px;
    animation: nvgPulse 3s ease-in-out infinite;
  }
  :root[data-mode="nvg"] .nvg-badge { display: inline-block; }



  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'Barlow Condensed', sans-serif;
    font-size: 18px;
    display: flex;
    height: 100vh;
    overflow: hidden;
  }

  .update-banner {
    position: fixed;
    left: 50%;
    bottom: calc(env(safe-area-inset-bottom) + 16px);
    transform: translateX(-50%);
    display: none;
    align-items: center;
    gap: 10px;
    padding: 8px 12px;
    background: #0f1522;
    border: 1px solid var(--accent);
    border-radius: 10px;
    box-shadow: 0 10px 24px rgba(0,0,0,0.35);
    z-index: 10000;
    font-size: 12px;
    letter-spacing: 0.4px;
  }
  .update-banner.show { display: inline-flex; }
  .update-banner button {
    background: var(--gold);
    color: #1a1a1a;
    border: none;
    padding: 6px 10px;
    border-radius: 8px;
    font-weight: 700;
    cursor: pointer;
  }
  .update-banner button:hover { filter: brightness(1.05); }
  .update-banner button:active { transform: translateY(1px); }
  @media (max-width: 520px) {
    .update-banner { width: calc(100% - 24px); justify-content: space-between; }
  }

  /* -- SIDEBAR -- */
  #sidebar {
    width: 138px;
    min-width: 138px;
    background: var(--header-bg);
    border-right: 2px solid var(--border);
    display: flex;
    flex-direction: column;
    align-items: stretch;
    overflow-y: auto;
    z-index: 10;
  }

  .sidebar-logo {
    padding: 10px 8px 8px;
    text-align: center;
    border-bottom: 1px solid var(--border);
    flex-shrink: 0;
  }
  .sidebar-logo .shield {
    width: 56px;
    height: 56px;
    object-fit: contain;
    margin: 2px auto 6px;
    filter: drop-shadow(0 0 10px rgba(201,168,76,0.35));
    display: block;
  }
  .sidebar-logo .aircraft {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 26px;
    color: var(--text);
    letter-spacing: 2px;
  }
  .sidebar-logo .aircraft span { color: var(--red); }
  .sidebar-logo .sub {
    font-family: 'Share Tech Mono', monospace;
    font-size: 8px;
    color: var(--dim);
    letter-spacing: 1px;
    margin-top: 2px;
  }

  .nav-btn {
    width: 100%;
    padding: 0;
    flex: 1;
    min-height: 52px;
    background: transparent;
    border: none;
    border-bottom: 1px solid var(--border);
    color: var(--dim);
    font-family: 'Barlow Condensed', sans-serif;
    font-size: 14px;
    font-weight: 700;
    letter-spacing: 0.8px;
    text-transform: uppercase;
    text-align: center;
    cursor: pointer;
    transition: all 0.15s;
    line-height: 1.25;
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .nav-btn::before {
    content: '';
    position: absolute;
    left: 0; top: 0; bottom: 0;
    width: 3px;
    background: transparent;
    transition: background 0.15s;
  }
  .nav-btn:hover {
    background: var(--row-hover);
    color: var(--text);
  }
  .nav-btn:hover::before { background: var(--accent); }
  .nav-btn.active {
    background: #1a2236;
    color: var(--white);
  }
  .nav-btn.active::before { background: var(--gold); }

  .nav-btn.olive  { border-left: 3px solid #7a9a2a; }
  .nav-btn.olive.active  { background: #111a04; color: #b8d44a; }
  .nav-btn.olive.active::before { background: #7a9a2a; }
  .nav-btn.blue   { border-left: 3px solid #3a6abf; }
  .nav-btn.teal   { border-left: 3px solid #1a9a8a; }
  .nav-btn.amber  { border-left: 3px solid var(--amber); }
  .nav-btn.red    { border-left: 3px solid var(--red); }

  .nav-btn.blue.active  { background: #0e1a30; color: #7ab0ff; }
  .nav-btn.blue.active::before { background: #3a6abf; }
  .nav-btn.teal.active  { background: #061e1b; color: #3de0cc; }
  .nav-btn.teal.active::before { background: #1a9a8a; }
  .nav-btn.amber.active { background: #2a1a00; color: #ffb940; }
  .nav-btn.amber.active::before { background: var(--amber); }
  .nav-btn.red.active   { background: #2a0a0a; color: #ff6b6b; }
  .nav-btn.red.active::before   { background: var(--red); }

  /* -- MAIN -- */
  #main {
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }

  #topbar {
    background: var(--header-bg);
    border-bottom: 2px solid var(--gold);
    padding: 10px 20px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-shrink: 0;
  }
  #topbar .section-title {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 26px;
    letter-spacing: 3px;
    color: var(--white);
  }
  #topbar .meta {
    font-family: 'Share Tech Mono', monospace;
    font-size: 12px;
    color: var(--dim);
    text-align: right;
    line-height: 1.6;
  }
  #topbar .pilot-cols {
    font-family: 'Share Tech Mono', monospace;
    font-size: 10px;
    color: var(--dim);
    letter-spacing: 2px;
  }

  #content {
    flex: 1;
    overflow-y: auto;
    padding: 0;
  }

  /* -- SECTION PANELS -- */
  .section-panel { display: none; }
  .section-panel.active { display: block; }

  /* -- CHECKLIST TABLE -- */
  .cl-section {
    margin: 16px 20px;
  }
  .cl-section-header {
    background: var(--header-bg);
    border: 1px solid var(--border);
    border-bottom: 2px solid var(--gold);
    padding: 9px 14px;
    font-family: 'Bebas Neue', sans-serif;
    font-size: 19px;
    letter-spacing: 2px;
    color: var(--title);
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0;
  }
  .cl-section-header .sub-note {
    font-family: 'Barlow Condensed', sans-serif;
    font-size: 13px;
    font-weight: 400;
    color: var(--gold);
    letter-spacing: 1px;
  }

  .cl-table {
    width: 100%;
    border-collapse: collapse;
  }
  .cl-table tr {
    border-bottom: 1px solid #1e2535;
    cursor: pointer;
    transition: background 0.1s;
  }
  .cl-table tr:nth-child(even) { background: var(--row-alt); }
  .cl-table tr:hover { background: var(--row-hover); }
  .cl-table tr.checked .item-num { color: var(--green); }
  .cl-table tr.checked .item-name { text-decoration: line-through; color: var(--dim); opacity: 0.6; }
  .cl-table tr.checked .item-action { color: var(--green); opacity: 0.7; }
  .cl-table tr.checked .check-box { background: var(--green); border-color: var(--green); }
  .cl-table tr.checked .check-box::after { content: '✓'; color: white; font-size: 10px; }

  .cl-table td {
    padding: 9px 10px;
    font-size: 16px;
    vertical-align: middle;
  }
  .item-num {
    width: 34px;
    text-align: right;
    color: var(--dim);
    font-family: 'Share Tech Mono', monospace;
    font-size: 13px;
    padding-right: 6px;
  }
  .item-name {
    color: var(--text);
    font-weight: 600;
    letter-spacing: 0.3px;
  }
  .item-name .note {
    font-weight: 400;
    font-size: 13px;
    color: var(--dim);
    font-style: italic;
  }
  .item-action {
    text-align: right;
    color: var(--gold);
    font-family: 'Share Tech Mono', monospace;
    font-size: 14px;
    letter-spacing: 0.5px;
    font-weight: 700;
    padding-right: 12px;
  }
  .check-col {
    width: 36px;
    text-align: center;
  }
  .check-box {
    width: 18px;
    height: 18px;
    border: 1.5px solid var(--border);
    border-radius: 2px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-size: 0;
    transition: all 0.15s;
    margin: auto;
  }

  /* special rows */
  .row-note {
    background: #0f1520 !important;
    border-top: 1px solid #253050;
    border-bottom: 1px solid #253050;
  }
  .row-note td {
    color: var(--dim);
    font-size: 11px;
    font-style: italic;
    text-align: center;
    padding: 5px 14px;
    letter-spacing: 0.5px;
    font-family: 'Share Tech Mono', monospace;
  }
  /* -- REPEAT ENGINE row – high visibility -- */
  .row-repeat {
    background: linear-gradient(90deg, #1a0e00, #2a1800, #1a0e00) !important;
    border-top: 1px solid #e88f00 !important;
    border-bottom: 1px solid #e88f00 !important;
    animation: repeatPulse 3s ease-in-out infinite;
  }
  .row-repeat td {
    color: #ffb940;
    font-size: 12px;
    font-family: 'Barlow Condensed', sans-serif;
    font-weight: 700;
    font-style: normal;
    text-align: center;
    letter-spacing: 2px;
    padding: 7px 5px;
    text-transform: uppercase;
  }
  .row-repeat td::before { content: '↻ '; font-size: 13px; }
  @keyframes repeatPulse {
    0%, 100% { box-shadow: inset 0 0 0px #e88f00; }
    50%       { box-shadow: inset 0 0 10px #e88f0044; }
  }

  .cl-table tr:has(.item-name:-webkit-contains("→")) {
    background: #160e03 !important;
  }
  /* Target rows whose item-name starts with → */
  .cl-table td.item-name[data-ff="1"] {
    color: #ffb060;
    font-weight: 600;
  }
  .cl-table tr.ff-row {
    background: #160e03 !important;
    border-left: 2px solid #c94400;
  }
  .cl-table tr.ff-row td.item-name {
    color: #ffb060;
    font-weight: 600;
  }
  .cl-table tr.ff-row td.item-num {
    color: #ff7a30;
    font-weight: 700;
  }
  .first-flight-badge {
    display: inline-flex;
    align-items: center;
    gap: 5px;
    background: linear-gradient(90deg, #7a2a00, #c94400, #7a2a00);
    color: #fff;
    font-family: 'Barlow Condensed', sans-serif;
    font-size: 11px;
    font-weight: 700;
    letter-spacing: 2px;
    padding: 2px 10px 2px 8px;
    border-radius: 2px;
    text-transform: uppercase;
    border: 1px solid #ff6a20;
    animation: ffPulse 2.5s ease-in-out infinite;
    white-space: nowrap;
    vertical-align: middle;
    margin-left: 6px;
  }
  @keyframes ffPulse {
    0%, 100% { opacity: 1; box-shadow: 0 0 0px #ff6a20; }
    50%       { opacity: 0.85; box-shadow: 0 0 8px #ff6a2088; }
  }

  /* banner rows */
  .banner {
    margin: 8px 20px 0;
    padding: 8px 14px;
    font-family: 'Bebas Neue', sans-serif;
    font-size: 14px;
    letter-spacing: 2px;
    text-align: center;
    border-radius: 2px;
  }
  .banner.red    { background: var(--red); color: #fff; }
  .banner.amber  { background: var(--amber); color: #0a0800; }
  .banner.note   { background: #1a2236; color: var(--gold); border: 1px solid var(--accent); }

  /* reset bar */
  .reset-bar {
    display: flex;
    justify-content: flex-end;
    padding: 8px 20px 4px;
    gap: 10px;
  }
  .reset-btn, .check-all-btn {
    font-family: 'Barlow Condensed', sans-serif;
    font-size: 11px;
    font-weight: 700;
    letter-spacing: 1px;
    text-transform: uppercase;
    padding: 5px 14px;
    border: 1px solid var(--border);
    border-radius: 2px;
    cursor: pointer;
    transition: all 0.15s;
    background: transparent;
  }
  .reset-btn { color: var(--dim); }
  .reset-btn:hover { background: var(--red); color: #fff; border-color: var(--red); }
  .check-all-btn { color: var(--dim); }
  .check-all-btn:hover { background: var(--green); color: #fff; border-color: var(--green); }

  /* Progress bar */
  .progress-bar-wrap {
    padding: 0 20px 12px;
    display: flex;
    align-items: center;
    gap: 12px;
  }
  .progress-bar {
    flex: 1;
    height: 4px;
    background: var(--border);
    border-radius: 2px;
    overflow: hidden;
  }
  .progress-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--green), #4adf70);
    transition: width 0.3s;
  }
  .progress-label {
    font-family: 'Share Tech Mono', monospace;
    font-size: 10px;
    color: var(--dim);
    white-space: nowrap;
  }

  /* -- PROFILES -- */
  .prof-tab {
    flex: 1; padding: 10px 8px;
    background: transparent; border: none; border-bottom: 3px solid transparent;
    color: var(--dim); font-family: 'Barlow Condensed', sans-serif;
    font-size: 13px; font-weight: 700; letter-spacing: 1.5px; text-transform: uppercase;
    cursor: pointer; transition: all 0.15s;
  }
  .prof-tab:hover { color: var(--text); background: #0d1520; }
  .prof-tab.active { color: #b8d44a; border-bottom-color: #7a9a2a; background: #0d1a06; }

  .prof-card {
    min-width: 80px; padding: 8px 10px;
    background: #0d1520; border: 1px solid var(--border);
    color: var(--dim); font-family: 'Barlow Condensed', sans-serif;
    font-size: 12px; font-weight: 700; letter-spacing: 0.8px; text-transform: uppercase;
    text-align: center; cursor: pointer; border-radius: 3px; line-height: 1.4;
    transition: all 0.15s;
  }
  .prof-card small { font-size: 9px; font-weight: 400; letter-spacing: 0.5px; display: block; color: var(--dim); }
  .prof-card:hover { border-color: #7a9a2a; color: var(--text); background: #111a06; }
  .prof-card.active { background: #7a9a2a; border-color: #9ac030; color: #fff; }
  .prof-card.active small { color: #d4f08a; }
  .prof-card.cat-a { border-color: #2a4a6a; }
  .prof-card.cat-a:hover { border-color: #4a8aaa; }

  /* phase blocks */
  .phase-block {
    background: #0a1220; border: 1px solid #1a2a3a;
    border-radius: 3px; margin-bottom: 10px; overflow: hidden;
  }
  .phase-header {
    display: flex; align-items: center; gap: 10px;
    padding: 8px 12px; background: #0d1828;
    border-bottom: 1px solid #1a2a3a;
  }
  .phase-badge {
    font-family: 'Bebas Neue', sans-serif; font-size: 11px;
    letter-spacing: 2px; padding: 2px 8px; border-radius: 2px;
    white-space: nowrap;
  }
  .phase-title {
    font-family: 'Barlow Condensed', sans-serif; font-size: 13px;
    font-weight: 700; letter-spacing: 1px; color: var(--text); text-transform: uppercase;
  }
  .phase-body { padding: 10px 12px; }
  .param-grid {
    display: grid; grid-template-columns: repeat(auto-fill, minmax(170px, 1fr));
    gap: 8px;
  }
  .param-item {
    background: #060e18; border: 1px solid #1a2535;
    border-radius: 2px; padding: 7px 10px;
  }
  .param-label {
    font-family: 'Share Tech Mono', monospace; font-size: 9px;
    color: var(--dim); letter-spacing: 1px; margin-bottom: 3px; text-transform: uppercase;
  }
  .param-value {
    font-family: 'Barlow Condensed', sans-serif; font-size: 15px;
    font-weight: 700; color: #c9a84c; letter-spacing: 0.5px;
  }
  .param-value.green { color: #4adf70; }
  .param-value.red   { color: #ff6b6b; }
  .param-value.blue  { color: #7ab0ff; }
  .param-value.white { color: #eef2ff; }

  /* contingency sub-tabs */
  .cont-tabs { display: flex; gap:0; border-bottom: 1px solid #1a2a3a; margin-bottom: 0; }
  .cont-tab {
    flex: 1; padding: 6px 4px; background: transparent; border: none;
    border-bottom: 2px solid transparent; color: var(--dim);
    font-family: 'Barlow Condensed', sans-serif; font-size: 11px;
    font-weight: 700; letter-spacing: 1px; cursor: pointer; transition: all 0.15s;
    text-transform: uppercase;
  }
  .cont-tab:hover { background: #0d1828; color: var(--text); }
  .cont-tab.rto { border-bottom-color: transparent; }
  .cont-tab.rto.active { color: #ffb940; border-bottom-color: #e88f00; background: #1a0e00; }
  .cont-tab.cto { border-bottom-color: transparent; }
  .cont-tab.cto.active { color: #4adf70; border-bottom-color: #2a7a3b; background: #041208; }
  .cont-tab.oei { border-bottom-color: transparent; }
  .cont-tab.oei.active { color: #ff9a4a; border-bottom-color: #c05020; background: #180800; }
  .cont-tab.blk { border-bottom-color: transparent; }
  .cont-tab.blk.active { color: #7ab0ff; border-bottom-color: #3a6abf; background: #060e20; }
  .cont-pane { display: none; padding: 10px 0 0; }
  .cont-pane.active { display: block; }

  .prof-note {
    margin: 6px 0; padding: 6px 10px; background: #08121e;
    border-left: 2px solid #2a4a6a; font-family: 'Share Tech Mono', monospace;
    font-size: 10px; color: #5a7a9a; line-height: 1.6; letter-spacing: 0.3px;
  }
  .phase-divider {
    display: flex; align-items: center; gap: 8px;
    margin: 6px 0; font-family: 'Share Tech Mono', monospace;
    font-size: 9px; color: #2a4a5a; letter-spacing: 2px;
  }
  .phase-divider::before, .phase-divider::after {
    content: ''; flex: 1; height: 1px; background: #1a2a3a;
  }

  @media (max-width: 700px) {
    .param-grid { grid-template-columns: repeat(2, 1fr); }
    .prof-card { min-width: 60px; font-size: 10px; }
  }

  /* scrollbar */
  #content::-webkit-scrollbar { width: 6px; }
  #content::-webkit-scrollbar-track { background: var(--bg); }
  #content::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }
  #sidebar::-webkit-scrollbar { width: 4px; }
  #sidebar::-webkit-scrollbar-track { background: var(--header-bg); }
  #sidebar::-webkit-scrollbar-thumb { background: var(--border); }

  /* -- TOGGLES DÍA / NOCHE / NVG -- */
  .mode-btn-wrap {
    display: flex;
    flex-direction: column;
    flex-shrink: 0;
    margin-top: auto;
    border-top: 2px solid var(--border);
  }
  .mode-btn {
    width: 100%;
    padding: 8px 6px;
    background: transparent;
    border: none;
    border-bottom: 1px solid var(--border);
    cursor: pointer;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 3px;
    transition: background 0.2s;
  }
  .mode-btn:last-child { border-bottom: none; }
  .mode-btn:hover { background: var(--row-hover); }
  .mode-btn .m-svg {
    width: 20px;
    height: 20px;
    color: var(--dim);
    transition: color 0.2s ease, transform 0.3s ease;
    flex-shrink: 0;
  }
  .mode-btn:hover .m-svg { transform: scale(1.12); color: var(--text); }
  #nvg-toggle.nvg-on .m-svg { color: #00AA44; }
  :root[data-mode="day"] #mode-toggle .m-svg { color: var(--gold); }
  .mode-btn .m-label {
    font-family: 'Share Tech Mono', monospace;
    font-size: 8px;
    letter-spacing: 1px;
    color: var(--dim);
    text-transform: uppercase;
  }
  /* Botón NVG – estado activo */
  #nvg-toggle.nvg-on {
    background: #001800;
    border-left: 3px solid #00AA44;
  }
  #nvg-toggle.nvg-on .m-label { color: #00AA44; }
  :root[data-mode="nvg"] #mode-toggle .m-label { color: var(--dim); }

  /* Transición suave al cambiar modo */
  body, #sidebar, #topbar, .cl-table td, .nav-btn, .cl-section-header {
    transition: background 0.3s ease, color 0.3s ease, border-color 0.3s ease;
  }

  /* info note block */
  .info-block {
    margin: 0 20px 12px;
    padding: 10px 14px;
    background: #0f1825;
    border-left: 3px solid var(--accent);
    font-size: 11px;
    color: var(--dim);
    font-family: 'Share Tech Mono', monospace;
    line-height: 1.6;
    letter-spacing: 0.3px;
  }

  /* pilot header row */
  .pilot-header {
    display: flex;
    padding: 4px 46px 4px 14px;
    background: var(--header-bg);
    border-bottom: 1px solid var(--border);
    font-family: 'Share Tech Mono', monospace;
    font-size: 9px;
    color: var(--dim);
    letter-spacing: 2px;
    justify-content: space-between;
  }

  /* two-column layout for compact sections */
  .two-col {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 0 20px;
    padding: 0 20px;
  }
  .two-col .cl-section { margin: 16px 0; }

  @media (max-width: 700px) {
    #sidebar { width: 80px; min-width: 80px; }
    .nav-btn { font-size: 10px; }
    .two-col { grid-template-columns: 1fr; }
  }
</style>
</head>
<body>

<!-- --- SPLASH SCREEN --- -->
<div id="splash">
  <img class="splash-helo" src="imagen.jpeg" alt="Escudo Águila Uno">
  <div class="splash-title">AW139<br><span style="font-size:18px;letter-spacing:4px;color:#4a7aaa;">CHECKLIST</span></div>
  <div class="splash-sub">
    FUERZA AEROESPACIAL COLOMBIANA<br>
    AW-139 – FAC-0008
    POWERED BY: 4nthr@x
  </div>
  <div class="splash-bar-wrap"><div class="splash-bar"></div></div>
  <div style="font-family:'Courier New',monospace;font-size:9px;color:#1a2a3a;letter-spacing:2px;margin-top:4px;">LOADING SYSTEMS...</div>
</div>

<!-- SIDEBAR -->
<nav id="sidebar">
  <div class="sidebar-logo">
    <img class="shield" src="imagen.jpeg" alt="Escudo Águila Uno">
    <div class="aircraft">AW139 <span>ÁGUILA</span> 1</div>
    <div class="sub">FAC 0008 • CHECKLIST</div>
  </div>

  <button class="nav-btn blue active" onclick="show('cockpit')" id="btn-cockpit">COCKPIT<br>SAFETY<br>PRE-START</button>
  <button class="nav-btn blue" onclick="show('start')" id="btn-start">ENGINE<br>START</button>
  <button class="nav-btn blue" onclick="show('syschecks')" id="btn-syschecks">SYS<br>CHECKS</button>
  <button class="nav-btn blue" onclick="show('taxi')" id="btn-taxi">TAXI &amp;<br>TAKE OFF</button>
  <button class="nav-btn blue" onclick="show('cruise')" id="btn-cruise">CRUISE<br>LANDING</button>
  <button class="nav-btn blue" onclick="show('shutdown')" id="btn-shutdown">SHUT<br>DOWN</button>
  <button class="nav-btn blue" onclick="show('ifr')" id="btn-ifr">IFR<br>DEP/APP</button>
  <button class="nav-btn blue" onclick="show('subsequent')" id="btn-subsequent">SUBSEQ.<br>STARTS</button>
  <button class="nav-btn teal" onclick="show('pac')" id="btn-pac">POWER<br>ASSURANCE</button>
  <button class="nav-btn olive" onclick="show('profiles')" id="btn-profiles">T/O &amp; LDG<br>PROFILES</button>
  <button class="nav-btn amber" onclick="show('abort')" id="btn-abort">ABORT<br>START</button>
  <button class="nav-btn amber" onclick="show('drymot')" id="btn-drymot">DRY<br>MOTOR</button>
  <button class="nav-btn red" onclick="show('exhaust')" id="btn-exhaust">EXHAUST<br>FIRE</button>

  <!-- TOGGLES DÍA / NOCHE / NVG -->
  <div class="mode-btn-wrap">
    <button id="mode-toggle" class="mode-btn" onclick="toggleMode()" title="Cambiar modo día / noche">
      <span id="mode-icon"><svg class="m-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          <line x1="17" y1="4" x2="17" y2="4.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
          <line x1="20" y1="7" x2="20.5" y2="7" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
          <line x1="19" y1="3" x2="19.5" y2="2.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
        </svg></span>
      <span class="m-label" id="mode-label">NOCHE</span>
    </button>
    <button id="nvg-toggle" class="mode-btn" onclick="toggleNVG()" title="Modo NVG – MIL-STD-3009 Clase A">
      <svg class="m-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <rect x="2" y="9" width="8" height="7" rx="3" stroke="currentColor" stroke-width="1.5"/>
          <rect x="14" y="9" width="8" height="7" rx="3" stroke="currentColor" stroke-width="1.5"/>
          <path d="M10 12.5h4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
          <circle cx="6" cy="12.5" r="1.5" fill="currentColor" opacity="0.6"/>
          <circle cx="18" cy="12.5" r="1.5" fill="currentColor" opacity="0.6"/>
          <path d="M7 9V7" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
          <path d="M17 9V7" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
        </svg>
      <span class="m-label" id="nvg-label">NVG</span>
    </button>
  </div>
</nav>

<!-- MAIN -->
<div id="main">
  <div id="topbar">
    <div class="section-title" id="section-label">COCKPIT SAFETY / PRE-START</div>
    <span class="nvg-badge">● NVG MODE – MIL-STD-3009</span>
    <div class="meta">ISSUE 6 &nbsp;|&nbsp; 20-AUG-2025<br>AW-139 – FAC 0008</div>
  </div>

  <div id="content">

    <!-- ------------------ COCKPIT SAFETY / PRE-START ------------------ -->
    <div class="section-panel active" id="panel-cockpit">
      <div class="reset-bar">
        <button class="check-all-btn" onclick="checkAll('cockpit')">CHECK ALL</button>
        <button class="reset-btn" onclick="resetSection('cockpit')">RESET</button>
      </div>
      <div class="progress-bar-wrap">
        <div class="progress-bar"><div class="progress-fill" id="prog-cockpit" style="width:0%"></div></div>
        <div class="progress-label" id="label-cockpit">0 / 0</div>
      </div>

      <!-- Cockpit Safety Check -->
      <div class="cl-section" data-section="cockpit">
        <div class="cl-section-header">COCKPIT / SAFETY CHECK</div>
        <div class="pilot-header"><span>LHP</span><span>RHP</span></div>
        <table class="cl-table" id="tbl-cockpit-safety">
          <tr onclick="toggle(this)"><td class="item-num">1</td><td class="item-name">Ties &amp; Covers</td><td class="item-action">REMOVED</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">2</td><td class="item-name">Belt / Seat / Pedals</td><td class="item-action">ADJUST</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">3</td><td class="item-name">Circuit Breakers</td><td class="item-action">IN</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">4</td><td class="item-name">ECL's</td><td class="item-action">FLIGHT</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">5</td><td class="item-name">Rotor Brake</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">6</td><td class="item-name">Overhead Switches</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">7</td><td class="item-name">Static Sources</td><td class="item-action">GUARDED</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">8</td><td class="item-name">ELT</td><td class="item-action">ARM</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">9</td><td class="item-name">Fire Panel</td><td class="item-action">CENTER/GUARDED</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">10</td><td class="item-name">Fuel Panel</td><td class="item-action">OFF/CLOSED</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">11</td><td class="item-name">ENG MODE Switch</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">12</td><td class="item-name">Radio Master</td><td class="item-action">ON</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">13</td><td class="item-name">Pedestal Switches</td><td class="item-action">OFF / SET</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">14</td><td class="item-name">Landing Gear Lever / DAS</td><td class="item-action">DOWN / 03 PINS</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">15</td><td class="item-name">Parking Brake</td><td class="item-action">ON / PRESS</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">16</td><td class="item-name">Chocks</td><td class="item-action">REMOVE</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">17</td><td class="item-name">ENG GOV Switches</td><td class="item-action">AUTO</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">18</td><td class="item-name">RPM Switch</td><td class="item-action">100%</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">19</td><td class="item-name">Collective / Cyclic Switches</td><td class="item-action">GUARDED</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">20</td><td class="item-name">Liferaft Release</td><td class="item-action">PIN SECURED</td><td class="check-col"><div class="check-box"></div></td></tr>
        </table>
      </div>

      <!-- Pre-Start Checks -->
      <div class="cl-section" data-section="cockpit">
        <div class="cl-section-header">PRE-START CHECKS</div>
        <div class="pilot-header"><span>LHP</span><span>RHP</span></div>
                <div class="cl-section-header"><span class="first-flight-badge">→ FIRST FLIGHT OF THE DAY</span></div>
        <table class="cl-table">
          <tr onclick="toggle(this)"><td class="item-num">1</td><td class="item-name">Headset</td><td class="item-action">PUT ON</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">2</td><td class="item-name">Electrical Switches</td><td class="item-action">ON (VOLTS)</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">3</td><td class="item-name">External Power</td><td class="item-action"> A/R</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">4</td><td class="item-name">Bus Tie</td><td class="item-action">(1) AUTO / (2) ON / EPU AUTO</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">5</td><td class="item-name">MFD</td><td class="item-action">CHECK VOLT / FUEL</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">6</td><td class="item-name">CAS MESSAGES</td><td class="item-action">CHECK</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">7</td><td class="item-name">PFD</td><td class="item-action">BRG/ LNAV / DH / HDG</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">8</td><td class="item-name">5th Display / DAS</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">9</td><td class="item-name">FD / AFCS</td><td class="item-action">STBY / OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">10</td><td class="item-name">→ Flight Controls</td><td class="item-action">2'Elec Pump / CHECK</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">11</td><td class="item-name">→ Test Panel</td><td class="item-action">CHECK</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">12</td><td class="item-name">Caliper</td><td class="item-action">UP / NO PRESSURE</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">13</td><td class="item-name">Landing Gear Panel</td><td class="item-action">3 GREEN</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">14</td><td class="item-name">→ ENG TRIM Beep</td><td class="item-action"> TEST</td><td class="check-col"><div class="check-box"></div></td></tr>
        </table>
      </div>
    </div>

    <!-- ------------------ ENGINE START ------------------ -->
    <div class="section-panel" id="panel-start">
      <div class="reset-bar">
        <button class="check-all-btn" onclick="checkAll('start')">CHECK ALL</button>
        <button class="reset-btn" onclick="resetSection('start')">RESET</button>
      </div>
      <div class="progress-bar-wrap">
        <div class="progress-bar"><div class="progress-fill" id="prog-start" style="width:0%"></div></div>
        <div class="progress-label" id="label-start">0 / 0</div>
      </div>

      <div class="cl-section" data-section="start">
        <div class="cl-section-header">ENGINE START</div>
        <div class="pilot-header"><span>LHP</span><span>RHP</span></div>
        <table class="cl-table">
          <tr onclick="toggle(this)"><td class="item-num">1</td><td class="item-name">ATIS / Clearance</td><td class="item-action">OBTAIN</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">2</td><td class="item-name">Baro Selec. / Xpndr</td><td class="item-action">ESIS SET / SET-ON</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">3</td><td class="item-name">Anti-COL. / Position / Strobe LT</td><td class="item-action">ON</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">4</td><td class="item-name">Main Bus</td><td class="item-action">&gt; 23V</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">5</td><td class="item-name">Bus Tie (2) / PFD BRIGHT</td><td class="item-action">ON / INCREASE</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">6</td><td class="item-name">ENG 1(2) FUEL Switch</td><td class="item-action">ON</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">7</td><td class="item-name">ENG 1(2) FUEL PUMP</td><td class="item-action">ON / CHECK PRESS</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">8</td><td class="item-name">ENG 1(2) MODE Switch</td><td class="item-action">IDLE</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">9</td><td class="item-name">T's &amp; P's</td><td class="item-action">MONITOR</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">10</td><td class="item-name">NR / NF</td><td class="item-action">65% ± 1%</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">11</td><td class="item-name">ENG 1(2) MODE Switch</td><td class="item-action">FLIGHT</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">12</td><td class="item-name">GEN 1(2)</td><td class="item-action">ON LINE / Check load</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="row-repeat"><td colspan="4">REPEAT ITEMS 5 TO 12 FOR 2nd ENGINE</td></tr>
          <tr onclick="toggle(this)"><td class="item-num">13</td><td class="item-name">NR / NF</td><td class="item-action">100%</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">14</td><td class="item-name">External Power</td><td class="item-action">OFF / Disconnect</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">15</td><td class="item-name">GEN 1 &amp; 2</td><td class="item-action">Confirm ON LINE</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">16</td><td class="item-name">Bus Tie</td><td class="item-action">AUTO</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">17</td><td class="item-name">Air Conditioning</td><td class="item-action">ON / Close Doors</td><td class="check-col"><div class="check-box"></div></td></tr>
        </table>
      </div>
    </div>

    <!-- ------------------ SYSTEM CHECKS ------------------ -->
    <div class="section-panel" id="panel-syschecks">
      <div class="reset-bar">
        <button class="check-all-btn" onclick="checkAll('syschecks')">CHECK ALL</button>
        <button class="reset-btn" onclick="resetSection('syschecks')">RESET</button>
      </div>
      <div class="progress-bar-wrap">
        <div class="progress-bar"><div class="progress-fill" id="prog-syschecks" style="width:0%"></div></div>
        <div class="progress-label" id="label-syschecks">0 / 0</div>
      </div>

      <div class="cl-section" data-section="syschecks">
        <div class="cl-section-header">SYSTEM CHECKS <span class="first-flight-badge">→ FIRST FLIGHT OF THE DAY</span></div>
        <div class="pilot-header"><span>LHP</span><span>RHP</span></div>
        <table class="cl-table">
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">1</td><td class="item-name">→ Hydraulic</td><td class="item-action">CHECK</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">2</td><td class="item-name">→ FUEL Panel</td><td class="item-action">TEST</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">3</td><td class="item-name">→ AFCS</td><td class="item-action">TEST</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">4</td><td class="item-name">→ RAD ALT</td><td class="item-action">TEST</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">5</td><td class="item-name">Altimeters</td><td class="item-action">SET / X CHECK</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">6</td><td class="item-name">5th Display / DAS / Wx Radar</td><td class="item-action">A/R</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">7</td><td class="item-name">MCDU</td><td class="item-action">PERF. INIT / RAD / NAV</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">8</td><td class="item-name">MFD</td><td class="item-action">MAP / PLAN Boxes SET</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">9</td><td class="item-name">PFD</td><td class="item-action">(BEAR / HSI / ALTA) SET</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">10</td><td class="item-name">Emergency & External Lights</td><td class="item-action">TEST / ARM</td><td class="check-col"><div class="check-box"></div></td></tr>

        </table>
      </div>

    </div>

    <!-- ------------------ TAXI / TAKE OFF ------------------ -->
    <div class="section-panel" id="panel-taxi">
      <div class="reset-bar">
        <button class="check-all-btn" onclick="checkAll('taxi')">CHECK ALL</button>
        <button class="reset-btn" onclick="resetSection('taxi')">RESET</button>
      </div>
      <div class="progress-bar-wrap">
        <div class="progress-bar"><div class="progress-fill" id="prog-taxi" style="width:0%"></div></div>
        <div class="progress-label" id="label-taxi">0 / 0</div>
      </div>

      <div class="cl-section" data-section="taxi">
        <div class="cl-section-header">TAXIING</div>
        <div class="pilot-header"><span>PM</span><span>PF</span></div>
        <table class="cl-table">
          <tr onclick="toggle(this)"><td class="item-num">1</td><td class="item-name">Air Conditioning / Vent</td><td class="item-action">A/R</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">2</td><td class="item-name">Doors</td><td class="item-action">CLOSED</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">3</td><td class="item-name">Autopilots</td><td class="item-action">ON</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">4</td><td class="item-name">Chocks – Verify</td><td class="item-action">REMOVED</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">5</td><td class="item-name">Nose Wheel</td><td class="item-action">UNLOCK</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">6</td><td class="item-name">Parking Brake</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">7</td><td class="item-name">ATC Clearance</td><td class="item-action"><Obj>OBTAIN</Obj></td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">8</td><td class="item-name">Pedal Control &amp; Brakes</td><td class="item-action">CHECK</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">9</td><td class="item-name">Fuel XFEED</td><td class="item-action">NORMAL</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">10</td><td class="item-name">T's & P's / CAS</td><td class="item-action">CHECK</td><td class="check-col"><div class="check-box"></div></td></tr>


        </table>
      </div>

      <div class="cl-section" data-section="taxi">
        <div class="cl-section-header">PRE TAKE-OFF (Line Up)</div>
        <table class="cl-table">
          <tr onclick="toggle(this)"><td class="item-num">1</td><td class="item-name">Autopilots</td><td class="item-action">ON</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">2</td><td class="item-name">NR / NF</td><td class="item-action">100 / CAT A 102%</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">3</td><td class="item-name">Parking Brake</td><td class="item-action">A/R</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">4</td><td class="item-name">Nose Wheel</td><td class="item-action">LOCKED</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">5</td><td class="item-name">XPDR / TCAS</td><td class="item-action">ON</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">6</td><td class="item-name">Wx Radar</td><td class="item-action">ON</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">7</td><td class="item-name">Heading</td><td class="item-action">SET</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">8</td><td class="item-name">Take Off Briefing / TEM</td><td class="item-action">PERFORM</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">9</td><td class="item-name">Landing Lights</td><td class="item-action">ON</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">10</td><td class="item-name">ATC Clearance</td><td class="item-action">OBTAIN</td><td class="check-col"><div class="check-box"></div></td></tr>

        </table>
      </div>

      <div class="cl-section" data-section="taxi">
        <div class="cl-section-header">AFTER TAKE OFF (Vy &amp; 150 ft AGL) GA</div>
        <table class="cl-table">
          <tr onclick="toggle(this)"><td class="item-num">1</td><td class="item-name">NR</td><td class="item-action">100%</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">2</td><td class="item-name">Landing Gear</td><td class="item-action">A/R</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">3</td><td class="item-name">Flight Director Modes</td><td class="item-action">MANUAL / HDG / NAV</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">4</td><td class="item-name">T's &amp; P's / CAS</td><td class="item-action">CHECK</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">5</td><td class="item-name">Parking Brake</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">6</td><td class="item-name">Landing Lights</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
        </table>
      </div>
    </div>

    <!-- ------------------ CRUISE / LANDING ------------------ -->
    <div class="section-panel" id="panel-cruise">
      <div class="reset-bar">
        <button class="check-all-btn" onclick="checkAll('cruise')">CHECK ALL</button>
        <button class="reset-btn" onclick="resetSection('cruise')">RESET</button>
      </div>
      <div class="progress-bar-wrap">
        <div class="progress-bar"><div class="progress-fill" id="prog-cruise" style="width:0%"></div></div>
        <div class="progress-label" id="label-cruise">0 / 0</div>
      </div>

      <div class="cl-section" data-section="cruise">
        <div class="cl-section-header">CLIMB / CRUISE / DESCENT</div>
        <div class="pilot-header"><span>PM</span><span>PF</span></div>
        <table class="cl-table">
          <tr onclick="toggle(this)"><td class="item-num">1</td><td class="item-name">Altimeters</td><td class="item-action">SET X CHECK</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">2</td><td class="item-name">T's &amp; P's / CAS</td><td class="item-action">CHECK</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">3</td><td class="item-name">Fuel / Systems</td><td class="item-action">CHECK </td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">4</td><td class="item-name">Flight Instruments</td><td class="item-action">NORMAL OPERAT.</td><td class="check-col"><div class="check-box"></div></td></tr>
        </table>
      </div>

      <div class="cl-section" data-section="cruise">
        <div class="cl-section-header">PRE LANDING</div>
        <table class="cl-table">
          <tr onclick="toggle(this)"><td class="item-num">1</td><td class="item-name">T's &amp; P's / CAS</td><td class="item-action">CHECK</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">2</td><td class="item-name">Landing Gear</td><td class="item-action">IAS -150K /DOWN &amp; LOCKED</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">3</td><td class="item-name">Nose Wheel</td><td class="item-action">LOCKED</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">4</td><td class="item-name">Parking Brake</td><td class="item-action">A/R</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">5</td><td class="item-name">Wx Radar</td><td class="item-action">A/R</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">6</td><td class="item-name">Landing Lights</td><td class="item-action">ON</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">7</td><td class="item-name">Approach Briefing / TEM</td><td class="item-action">PERFORM</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">8</td><td class="item-name">Sterile Cockpit</td><td class="item-action">BEGIN</td><td class="check-col"><div class="check-box"></div></td></tr>
        </table>
      </div>

      <div class="cl-section" data-section="cruise">
        <div class="cl-section-header">FINAL (Final HDG &amp; 400 ft AGL)</div>
        <table class="cl-table">
          <tr onclick="toggle(this)"><td class="item-num">1</td><td class="item-name">Landing Gear</td><td class="item-action">3 GREEN</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">2</td><td class="item-name">NR</td><td class="item-action">100% (CAT A 102% -90KT)</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">3</td><td class="item-name">MFD</td><td class="item-action">POWERPLANT</td><td class="check-col"><div class="check-box"></div></td></tr>
        </table>
      </div>

      <div class="cl-section" data-section="cruise">
        <div class="cl-section-header">POST LANDING</div>
        <table class="cl-table">
          <tr onclick="toggle(this)"><td class="item-num">1</td><td class="item-name">Nose Wheel</td><td class="item-action">A/R</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">2</td><td class="item-name">Parking Brake</td><td class="item-action">A/R</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">3</td><td class="item-name">NR</td><td class="item-action">100%</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">4</td><td class="item-name">External Lights</td><td class="item-action">A/R</td><td class="check-col"><div class="check-box"></div></td></tr>
        </table>
      </div>
    </div>

    <!-- ------------------ SHUTDOWN ------------------ -->
    <div class="section-panel" id="panel-shutdown">
      <div class="reset-bar">
        <button class="check-all-btn" onclick="checkAll('shutdown')">CHECK ALL</button>
        <button class="reset-btn" onclick="resetSection('shutdown')">RESET</button>
      </div>
      <div class="progress-bar-wrap">
        <div class="progress-bar"><div class="progress-fill" id="prog-shutdown" style="width:0%"></div></div>
        <div class="progress-label" id="label-shutdown">0 / 0</div>
      </div>

      <div class="cl-section" data-section="shutdown">
        <div class="cl-section-header">SHUTDOWN</div>
        <div class="pilot-header"><span>LHP</span><span>RHP</span></div>
        <table class="cl-table">
          <tr onclick="toggle(this)"><td class="item-num">1</td><td class="item-name">Flight Controls</td><td class="item-action">CENTER / MPOG</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">2</td><td class="item-name">Parking Brake</td><td class="item-action">ON</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">3</td><td class="item-name">Nose Wheel</td><td class="item-action">LOCKED</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">4</td><td class="item-name">Autopilots</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">5</td><td class="item-name">Air Conditioning</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">6</td><td class="item-name">ENG MODE Switches</td><td class="item-action">IDLE (1')</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">7</td><td class="item-name">5th Display / DAS / Wx Rad / Wiper</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">8</td><td class="item-name">Bus Tie</td><td class="item-action">ON</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">9</td><td class="item-name">FUEL PUMP's</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">10</td><td class="item-name">ENG MODE Switches</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">11</td><td class="item-name">Rotor Brake</td><td class="item-action">A/R (NR &lt;30%)</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">12</td><td class="item-name">ENG FUEL Valves</td><td class="item-action">OFF (0% NG)</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">13</td><td class="item-name">Fuel XFEED Switch</td><td class="item-action">CLOSED</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">14</td><td class="item-name">Ext. Lights / PFD Bright</td><td class="item-action">OFF / MIN</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">15</td><td class="item-name">Bus Tie</td><td class="item-action">AUTO</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">16</td><td class="item-name">Emergency Lights</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">17</td><td class="item-name">Electrical Switches</td><td class="item-action">OFF (15")</td><td class="check-col"><div class="check-box"></div></td></tr>
        </table>
      </div>
    </div>

    <!-- ------------------ IFR ------------------ -->
    <div class="section-panel" id="panel-ifr">
      <div class="reset-bar">
        <button class="check-all-btn" onclick="checkAll('ifr')">CHECK ALL</button>
        <button class="reset-btn" onclick="resetSection('ifr')">RESET</button>
      </div>
      <div class="progress-bar-wrap">
        <div class="progress-bar"><div class="progress-fill" id="prog-ifr" style="width:0%"></div></div>
        <div class="progress-label" id="label-ifr">0 / 0</div>
      </div>

      <div class="cl-section" data-section="ifr">
        <div class="cl-section-header">IFR DEPARTURE BRIEFING</div>
        <table class="cl-table">
          <tr onclick="toggle(this)"><td class="item-num">1</td><td class="item-name">TEM Brief</td><td class="item-action">PERFORM</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">2</td><td class="item-name">Departure Plate</td><td class="item-action">REVIEW</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">3</td><td class="item-name">Nav Aids</td><td class="item-action">TUNED / AUTO</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">4</td><td class="item-name">MCDU/ PFD / MFD / ESIS</td><td class="item-action">DEPTARTURE / ALTA / CRS SET</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">5</td><td class="item-name">Altimeters</td><td class="item-action">3 SET / X CHECK</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">6</td><td class="item-name">ATC Clearance</td><td class="item-action">OBTAINE</td><td class="check-col"><div class="check-box"></div></td></tr>
        </table>
      </div>

      <div class="cl-section" data-section="ifr">
        <div class="cl-section-header">IFR ARRIVAL BRIEFING</div>
        <table class="cl-table">
          <tr onclick="toggle(this)"><td class="item-num">1</td><td class="item-name">WHOLDS</td><td class="item-action">COMPLETE</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">2</td><td class="item-name">TEM Brief</td><td class="item-action"> PERFORM</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">3</td><td class="item-name">Nav Aids</td><td class="item-action">TUNED / AUTO / RAIM</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">4</td><td class="item-name">MCDU</td><td class="item-action">ARRIVAL</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">5</td><td class="item-name">Nav Source / PFD / ESIS</td><td class="item-action">(NAV / PREVIEW / LNAV) / CRS / DH</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">6</td><td class="item-name">Altimeters</td><td class="item-action">SET / X CHECK</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">7</td><td class="item-name">APP Button</td><td class="item-action">PRESS (-5NM /30°)</td><td class="check-col"><div class="check-box"></div></td></tr>


        </table>
      </div>

      <div class="cl-section" data-section="ifr">
        <div class="cl-section-header">IFR DEP / APP CHECKS</div>
        <div class="pilot-header"><span>LHP</span><span>RHP</span></div>
        <table class="cl-table">
          <tr onclick="toggle(this)"><td class="item-num">1</td><td class="item-name">WX / ATIS</td><td class="item-action">QNH (L/C/R)</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">2</td><td class="item-name">MCDU / FMS</td><td class="item-action">SET / RAIM</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">3</td><td class="item-name">NAV Aids</td><td class="item-action">TUNE ~ IDENT.</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">4</td><td class="item-name">PFD / MFD / ESIS</td><td class="item-action">SET</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">5</td><td class="item-name">Departure / Approach Plate</td><td class="item-action">REVIEW / BRIEF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">6</td><td class="item-name">IFR DEP / APP Checks</td><td class="item-action">COMPLETE</td><td class="check-col"><div class="check-box"></div></td></tr>
        </table>
      </div>
    </div>

    <!-- ------------------ SUBSEQUENT STARTS ------------------ -->
    <div class="section-panel" id="panel-subsequent">
      <div class="reset-bar">
        <button class="check-all-btn" onclick="checkAll('subsequent')">CHECK ALL</button>
        <button class="reset-btn" onclick="resetSection('subsequent')">RESET</button>
      </div>
      <div class="progress-bar-wrap">
        <div class="progress-bar"><div class="progress-fill" id="prog-subsequent" style="width:0%"></div></div>
        <div class="progress-label" id="label-subsequent">0 / 0</div>
      </div>
      <div class="cl-section" data-section="subsequent">
        <div class="cl-section-header">BEFORE STARTING ENGINES – Subsequent Starts</div>
        <div class="pilot-header"><span>LHP</span><span>RHP</span></div>
        <table class="cl-table">
          <tr onclick="toggle(this)"><td class="item-num">1</td><td class="item-name">CBs / Switches / Rotor Brake</td><td class="item-action">SET</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">2</td><td class="item-name">pedestal Switches</td><td class="item-action">SET</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">3</td><td class="item-name">LDG Lever / DAS</td><td class="item-action">DOWN / 3 PINS</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">4</td><td class="item-name">ENG GOV Switches</td><td class="item-action">SET</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">5</td><td class="item-name">Parking Brake</td><td class="item-action">SET</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">6</td><td class="item-name">Chocks</td><td class="item-action">REMOVED</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">7</td><td class="item-name">Electrical Switches</td><td class="item-action">ON</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">8</td><td class="item-name">External Lights</td><td class="item-action">ON (A/R)</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">9</td><td class="item-name">Chocks</td><td class="item-action">REMOVED</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">10</td><td class="item-name">CAS Messages</td><td class="item-action">CHECK</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">11</td><td class="item-name">MFD</td><td class="item-action">MAP / PLAN BOXES SET</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">12</td><td class="item-name">PFD</td><td class="item-action">(BEAR / HSI / ALTA) SET</td><td class="check-col"><div class="check-box"></div></td></tr>



        </table>
      </div>

      <div class="cl-section" data-section="subsequent">
        <div class="cl-section-header">ENGINE START – Subsequent Starts</div>
        <div class="pilot-header"><span>LHP</span><span>RHP</span></div>
        <table class="cl-table">
          <tr onclick="toggle(this)"><td class="item-num">1</td><td class="item-name">ATIS / Clearance</td><td class="item-action">OBTAIN</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row"onclick="toggle(this)"><td class="item-num" style="color:var(--gold)">2</td><td class="item-name">Bus Tie (2) / PFD Bright</td><td class="item-action">ON / INCREASE</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row"onclick="toggle(this)"><td class="item-num" style="color:var(--gold)">3</td><td class="item-name">ENG FUEL Switch</td><td class="item-action">ON</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row"onclick="toggle(this)"><td class="item-num" style="color:var(--gold)">4</td><td class="item-name">ENG FUEL PUMP</td><td class="item-action">ON / CHECK PRESS</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row"onclick="toggle(this)"><td class="item-num" style="color:var(--gold)">5</td><td class="item-name">Main Bus</td><td class="item-action">MINIMUM 23V</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row"onclick="toggle(this)"><td class="item-num" style="color:var(--gold)">6</td><td class="item-name">ENG MODE Switch</td><td class="item-action">IDLE</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row"onclick="toggle(this)"><td class="item-num" style="color:var(--gold)">7</td><td class="item-name">ENG MODE Switch</td><td class="item-action">FLIGHT (at 65% ± 1%)</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row"onclick="toggle(this)"><td class="item-num" style="color:var(--gold)">8</td><td class="item-name">GEN</td><td class= "item-action">ON LINE / CHECK LOAD</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row"onclick="toggle(this)"><td class="item-num" style="color:var(--gold)">9</td><td class="item-name">Bus Tie</td><td class="item-action">AUTO</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="row-repeat"><td colspan="4">REPEAT ITEMS 2 TO 9 FOR 2nd ENGINE</td></tr>
          <tr class="info-block" onclick="show('syschecks')" style="cursor:pointer;"><td colspan="3" style="text-align: center;"><strong style="color:#b8d44a;">GO TO SYS CHECKS MENU</strong></td></tr>
        </table>
      </div>
    </div>

    <!-- ------------------ POWER ASSURANCE CHECK ------------------ -->
    <div class="section-panel" id="panel-pac">
      <div class="reset-bar">
        <button class="check-all-btn" onclick="checkAll('pac')">CHECK ALL</button>
        <button class="reset-btn" onclick="resetSection('pac')">RESET</button>
      </div>
      <div class="progress-bar-wrap">
        <div class="progress-bar"><div class="progress-fill" id="prog-pac" style="width:0%"></div></div>
        <div class="progress-label" id="label-pac">0 / 0</div>
      </div>

      <div class="info-block">
        <strong style="color:var(--gold);">POWER ASSURANCE CHECK in HOVER FLIGHT (NR=100%)</strong><br>
        Área despejada – Nariz al viento – HEATER/COND OFF – GEN LOAD = 17%<br>
        Aumentar colectivo hasta liviano en ruedas o hover a 5 ft – NO EXCEDER TQ 105% – ITT 775°C – NG 102.4%<br>
        Estabilizar 1 minuto • registrar PA, OAT, TQ, ITT, NG • comparar con carta.<br>
        Los Ítems marcados con <strong style="color:var(--gold)"></strong> se repiten para el 2do motor.
      </div>

      <!-- CHECKLIST STEPS -->
      <div class="cl-section" data-section="pac">
        <div class="cl-section-header">PROCEDIMIENTO – Fig. 4-5  PWC PT6C-67C</div>
        <div class="pilot-header"><span>LHP</span><span>RHP</span></div>
        <table class="cl-table">
          <tr onclick="toggle(this)"><td class="item-num">1</td><td class="item-name">Posicionar aeronave enfrentada al viento</td><td class="item-action">AREA CLEAR</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">2</td><td class="item-name">HEATER / COND</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">3</td><td class="item-name">Nose Wheel</td><td class="item-action">LOCKED</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">4</td><td class="item-name">Altimeter</td><td class="item-action">STANDARD 1013mb</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">5</td><td class="item-name">Autopilots</td><td class="item-action">ON</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">6</td><td class="item-name">Bus Tie / GEN Load</td><td class="item-action">ON / = 17%</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">7</td><td class="item-name">NR</td><td class="item-action">100% (CAT A 102%)</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num" style="color:var(--gold)">8</td><td class="item-name">ENG MODE Switch (Motor a Probar)</td><td class="item-action">FLIGHT</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num" style="color:var(--gold)">9</td><td class="item-name">ENG MODE Switch (otro motor)</td><td class="item-action">IDLE</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num" style="color:var(--gold)">10</td><td class="item-name">Collective</td><td class="item-action">TQ = 90%</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num" style="color:var(--gold)">11</td><td class="item-name">Stabilize 1 min • Record PA, OAT, TQ, ITT, NG</td><td class="item-action">RECORD</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num" style="color:var(--gold)">12</td><td class="item-name">Collective → MPOG – ENG MODE (otro motor)</td><td class="item-action">FLIGHT</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="row-repeat"><td colspan="4">REPEAT ITEMS 8 TO 12 FOR 2nd ENGINE</td></tr>
          <tr onclick="toggle(this)"><td class="item-num">13</td><td class="item-name">Bus Tie</td><td class="item-action">AUTO</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">14</td><td class="item-name">Altimeter</td><td class="item-action">SET / X-CHECK QNH</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">15</td><td class="item-name">Ajustar Valores en la sección de abajo</td><td class="item-action">Ver abajo ↓</td><td class="check-col"><div class="check-box"></div></td></tr>
        </table>
      </div>

      <!-- --- INTERACTIVE PAC CHART --- -->
      <div class="cl-section" style="margin-top:0;">
        <div class="cl-section-header" style="border-bottom-color:#1a9a8a;">
          FIGURA 4-5 – HOVER POWER CHECK CHART  &nbsp;<span class="sub-note">PWC PT6C-67C – NR=100%</span>
        </div>

        <!-- Input panel -->
        <div style="background:#0c1520; padding:14px 16px; border-bottom:1px solid var(--border);">
          <div style="display:grid; grid-template-columns:repeat(6,1fr); gap:10px; margin-bottom:12px;">

            <div style="display:flex; flex-direction:column; gap:4px;">
              <label style="font-family:'Share Tech Mono',monospace; font-size:9px; color:var(--dim); letter-spacing:1px;">ENG</label>
              <select id="pac-eng" style="background:#1a2236; border:1px solid var(--border); color:var(--gold); font-family:'Share Tech Mono',monospace; font-size:13px; padding:6px 4px; border-radius:2px;">
                <option value="1">ENG 1</option>
                <option value="2">ENG 2</option>
              </select>
            </div>

            <div style="display:flex; flex-direction:column; gap:4px;">
              <label style="font-family:'Share Tech Mono',monospace; font-size:9px; color:var(--dim); letter-spacing:1px;">TQ INDICADO (%)</label>
              <input id="pac-tq" type="number" min="90" max="105" step="0.1" placeholder="102" style="background:#1a2236; border:1px solid var(--border); color:var(--text); font-family:'Share Tech Mono',monospace; font-size:14px; padding:6px 8px; border-radius:2px; width:100%;">
            </div>

            <div style="display:flex; flex-direction:column; gap:4px;">
              <label style="font-family:'Share Tech Mono',monospace; font-size:9px; color:var(--dim); letter-spacing:1px;">PRES. ALT (ft)</label>
              <input id="pac-pa" type="number" min="-1000" max="14000" step="100" placeholder="5000" style="background:#1a2236; border:1px solid var(--border); color:var(--text); font-family:'Share Tech Mono',monospace; font-size:14px; padding:6px 8px; border-radius:2px; width:100%;">
            </div>

            <div style="display:flex; flex-direction:column; gap:4px;">
              <label style="font-family:'Share Tech Mono',monospace; font-size:9px; color:var(--dim); letter-spacing:1px;">OAT (°C)</label>
              <input id="pac-oat" type="number" min="-40" max="50" step="1" placeholder="-10" style="background:#1a2236; border:1px solid var(--border); color:var(--text); font-family:'Share Tech Mono',monospace; font-size:14px; padding:6px 8px; border-radius:2px; width:100%;">
            </div>

            <div style="display:flex; flex-direction:column; gap:4px;">
              <label style="font-family:'Share Tech Mono',monospace; font-size:9px; color:var(--dim); letter-spacing:1px;">ITT MEDIDO (°C)</label>
              <input id="pac-itt" type="number" min="400" max="800" step="1" placeholder="600" style="background:#1a2236; border:1px solid var(--border); color:var(--text); font-family:'Share Tech Mono',monospace; font-size:14px; padding:6px 8px; border-radius:2px; width:100%;">
            </div>

            <div style="display:flex; flex-direction:column; gap:4px;">
              <label style="font-family:'Share Tech Mono',monospace; font-size:9px; color:var(--dim); letter-spacing:1px;">NG MEDIDO (%)</label>
              <input id="pac-ng" type="number" min="70" max="105" step="0.1" placeholder="91" style="background:#1a2236; border:1px solid var(--border); color:var(--text); font-family:'Share Tech Mono',monospace; font-size:14px; padding:6px 8px; border-radius:2px; width:100%;">
            </div>
          </div>

          <div style="display:flex; gap:10px; align-items:center;">
            <button onclick="runPAC()" id="pac-run-btn" style="font-family:'Barlow Condensed',sans-serif; font-size:13px; font-weight:700; letter-spacing:2px; text-transform:uppercase; padding:8px 24px; background:#1a9a8a; border:none; color:white; border-radius:2px; cursor:pointer; transition:all 0.2s;">▶ VERIFICAR LÍMITES EN CARTA</button>
            <button onclick="clearPAC()" style="font-family:'Barlow Condensed',sans-serif; font-size:11px; font-weight:700; letter-spacing:1px; text-transform:uppercase; padding:8px 16px; background:transparent; border:1px solid var(--border); color:var(--dim); border-radius:2px; cursor:pointer;">LIMPIAR</button>
            <button onclick="loadRFMExample()" style="font-family:'Barlow Condensed',sans-serif; font-size:10px; font-weight:600; letter-spacing:1px; padding:8px 14px; background:transparent; border:1px solid #253050; color:#4a6a9c; border-radius:2px; cursor:pointer;">EJEMPLO RFM</button>
          </div>
        </div>

        <!-- Results banner -->
        <div id="pac-result-banner" style="display:none; padding:10px 16px; font-family:'Share Tech Mono',monospace; font-size:12px; letter-spacing:0.5px; line-height:1.8; border-bottom:1px solid var(--border);"></div>

        <!-- CANVAS CHART -->
        <div style="background:#060d18; padding:12px 16px; overflow-x:auto;">
          <div style="font-family:'Share Tech Mono',monospace; font-size:9px; color:#4a6070; letter-spacing:1px; margin-bottom:6px; text-align:center;">
            POWER ASSURANCE CHECK in HOVER FLIGHT (NR=100%) – Figure 4-5 PWC PT6C-67C – 139G0040A001 ISSUE F
          </div>
          <canvas id="pac-canvas" width="860" height="420" style="display:block; margin:0 auto; cursor:crosshair;"></canvas>
          <div style="font-family:'Share Tech Mono',monospace; font-size:8px; color:#3a4a5a; letter-spacing:0.5px; text-align:center; margin-top:4px;">
            ICN-39-A-154000-A-A0126-00001-A-06-1 &nbsp;|&nbsp; FOR TRAINING ONLY
          </div>
        </div>

        <!-- Per-engine log table -->
        <div style="background:#0a1020; border-top:1px solid var(--border);">
          <table style="width:100%; border-collapse:collapse; font-family:'Share Tech Mono',monospace; font-size:11px;">
            <thead>
              <tr style="background:var(--header-bg);">
                <th style="padding:7px 12px; color:var(--dim); text-align:left; letter-spacing:1px; border-bottom:1px solid var(--border);">ENG</th>
                <th style="padding:7px 10px; color:var(--dim); text-align:center; border-bottom:1px solid var(--border);">TQ (%)</th>
                <th style="padding:7px 10px; color:var(--dim); text-align:center; border-bottom:1px solid var(--border);">PA (ft)</th>
                <th style="padding:7px 10px; color:var(--dim); text-align:center; border-bottom:1px solid var(--border);">OAT (°C)</th>
                <th style="padding:7px 10px; color:var(--dim); text-align:center; border-bottom:1px solid var(--border);">ITT medido</th>
                <th style="padding:7px 10px; color:var(--dim); text-align:center; border-bottom:1px solid var(--border);">ITT máx</th>
                <th style="padding:7px 10px; color:var(--dim); text-align:center; border-bottom:1px solid var(--border);">PAM ITT</th>
                <th style="padding:7px 10px; color:var(--dim); text-align:center; border-bottom:1px solid var(--border);">NG medido</th>
                <th style="padding:7px 10px; color:var(--dim); text-align:center; border-bottom:1px solid var(--border);">NG máx</th>
                <th style="padding:7px 10px; color:var(--dim); text-align:center; border-bottom:1px solid var(--border);">PAM NG</th>
                <th style="padding:7px 10px; color:var(--dim); text-align:center; border-bottom:1px solid var(--border);">RESULTADO</th>
              </tr>
            </thead>
            <tbody id="pac-log-body">
              <tr id="pac-log-1">
                <td style="padding:7px 12px; color:var(--gold);">ENG 1</td>
                <td style="padding:7px 10px; text-align:center; color:var(--dim);">–</td>
                <td style="padding:7px 10px; text-align:center; color:var(--dim);">–</td>
                <td style="padding:7px 10px; text-align:center; color:var(--dim);">–</td>
                <td style="padding:7px 10px; text-align:center; color:var(--dim);">–</td>
                <td style="padding:7px 10px; text-align:center; color:var(--dim);">–</td>
                <td style="padding:7px 10px; text-align:center; color:var(--dim);">–</td>
                <td style="padding:7px 10px; text-align:center; color:var(--dim);">–</td>
                <td style="padding:7px 10px; text-align:center; color:var(--dim);">–</td>
                <td style="padding:7px 10px; text-align:center; color:var(--dim);">–</td>
                <td style="padding:7px 10px; text-align:center; color:var(--dim);">–</td>
              </tr>
              <tr id="pac-log-2">
                <td style="padding:7px 12px; color:#7ab0ff;">ENG 2</td>
                <td style="padding:7px 10px; text-align:center; color:var(--dim);">–</td>
                <td style="padding:7px 10px; text-align:center; color:var(--dim);">–</td>
                <td style="padding:7px 10px; text-align:center; color:var(--dim);">–</td>
                <td style="padding:7px 10px; text-align:center; color:var(--dim);">–</td>
                <td style="padding:7px 10px; text-align:center; color:var(--dim);">–</td>
                <td style="padding:7px 10px; text-align:center; color:var(--dim);">–</td>
                <td style="padding:7px 10px; text-align:center; color:var(--dim);">–</td>
                <td style="padding:7px 10px; text-align:center; color:var(--dim);">–</td>
                <td style="padding:7px 10px; text-align:center; color:var(--dim);">–</td>
                <td style="padding:7px 10px; text-align:center; color:var(--dim);">–</td>
              </tr>
            </tbody>
          </table>
        </div>

      </div><!-- /cl-section -->
    </div><!-- /panel-pac -->

    <!-- ------------------ T/O & LANDING CAT PROFILES ------------------ -->
    <div class="section-panel" id="panel-profiles">
      <!-- sub-tab bar -->
      <div id="prof-tabs" style="display:flex; background:#070e18; border-bottom:2px solid #1a2a3a; flex-shrink:0;">
        <button class="prof-tab active" id="ptab-to" onclick="profTab('to')">
          ▶ &nbsp;TAKE-OFF PROFILES
        </button>
        <button class="prof-tab" id="ptab-ldg" onclick="profTab('ldg')">
          ▶ &nbsp;LANDING PROFILES
        </button>
      </div>

      <!-- -- TAKE-OFF -- -->
      <div id="prof-to" class="prof-pane">
        <div style="padding:10px 16px 0; font-family:'Share Tech Mono',monospace; font-size:9px; color:#4a6080; letter-spacing:1px;">
          PMC-39-A0126-CP001-00 – Issue 002 – 2025.02.28 – Leonardo Training Academy – Selecciona un perfil:
        </div>
        <div style="margin:6px 16px 0; padding:8px 12px; background:#0d1a06; border:1px solid #4a6a1a; border-left:3px solid #7a9a2a; font-family:'Share Tech Mono',monospace; font-size:10px; color:#8ab840; line-height:1.7; letter-spacing:0.5px;">
          • Selecciona el tipo de <strong style="color:#b8d44a;">despegue</strong> a realizar para verificar los parámetros operacionales, límites de potencia y procedimientos de contingencia (RTO / CTO) antes de la maniobra.
        </div>
        <!-- Profile selector cards -->
        <div id="to-cards" style="display:flex; gap:8px; padding:10px 16px; flex-wrap:wrap;">
          <button class="prof-card" onclick="selectTO('catb')"     id="tocard-catb">CAT B</button>
          <button class="prof-card" onclick="selectTO('clear')"    id="tocard-clear">CAT A<br><small>CLEAR AREA</small></button>
          <button class="prof-card cat-a" onclick="selectTO('vertical')"  id="tocard-vertical">CAT A<br><small>G&amp;E H/H<br>VERTICAL</small></button>
          <button class="prof-card cat-a" onclick="selectTO('backup')"    id="tocard-backup">CAT A<br><small>G&amp;E H/H<br>BACK-UP</small></button>
          <button class="prof-card cat-a" onclick="selectTO('confined')"  id="tocard-confined">CAT A<br><small>CONFINED<br>AREA</small></button>
          <button class="prof-card cat-a" onclick="selectTO('short')"     id="tocard-short">CAT A<br><small>SHORT<br>FIELD</small></button>
        </div>
        <!-- Detail panel -->
        <div id="to-detail" style="display:none; padding:0 16px 16px;"></div>
      </div>

      <!-- -- LANDING -- -->
      <div id="prof-ldg" class="prof-pane" style="display:none;">
        <div style="padding:10px 16px 0; font-family:'Share Tech Mono',monospace; font-size:9px; color:#4a6080; letter-spacing:1px;">
          PMC-39-A0126-CP001-00 – Issue 002 – 2025.02.28 – Leonardo Training Academy – Selecciona un perfil:
        </div>
        <div style="margin:6px 16px 0; padding:8px 12px; background:#0d1a06; border:1px solid #4a6a1a; border-left:3px solid #7a9a2a; font-family:'Share Tech Mono',monospace; font-size:10px; color:#8ab840; line-height:1.7; letter-spacing:0.5px;">
          • Selecciona el tipo de <strong style="color:#b8d44a;">aterrizaje</strong> a realizar para verificar los parámetros operacionales, velocidades de referencia y procedimientos de contingencia (OEI / Balked Landing) antes de la maniobra.
        </div>
        <div id="ldg-cards" style="display:flex; gap:8px; padding:10px 16px; flex-wrap:wrap;">
          <button class="prof-card" onclick="selectLDG('catb')"          id="ldgcard-catb">CAT B</button>
          <button class="prof-card cat-a" onclick="selectLDG('clear')"   id="ldgcard-clear">CAT A<br><small>CLEAR AREA</small></button>
          <button class="prof-card cat-a" onclick="selectLDG('heli')"    id="ldgcard-heli">CAT A<br><small>HELIPORT</small></button>
          <button class="prof-card cat-a" onclick="selectLDG('heliv')"   id="ldgcard-heliv">CAT A<br><small>HELIPORT<br>VAR. LDP</small></button>
          <button class="prof-card cat-a" onclick="selectLDG('conf250')" id="ldgcard-conf250">CAT A<br><small>CONFINED<br>LDP =250ft</small></button>
          <button class="prof-card cat-a" onclick="selectLDG('confabv')" id="ldgcard-confabv">CAT A<br><small>CONFINED<br>LDP &gt;250ft</small></button>
        </div>
        <div id="ldg-detail" style="display:none; padding:0 16px 16px;"></div>
      </div>
    </div><!-- /panel-profiles -->

    <!-- ------------------ ABORT START ------------------ -->
    <div class="section-panel" id="panel-abort">
      <div class="banner amber">ABORTED ENGINE START PROCEDURES</div>

      <!-- CAUTION block -->
      <div style="margin:12px 20px 0; padding:10px 14px; background:#1a0800; border:2px solid #e88f00; border-radius:2px;">
        <div style="font-family:'Barlow Condensed',sans-serif; font-size:13px; font-weight:700; color:#ffb940; letter-spacing:2px; text-align:center; margin-bottom:6px;">⚠ CAUTION</div>
        <div style="font-family:'Share Tech Mono',monospace; font-size:10px; color:#d4a060; line-height:1.7; letter-spacing:0.3px; align-items: center;">
          Failure to follow the appropriate Abort Procedure may cause damage to the engine.
        </div>
      </div>

      <!-- Context / conditions block -->
      <div style="margin:10px 20px 0; padding:10px 14px; background:#0d1520; border-left:3px solid #c9a84c; font-family:'Share Tech Mono',monospace; font-size:10px; color:#7a9aaa; line-height:1.8; letter-spacing:0.3px;">
        Engine starting malfunctions are most likely to occur during the engine acceleration cycle to IDLE speed.<br><br>
        <span style="color:#c9a84c; font-weight:700;">Monitor engine start and abort if any of the following occur:</span>
      </div>

      <!-- Abort trigger conditions -->
      <div style="margin:0 20px 10px; padding:10px 14px; background:#080f1a; border:1px solid #1a2a3a; border-top:none;">
        <table style="width:100%; border-collapse:collapse; font-family:'Share Tech Mono',monospace; font-size:10px;">
          <tr style="background:#0d1828;">
            <td style="padding:6px 10px; color:#ff9a4a; border-bottom:1px solid #1a2a3a;">
              <span style="color:#ff4444; margin-right:8px;">–</span>Light up is NOT within 10 seconds of ENG MODE to IDLE
            </td>
          </tr>
          <tr>
            <td style="padding:6px 10px; color:#ff9a4a; border-bottom:1px solid #1a2a3a;">
              <span style="color:#ff4444; margin-right:8px;">–</span>Abnormal noise heard
            </td>
          </tr>
          <tr style="background:#0d1828;">
            <td style="padding:6px 10px; color:#ff9a4a; border-bottom:1px solid #1a2a3a;">
              <span style="color:#ff4444; margin-right:8px;">–</span>ITT increases beyond engine limits <span style="color:#ffb940;">(HOT START caution illuminated)</span>
            </td>
          </tr>
          <tr>
            <td style="padding:6px 10px; color:#ff9a4a; border-bottom:1px solid #1a2a3a;">
              <span style="color:#ff4444; margin-right:8px;">–</span>Engine hangs <span style="color:#ffb940;">(stagnation in NG below 54%)</span>
            </td>
          </tr>
          <tr style="background:#0d1828;">
            <td style="padding:6px 10px; color:#ff9a4a; border-bottom:1px solid #1a2a3a;">
              <span style="color:#ff4444; margin-right:8px;">–</span>Main rotor has NOT begun to rotate when gas generator (NG) reaches 40%
            </td>
          </tr>
          <tr>
            <td style="padding:6px 10px; color:#ff9a4a;">
              <span style="color:#ff4444; margin-right:8px;">–</span>Engine starter fails to disengage by <span style="color:#ffb940;">49% NG</span>
            </td>
          </tr>
        </table>
      </div>

      <!-- Checklist -->
      <div class="cl-section" data-section="abort" style="margin-top:4px;">
        <div class="cl-section-header" style="border-bottom-color: var(--amber);">SHUT DOWN ENGINE – PROCEDURE</div>
        <table class="cl-table">
          <tr onclick="toggle(this)"><td class="item-num">1</td><td class="item-name">ENG MODE Switch</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row"><td colspan="5" style="text-align: center;"><strong style="color: #c65a41;">If Engine Does Not Shut Down</strong>  <span style="display:inline-block; width:16px;"></span><strong style="color:darkorange">ECL -OFF</strong></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">2</td><td class="item-name">FUEL PUMP Switch</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">3</td><td class="item-name">ENG FUEL Switch</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">4</td><td class="item-name">Perform Dry Motoring</td><td class="item-action">30 sec.</td><td class="check-col"><div class="check-box"></div></td></tr>
        </table>
      </div>

      <div class="reset-bar">
        <button class="check-all-btn" onclick="checkAll('abort')">CHECK ALL</button>
        <button class="reset-btn" onclick="resetSection('abort')">RESET</button>
      </div>
      <div class="progress-bar-wrap">
        <div class="progress-bar"><div class="progress-fill" id="prog-abort" style="width:0%"></div></div>
        <div class="progress-label" id="label-abort">0 / 0</div>
      </div>
    </div>

    <!-- ------------------ DRY MOTORING ------------------ -->
    <div class="section-panel" id="panel-drymot">
      <div class="banner green"> DRY MOTORING RUN</div>
      <div class="cl-section" data-section="drymot" style="margin-top:12px;">
        <div class="cl-section-header" style="border-bottom-color: var(--green);">DRY MOTORING RUN</div>
        <table class="cl-table">
          <tr class="ff-row"onclick="toggle(this)"><td class="item-num">1</td><td class="item-name">ENG GOV Switch</td><td class="item-action">AUTO</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">2</td><td class="item-name">ENG MODE Switch</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">3</td><td class="item-name">ECL</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">4</td><td class="item-name">FUEL PUMP Switch</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">5</td><td class="item-name">ENG FUEL Switch</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">6</td><td class="item-name">ENG IGN CB (White Ring)</td><td class="item-action">OUT</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">7</td><td class="item-name">ENG MODE Switch (45" max)</td><td class="item-action">IDLE</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">8</td><td class="item-name">NG</td><td class="item-action">Increasing</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">9</td><td class="item-name">ENG MODE Switch</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">10</td><td class="item-name">ENG IGN CB (White Ring)</td><td class="item-action">IN</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="row-repeat"><td colspan="4">REPEAT ALL ITEMS FOR 2nd ENGINE</td></tr>
        </table>
      </div>
      <div class="reset-bar">
        <button class="check-all-btn" onclick="checkAll('drymot')">CHECK ALL</button>
        <button class="reset-btn" onclick="resetSection('drymot')">RESET</button>
      </div>
      <div class="progress-bar-wrap">
        <div class="progress-bar"><div class="progress-fill" id="prog-drymot" style="width:0%"></div></div>
        <div class="progress-label" id="label-drymot">0 / 0</div>
      </div>
    </div>

    <!-- ------------------ EXHAUST FIRE ------------------ -->
    <div class="section-panel" id="panel-exhaust">
      <div class="banner red">⚠ AFTER SHUTDOWN – ENGINE EXHAUST FIRE</div>
      <div class="info-block">
        Confirm Fire Warnings NOT illuminated before proceeding.<br>
        If fire persists after motoring – EVACUATE AIRCRAFT immediately.
      </div>
      <div class="cl-section" data-section="exhaust">
        <div class="cl-section-header" style="border-bottom-color: var(--red);">AFTER SHUTDOWN – ENGINE EXHAUST FIRE</div>
        <table class="cl-table">
          <tr onclick="toggle(this)"><td class="item-num">1</td><td class="item-name">Fire Warnings</td><td class="item-action">Confirm NOT Illuminated</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">2</td><td class="item-name">ENG GOV Switch</td><td class="item-action">MAN</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">3</td><td class="item-name">ENG IGN CB (White Ring)</td><td class="item-action">OUT</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">4</td><td class="item-name">BUS TIE Switch</td><td class="item-action">ON</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">5</td><td class="item-name">ECL</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">6</td><td class="item-name">ECL Starter Pushbutton</td><td class="item-action">PUSH</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">7</td><td class="item-name">Gas Generator (NG)</td><td class="item-action">Note increasing</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">8</td><td class="item-name">ECL Starter Pushbutton</td><td class="item-action">Push to STOP</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)" style="background:#2a0a0a;"><td class="item-num">9</td><td class="item-name" style="color:#ff6b6b; font-weight:700;">Rotors stopped → EVACUATE AIRCRAFT</td><td class="item-action" style="color:#ff6b6b;">⚠ EVACUATE</td><td class="check-col"><div class="check-box"></div></td></tr>
        </table>
      </div>
      <div class="reset-bar">
        <button class="reset-btn" onclick="resetSection('exhaust')">RESET</button>
      </div>
      <div class="progress-bar-wrap">
        <div class="progress-bar"><div class="progress-fill" id="prog-exhaust" style="width:0%"></div></div>
        <div class="progress-label" id="label-exhaust">0 / 0</div>
      </div>
    </div>

  </div><!-- /content -->
</div><!-- /main -->

  <!-- Update banner -->
  <div id="update-banner" class="update-banner" role="status" aria-live="polite">
    <span>Hay una nueva versión disponible.</span>
    <button id="update-btn" type="button">Actualizar</button>
  </div>

<script>
const labels = {
  cockpit: 'COCKPIT SAFETY / PRE-START',
  start: 'ENGINE START',
  syschecks: 'SYSTEM CHECKS',
  taxi: 'TAXI / TAKE-OFF',
  cruise: 'CRUISE / LANDING',
  shutdown: 'SHUT DOWN',
  ifr: 'IFR DEP / APP',
  subsequent: 'SUBSEQUENT STARTS',
  pac: 'POWER ASSURANCE CHECK',
  profiles: 'T/O & LANDING CATEGORY PROFILES',
  abort: 'ABORTED ENGINE START',
  drymot: 'DRY MOTORING RUN',
  exhaust: 'AFTER SHUTDOWN – EXHAUST FIRE'
};

function show(id) {
  document.querySelectorAll('.section-panel').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
  document.getElementById('panel-' + id).classList.add('active');
  document.getElementById('btn-' + id).classList.add('active');
  document.getElementById('section-label').textContent = labels[id];
  if (id === 'pac') setTimeout(initPACChart, 50);
  updateProgress(id);
}

function toggle(row) {
  if (!row.onclick) return;
  row.classList.toggle('checked');
  const section = row.closest('[data-section]');
  if (section) updateProgressForSection(section.dataset.section);
}

function updateProgress(id) {
  const panel = document.getElementById('panel-' + id);
  const allClickable = panel.querySelectorAll('tr[onclick]');
  const checked = panel.querySelectorAll('tr.checked');
  const pct = allClickable.length ? (checked.length / allClickable.length * 100) : 0;
  const fill = document.getElementById('prog-' + id);
  const lbl = document.getElementById('label-' + id);
  if (fill) fill.style.width = pct + '%';
  if (lbl) lbl.textContent = checked.length + ' / ' + allClickable.length;
}

function updateProgressForSection(id) {
  // find the active panel
  const activePanel = document.querySelector('.section-panel.active');
  if (!activePanel) return;
  const panelId = activePanel.id.replace('panel-', '');
  updateProgress(panelId);
}

function resetSection(id) {
  const panel = document.getElementById('panel-' + id);
  panel.querySelectorAll('tr.checked').forEach(r => r.classList.remove('checked'));
  updateProgress(id);
}

function checkAll(id) {
  const panel = document.getElementById('panel-' + id);
  panel.querySelectorAll('tr[onclick]').forEach(r => r.classList.add('checked'));
  updateProgress(id);
}

// -------------------------------------------------------
// PAC CHART ENGINE – Figure 4-5 PWC PT6C-67C
// Anchored to RFM example: TQ=102%, PA=5000ft, OAT=-10°C
// ? ITT_max=620°C, NG_max=91.5%  ?
// -------------------------------------------------------

// Chart data tables (calibrated from RFM Figure 4-5)
const OAT_STEPS = [-40,-30,-20,-10,0,10,20,30,40,50];
const PA_STEPS  = [-1000,0,1000,2000,3000,4000,5000,6000,7000,8000,9000,10000,11000,12000,13000,14000];

// ITT max = 620 at PA=5000, OAT=-10 (anchor)
// Slopes: -3.5°C / 1000ft PA increase; +33°C / 10°C OAT decrease
function ITTmax(pa, oat) {
  return Math.min(800, 620 - (pa - 5000)/1000*3.5 - (oat - (-10))/10*33);
}
// NG max = 91.5 at PA=5000, OAT=-10 (anchor)
// Slopes: -1.4% / 1000ft PA increase; +2.4% / 10°C OAT decrease
function NGmax(pa, oat) {
  return Math.min(102.4, 91.5 - (pa - 5000)/1000*1.4 - (oat - (-10))/10*2.4);
}

// -- Canvas chart drawing ------------------------------
const C = { // chart layout constants
  w: 860, h: 420,
  pad: { t:40, b:58, l:10, r:10 },
  // three sub-charts: LEFT (TQ), MIDDLE (ITT), RIGHT (NG)
  // x ranges and widths
  sections: null // computed below
};

function buildSections() {
  const innerW = C.w - C.pad.l - C.pad.r;
  const leftW  = Math.round(innerW * 0.28);
  const midW   = Math.round(innerW * 0.40);
  const rightW = innerW - leftW - midW;
  return [
    { id:'tq',  x0: C.pad.l,            w: leftW,  xMin:90,  xMax:105,  label:'ENGINE TORQUE TQ (%)',      yLabel:'PRESSURE ALT. (ft)' },
    { id:'itt', x0: C.pad.l + leftW,    w: midW,   xMin:500, xMax:800,  label:'MAXIMUM ALLOWABLE ITT (°C)',yLabel:null },
    { id:'ng',  x0: C.pad.l + leftW + midW, w: rightW, xMin:80, xMax:105, label:'MAXIMUM ALLOWABLE NG (%)', yLabel:null }
  ];
}
C.sections = buildSections();

const PA_MIN = -1000, PA_MAX = 14000;

function paToY(pa, canvas_h) {
  const innerH = canvas_h - C.pad.t - C.pad.b;
  return C.pad.t + innerH * (1 - (pa - PA_MIN) / (PA_MAX - PA_MIN));
}
function valToX(val, sec) {
  return sec.x0 + sec.w * (val - sec.xMin) / (sec.xMax - sec.xMin);
}
function yToPA(y, canvas_h) {
  const innerH = canvas_h - C.pad.t - C.pad.b;
  return PA_MIN + (PA_MAX - PA_MIN) * (1 - (y - C.pad.t) / innerH);
}

// Engine state for dual-engine plotting
const engState = { 1: null, 2: null };
const engColor = { 1:'#c9a84c', 2:'#7ab0ff' }; // gold=ENG1, blue=ENG2

function drawChart(canvas) {
  const ctx = canvas.getContext('2d');
  ctx.clearRect(0, 0, C.w, C.h);

  // Background
  ctx.fillStyle = '#050e1a';
  ctx.fillRect(0, 0, C.w, C.h);

  const secs = C.sections;
  const H = C.h;

  // -- Grid lines (horizontal = PA levels) --
  const paGridLines = [-1000,0,1000,2000,3000,4000,5000,6000,7000,8000,9000,10000,11000,12000,13000,14000];
  paGridLines.forEach(pa => {
    const y = paToY(pa, H);
    // light grid across all three sections
    secs.forEach(sec => {
      ctx.strokeStyle = pa % 2000 === 0 ? '#1a2a40' : '#111e30';
      ctx.lineWidth = pa % 2000 === 0 ? 0.8 : 0.4;
      ctx.beginPath();
      ctx.moveTo(sec.x0, y);
      ctx.lineTo(sec.x0 + sec.w, y);
      ctx.stroke();
    });
  });

  // -- Section separators --
  secs.forEach(sec => {
    ctx.strokeStyle = '#253555';
    ctx.lineWidth = 1;
    ctx.beginPath(); ctx.moveTo(sec.x0, C.pad.t); ctx.lineTo(sec.x0, H - C.pad.b); ctx.stroke();
    ctx.beginPath(); ctx.moveTo(sec.x0 + sec.w, C.pad.t); ctx.lineTo(sec.x0 + sec.w, H - C.pad.b); ctx.stroke();
  });

  // -- Y axis (PA) labels – left section only --
  ctx.font = '8px Share Tech Mono, monospace';
  ctx.fillStyle = '#4a6080';
  ctx.textAlign = 'right';
  paGridLines.filter(pa => pa % 2000 === 0).forEach(pa => {
    const y = paToY(pa, H);
    const label = pa < 0 ? `-${Math.abs(pa)}` : `${pa}`;
    ctx.fillText(label, secs[0].x0 + secs[0].w - 3, y + 3);
  });

  // -- PA label on left --
  ctx.save();
  ctx.translate(8, H/2);
  ctx.rotate(-Math.PI/2);
  ctx.textAlign = 'center';
  ctx.font = '8px Share Tech Mono, monospace';
  ctx.fillStyle = '#3a5070';
  ctx.fillText('PRESSURE ALT. (ft)', 0, 0);
  ctx.restore();

  // -- Section headers --
  secs.forEach(sec => {
    ctx.textAlign = 'center';
    ctx.font = 'bold 9px Barlow Condensed, sans-serif';
    ctx.fillStyle = '#6a8aaa';
    ctx.fillText(sec.label, sec.x0 + sec.w/2, C.pad.t - 8);
  });

  // -- X axis ticks & labels --
  // TQ section
  ctx.font = '8px Share Tech Mono, monospace';
  ctx.fillStyle = '#4a6080';
  ctx.textAlign = 'center';
  for (let tq = 90; tq <= 105; tq += 5) {
    const x = valToX(tq, secs[0]);
    ctx.strokeStyle = '#1a2a40'; ctx.lineWidth = 0.6;
    ctx.beginPath(); ctx.moveTo(x, C.pad.t); ctx.lineTo(x, H - C.pad.b); ctx.stroke();
    ctx.fillText(tq, x, H - C.pad.b + 12);
  }
  // ITT section
  for (let itt = 500; itt <= 800; itt += 50) {
    const x = valToX(itt, secs[1]);
    ctx.strokeStyle = '#1a2a40'; ctx.lineWidth = 0.6;
    ctx.beginPath(); ctx.moveTo(x, C.pad.t); ctx.lineTo(x, H - C.pad.b); ctx.stroke();
    ctx.fillText(itt, x, H - C.pad.b + 12);
  }
  // NG section
  for (let ng = 80; ng <= 105; ng += 5) {
    const x = valToX(ng, secs[2]);
    ctx.strokeStyle = '#1a2a40'; ctx.lineWidth = 0.6;
    ctx.beginPath(); ctx.moveTo(x, C.pad.t); ctx.lineTo(x, H - C.pad.b); ctx.stroke();
    ctx.fillText(ng, x, H - C.pad.b + 12);
  }

  // -- Draw PA curves in TQ section --
  // In the TQ graph: for each PA level, plot TQ vs PA
  // The TQ needed to achieve a given PA level for a standard atmosphere
  // In fact the left chart is simply: horizontal lines at each PA level
  // connecting to the PA grid. The "PA curves" in TQ chart are diagonal
  // lines showing that higher TQ is needed at higher PA.
  // Approximation from chart: at PA=0, max TQ≈96%; at PA=14000, TQ=105%
  // Line: TQ = 96 + PA/14000 * 9 (rough linear from chart)
  paGridLines.filter(pa => pa % 1000 === 0).forEach(pa => {
    // TQ range for this PA curve: roughly linear from 90 to 105
    const tqAtPA = Math.max(90, Math.min(105, 90 + (pa + 1000) / 15000 * 10));
    const y = paToY(pa, H);
    const alpha = pa % 2000 === 0 ? 0.55 : 0.3;
    ctx.strokeStyle = `rgba(30,80,140,${alpha})`;
    ctx.lineWidth = pa % 2000 === 0 ? 1.2 : 0.6;
    ctx.setLineDash([]);
    // Draw diagonal PA curve: from TQ=90 to tqAtPA
    ctx.beginPath();
    const xStart = valToX(90, secs[0]);
    const xEnd   = valToX(Math.min(105, tqAtPA + 3), secs[0]);
    const yStart = paToY(Math.max(PA_MIN, pa + 3000), H);
    ctx.moveTo(xEnd, y);
    ctx.lineTo(xStart, yStart);
    ctx.stroke();
    // Label on major lines
    if (pa % 2000 === 0 && pa >= 0) {
      ctx.fillStyle = '#3a608a';
      ctx.font = '7px Share Tech Mono, monospace';
      ctx.textAlign = 'left';
      ctx.fillText(`${pa}`, xStart + 2, yStart - 2);
    }
  });

  // -- Draw OAT curves in ITT and NG sections --
  OAT_STEPS.forEach(oat => {
    const isMainOAT = oat % 20 === 0;
    const alpha = isMainOAT ? 0.7 : 0.4;
    const lw = isMainOAT ? 1.0 : 0.5;
    const col = `rgba(30,90,160,${alpha})`;

    // ITT curve
    ctx.strokeStyle = col; ctx.lineWidth = lw;
    ctx.beginPath();
    let first = true;
    PA_STEPS.forEach(pa => {
      const x = valToX(ITTmax(pa, oat), secs[1]);
      const y = paToY(pa, H);
      if (x < secs[1].x0 || x > secs[1].x0 + secs[1].w) { first=true; return; }
      if (first) { ctx.moveTo(x, y); first=false; } else ctx.lineTo(x, y);
    });
    ctx.stroke();
    // OAT label at bottom of ITT curve
    if (isMainOAT) {
      const pa_label = -500;
      const x = valToX(ITTmax(pa_label, oat), secs[1]);
      const y = paToY(pa_label, H) + 6;
      if (x >= secs[1].x0 && x <= secs[1].x0 + secs[1].w) {
        ctx.save();
        ctx.translate(x+4, y);
        ctx.rotate(Math.PI/4);
        ctx.fillStyle = '#3a6090';
        ctx.font = '7px Share Tech Mono, monospace';
        ctx.textAlign = 'left';
        ctx.fillText(`${oat>0?'+':''}${oat}°`, 0, 0);
        ctx.restore();
      }
    }

    // NG curve
    ctx.strokeStyle = col; ctx.lineWidth = lw;
    ctx.beginPath(); first = true;
    PA_STEPS.forEach(pa => {
      const x = valToX(NGmax(pa, oat), secs[2]);
      const y = paToY(pa, H);
      if (x < secs[2].x0 || x > secs[2].x0 + secs[2].w) { first=true; return; }
      if (first) { ctx.moveTo(x, y); first=false; } else ctx.lineTo(x, y);
    });
    ctx.stroke();
    // OAT label
    if (isMainOAT) {
      const pa_label = -500;
      const x = valToX(NGmax(pa_label, oat), secs[2]);
      const y = paToY(pa_label, H) + 6;
      if (x >= secs[2].x0 && x <= secs[2].x0 + secs[2].w) {
        ctx.save();
        ctx.translate(x+4, y);
        ctx.rotate(Math.PI/4);
        ctx.fillStyle = '#3a6090';
        ctx.font = '7px Share Tech Mono, monospace';
        ctx.textAlign = 'left';
        ctx.fillText(`${oat>0?'+':''}${oat}°`, 0, 0);
        ctx.restore();
      }
    }
  });

  // -- Limit lines --
  // TQ limit 105%
  const xTQlim = valToX(105, secs[0]);
  ctx.strokeStyle = '#cc2222'; ctx.lineWidth = 1; ctx.setLineDash([4,3]);
  ctx.beginPath(); ctx.moveTo(xTQlim, C.pad.t); ctx.lineTo(xTQlim, H - C.pad.b); ctx.stroke();
  // ITT limit 775°C
  const xITTlim = valToX(775, secs[1]);
  if (xITTlim <= secs[1].x0 + secs[1].w) {
    ctx.strokeStyle = '#cc2222'; ctx.lineWidth = 1;
    ctx.beginPath(); ctx.moveTo(xITTlim, C.pad.t); ctx.lineTo(xITTlim, H - C.pad.b); ctx.stroke();
  }
  // NG limit 102.4%
  const xNGlim = valToX(102.4, secs[2]);
  ctx.strokeStyle = '#cc2222'; ctx.lineWidth = 1;
  ctx.beginPath(); ctx.moveTo(xNGlim, C.pad.t); ctx.lineTo(xNGlim, H - C.pad.b); ctx.stroke();
  ctx.setLineDash([]);

  // -- Draw engine traces --
  [1, 2].forEach(eng => {
    const st = engState[eng];
    if (!st) return;
    drawTrace(ctx, eng, st, H);
  });

  // -- Axis bottom line --
  secs.forEach(sec => {
    ctx.strokeStyle = '#253555'; ctx.lineWidth = 1; ctx.setLineDash([]);
    ctx.beginPath(); ctx.moveTo(sec.x0, H - C.pad.b); ctx.lineTo(sec.x0 + sec.w, H - C.pad.b); ctx.stroke();
    ctx.beginPath(); ctx.moveTo(sec.x0, C.pad.t); ctx.lineTo(sec.x0 + sec.w, C.pad.t); ctx.stroke();
  });
}

function drawTrace(ctx, eng, st, H) {
  const { tq, pa, oat, itt, ng, ittMax, ngMax } = st;
  const col = engColor[eng];
  const secs = C.sections;
  ctx.setLineDash([]);

  // -- STEP 1: Vertical line in TQ chart at TQ value --
  const xTQ = valToX(tq, secs[0]);
  const yPA  = paToY(pa, H);
  ctx.strokeStyle = col; ctx.lineWidth = 2;
  ctx.beginPath(); ctx.moveTo(xTQ, C.pad.t); ctx.lineTo(xTQ, yPA); ctx.stroke();
  // dot at TQ entry
  ctx.fillStyle = col;
  ctx.beginPath(); ctx.arc(xTQ, C.pad.t + 6, 4, 0, Math.PI*2); ctx.fill();
  // down arrow to PA
  drawArrow(ctx, xTQ, C.pad.t + 20, xTQ, yPA, col);

  // -- STEP 2: Horizontal line from TQ chart ? ITT chart ? NG chart --
  const xITTend = valToX(ittMax, secs[1]);
  const xNGend  = valToX(ngMax,  secs[2]);

  ctx.strokeStyle = col; ctx.lineWidth = 2; ctx.setLineDash([6,3]);
  ctx.beginPath();
  ctx.moveTo(xTQ, yPA);
  ctx.lineTo(xNGend + 10, yPA);
  ctx.stroke();
  ctx.setLineDash([]);

  // -- STEP 3: Vertical up from ITT curve intersection --
  drawArrow(ctx, xITTend, yPA, xITTend, C.pad.t + 8, col);

  // -- Dot at ITT max reading --
  ctx.fillStyle = col;
  ctx.beginPath(); ctx.arc(xITTend, C.pad.t + 8, 4, 0, Math.PI*2); ctx.fill();

  // -- Dot at NG max reading --
  drawArrow(ctx, xNGend, yPA, xNGend, C.pad.t + 8, col);
  ctx.fillStyle = col;
  ctx.beginPath(); ctx.arc(xNGend, C.pad.t + 8, 4, 0, Math.PI*2); ctx.fill();

  // -- Measured ITT vertical line --
  const xITTmeas = valToX(itt, secs[1]);
  const ittOk = itt <= ittMax;
  ctx.strokeStyle = ittOk ? '#2adf60' : '#ff4444';
  ctx.lineWidth = 1.5; ctx.setLineDash([3,2]);
  ctx.beginPath(); ctx.moveTo(xITTmeas, yPA + 4); ctx.lineTo(xITTmeas, H - C.pad.b - 4); ctx.stroke();
  ctx.setLineDash([]);
  ctx.fillStyle = ittOk ? '#2adf60' : '#ff4444';
  ctx.beginPath(); ctx.arc(xITTmeas, yPA, 5, 0, Math.PI*2); ctx.fill();
  // PAM ITT label
  const pamITT = Math.round(ittMax - itt);
  ctx.font = 'bold 9px Share Tech Mono, monospace';
  ctx.textAlign = 'center';
  ctx.fillStyle = ittOk ? '#2adf60' : '#ff4444';
  ctx.fillText(`PAM${pamITT>0?'+':''}${pamITT}°`, xITTmeas, H - C.pad.b + 24);

  // -- Measured NG vertical line --
  const xNGmeas = valToX(ng, secs[2]);
  const ngOk = ng <= ngMax;
  ctx.strokeStyle = ngOk ? '#2adf60' : '#ff4444';
  ctx.lineWidth = 1.5; ctx.setLineDash([3,2]);
  ctx.beginPath(); ctx.moveTo(xNGmeas, yPA + 4); ctx.lineTo(xNGmeas, H - C.pad.b - 4); ctx.stroke();
  ctx.setLineDash([]);
  ctx.fillStyle = ngOk ? '#2adf60' : '#ff4444';
  ctx.beginPath(); ctx.arc(xNGmeas, yPA, 5, 0, Math.PI*2); ctx.fill();
  const pamNG = (ngMax - ng).toFixed(1);
  ctx.font = 'bold 9px Share Tech Mono, monospace';
  ctx.textAlign = 'center';
  ctx.fillStyle = ngOk ? '#2adf60' : '#ff4444';
  ctx.fillText(`PAM${pamNG>0?'+':''}${pamNG}%`, xNGmeas, H - C.pad.b + 24);

  // -- Engine label --
  ctx.fillStyle = col;
  ctx.font = 'bold 10px Barlow Condensed, sans-serif';
  ctx.textAlign = 'center';
  ctx.fillText(`E${eng}`, xTQ, yPA - 8);
}

function drawArrow(ctx, x1, y1, x2, y2, col) {
  ctx.strokeStyle = col; ctx.lineWidth = 2; ctx.setLineDash([]);
  ctx.beginPath(); ctx.moveTo(x1, y1); ctx.lineTo(x2, y2); ctx.stroke();
  // arrowhead
  const angle = Math.atan2(y2 - y1, x2 - x1);
  ctx.fillStyle = col;
  ctx.beginPath();
  ctx.moveTo(x2, y2);
  ctx.lineTo(x2 - 6*Math.cos(angle-0.4), y2 - 6*Math.sin(angle-0.4));
  ctx.lineTo(x2 - 6*Math.cos(angle+0.4), y2 - 6*Math.sin(angle+0.4));
  ctx.closePath(); ctx.fill();
}

function runPAC() {
  const eng = parseInt(document.getElementById('pac-eng').value);
  const tq  = parseFloat(document.getElementById('pac-tq').value);
  const pa  = parseFloat(document.getElementById('pac-pa').value);
  const oat = parseFloat(document.getElementById('pac-oat').value);
  const itt = parseFloat(document.getElementById('pac-itt').value);
  const ng  = parseFloat(document.getElementById('pac-ng').value);

  if ([tq,pa,oat,itt,ng].some(isNaN)) {
    alert('Por favor ingrese todos los valores: TQ, Presión Altitud, OAT, ITT y NG.');
    return;
  }
  if (tq < 90 || tq > 105) { alert('TQ debe estar entre 90% y 105%'); return; }
  if (pa < -1000 || pa > 14000) { alert('Presión Altitud fuera de rango de carta (-1000 a 14000 ft)'); return; }
  if (oat < -40 || oat > 50) { alert('OAT fuera de rango de carta (-40 a +50°C)'); return; }

  const ittMax = Math.round(ITTmax(pa, oat) * 10) / 10;
  const ngMax  = Math.round(NGmax(pa, oat)  * 100) / 100;
  const pamITT = Math.round((ittMax - itt) * 10) / 10;
  const pamNG  = Math.round((ngMax  - ng)  * 100) / 100;
  const ittOk  = itt <= ittMax;
  const ngOk   = ng  <= ngMax;
  const allOk  = ittOk && ngOk;

  // Store state
  engState[eng] = { tq, pa, oat, itt, ng, ittMax, ngMax, pamITT, pamNG };

  // Redraw chart
  const canvas = document.getElementById('pac-canvas');
  drawChart(canvas);

  // Result banner
  const banner = document.getElementById('pac-result-banner');
  banner.style.display = 'block';
  if (allOk) {
    banner.style.background = '#051508'; banner.style.borderTop = '2px solid #2adf60'; banner.style.color = '#2adf60';
    banner.innerHTML = `✓ ENG ${eng} – DENTRO DE LÍMITES<br>` +
      `&nbsp;&nbsp;ITT: ${itt}°C medido = ${ittMax}°C máx → PAM = <strong>+${pamITT}°C</strong><br>` +
      `&nbsp;&nbsp;NG:  ${ng}% medido = ${ngMax}% máx → PAM = <strong>+${pamNG}%</strong><br>` +
      `&nbsp;&nbsp;Motor aceptable para vuelo. ✓`;
  } else {
    banner.style.background = '#150303'; banner.style.borderTop = '2px solid #ff4444'; banner.style.color = '#ff8888';
    let msg = `✖ ENG ${eng} – LÍMITE(S) EXCEDIDO(S)<br>`;
    if (!ittOk) msg += `&nbsp;&nbsp;ITT: ${itt}°C EXCEDE máximo ${ittMax}°C → PAM = <strong>${pamITT}°C</strong><br>`;
    if (!ngOk)  msg += `&nbsp;&nbsp;NG:  ${ng}% EXCEDE máximo ${ngMax}% → PAM = <strong>${pamNG}%</strong><br>`;
    msg += `&nbsp;&nbsp;NO CONTINUAR VUELO. REFERIR A EMM PARA ACCIONES REQUERIDAS.`;
    banner.innerHTML = msg;
  }

  // Update log table
  const logRow = document.getElementById(`pac-log-${eng}`);
  const cells = logRow.querySelectorAll('td');
  const engCol = engColor[eng];
  cells[1].style.color = cells[1].style.color; // keep
  cells[1].textContent = `${tq}%`;
  cells[2].textContent = `${pa}`;
  cells[3].textContent = `${oat>0?'+':''}${oat}°C`;
  cells[4].textContent = `${itt}°C`; cells[4].style.color = ittOk ? '#2adf60' : '#ff4444';
  cells[5].textContent = `${ittMax}°C`; cells[5].style.color = '#c9a84c';
  cells[6].textContent = `${pamITT>0?'+':''}${pamITT}°C`; cells[6].style.color = ittOk ? '#2adf60' : '#ff4444';
  cells[7].textContent = `${ng}%`; cells[7].style.color = ngOk ? '#2adf60' : '#ff4444';
  cells[8].textContent = `${ngMax}%`; cells[8].style.color = '#c9a84c';
  cells[9].textContent = `${pamNG>0?'+':''}${pamNG}%`; cells[9].style.color = ngOk ? '#2adf60' : '#ff4444';
  cells[10].innerHTML = allOk ? '<span style="color:#2adf60;font-weight:700;">✓ OK</span>' : '<span style="color:#ff4444;font-weight:700;">✖ EXCEDIDO</span>';
}

function clearPAC() {
  engState[1] = null; engState[2] = null;
  ['pac-tq','pac-pa','pac-oat','pac-itt','pac-ng'].forEach(id => document.getElementById(id).value = '');
  document.getElementById('pac-result-banner').style.display = 'none';
  const canvas = document.getElementById('pac-canvas');
  drawChart(canvas);
  // Reset log table
  [1,2].forEach(eng => {
    const row = document.getElementById(`pac-log-${eng}`);
    const cells = row.querySelectorAll('td');
    for (let i=1; i<=10; i++) { cells[i].textContent = '–'; cells[i].style.color = 'var(--dim)'; }
  });
}

function loadRFMExample() {
  document.getElementById('pac-eng').value = '1';
  document.getElementById('pac-tq').value  = '102';
  document.getElementById('pac-pa').value  = '5000';
  document.getElementById('pac-oat').value = '-10';
  document.getElementById('pac-itt').value = '600';
  document.getElementById('pac-ng').value  = '91';
  runPAC();
}

// Initialize chart on panel show
function initPACChart() {
  const canvas = document.getElementById('pac-canvas');
  if (canvas) drawChart(canvas);
}

// -------------------------------------------------------
// T/O & LANDING CAT PROFILES ENGINE
// Source: PMC-39-A0126-CP001-00 Issue 002 – 2025.02.28
// -------------------------------------------------------

const TO_PROFILES = {
  catb: {
    name: 'CAT B', color: '#6a8aaa', badge: '#1a3a5a',
    params: [
      { label: 'NR Switch', value: '100%' },
      { label: 'PARK BRK', value: 'OFF' },
      { label: 'T.O. PWR', value: '5 ft HOV +5%' },
      { label: 'T.O. Attitude', value: 'CHANGE -7°' },
      { label: 'TDP', value: '50 ft / 50 KIAS (GATE)' },
      { label: 'VTOSS', value: '–' },
      { label: 'Climb Attitude', value: '–' },
      { label: 'VY', value: '80 KIAS' },
      { label: 'VY & 200 ft ATS*', value: 'LDG GEAR UP' },
    ],
    rto: [
      { label: 'Prior TDP – Collective', value: '100% NR' },
      { label: 'Cyclic', value: 'Flare to Reduce GS' },
      { label: 'Cushion Touchdown', value: '15° MAX NOSEUP – Running LDG' },
      { label: 'Attitude', value: '–' },
      { label: 'Collective', value: '–' },
    ],
    cto: null,
  },
  clear: {
    name: 'CAT A – CLEAR AREA', color: '#c9a84c', badge: '#3a2800',
    params: [
      { label: 'NR Switch', value: '102%' },
      { label: 'PARK BRK', value: 'OFF' },
      { label: 'T.O. PWR', value: '5 ft HOV +18%' },
      { label: 'T.O. Attitude', value: '-5°' },
      { label: 'TDP', value: '30 ft (50 KIAS achieved)' },
      { label: 'VTOSS', value: '50 KIAS' },
      { label: 'Climb Attitude', value: '~+5°' },
      { label: 'VY', value: '80 KIAS – NR SW 100%' },
      { label: 'VY & 200 ft ATS*', value: 'LDG GEAR UP' },
    ],
    rto: [
      { label: 'Prior TDP – Collective', value: '90% NR' },
      { label: 'Cyclic', value: 'Speed < 30 KTS GS' },
      { label: 'Cushion Touchdown', value: '5–10 ft – MAX 15° NOSEUP – Running LDG' },
      { label: 'Attitude', value: '+5°' },
      { label: 'Collective', value: 'DROOP TO MIN 90% NR – 2.5\' OEI – 160% PI' },
      { label: 'VTOSS', value: '50 KIAS' },
    ],
    cto: [
      { label: 'Positive ROC', value: 'NR to 102% – Climb 200 ft – Accel to VY – 5° Nose Up' },
      { label: 'VY', value: '80 KIAS – MCP OEI 140% PI – Climb to 1000 ft' },
      { label: 'Gear', value: 'UP' },
      { label: 'NR Switch', value: '100%' },
    ],
  },
  vertical: {
    name: 'CAT A – G&E H/H VERTICAL', color: '#c9a84c', badge: '#3a2800',
    params: [
      { label: 'NR Switch', value: '102%' },
      { label: 'PARK BRK', value: 'ON' },
      { label: 'T.O. PWR', value: '5 ft HOV +23% ± 2"' },
      { label: 'T.O. Attitude', value: '-10°, 0° @ TDP' },
      { label: 'TDP / TDPE', value: '_70_ / 35 ft' },
      { label: 'VTOSS', value: '40 KIAS' },
      { label: 'Climb Attitude', value: '~+5°' },
      { label: 'VY', value: '80 KIAS – NR SW 100%' },
      { label: 'VY & 200 ft ATS*', value: 'LDG GEAR UP' },
    ],
    rto: [
      { label: 'Prior TDP – Collective', value: '100% NR' },
      { label: 'Cyclic', value: 'Mantain Position over HPAD – -10° NOSE DN' },
      { label: 'Cushion Touchdown', value: '5–10 ft – 5 KTS GS MAX' },
      { label: 'Attitude', value: '-10°, 0°' },
      { label: 'Collective', value: 'DROOP TO MIN 90% NR – 2.5\' OEI – 160% PI' },
      { label: 'VTOSS', value: '40 KIAS' },
    ],
    cto: [
      { label: 'Positive ROC', value: 'NR to 102% – Climb 200 ft – Accel to VY – 5° Nose Up' },
      { label: 'VY', value: '80 KIAS – MCP OEI 140% PI – Climb to 1000 ft' },
      { label: 'Gear', value: 'UP' },
      { label: 'NR Switch', value: '100%' },
    ],
  },
  backup: {
    name: 'CAT A – G&E H/H BACK-UP', color: '#c9a84c', badge: '#3a2800',
    params: [
      { label: 'NR Switch', value: '102%' },
      { label: 'PARK BRK', value: 'ON' },
      { label: 'T.O. PWR', value: '5 ft HOV +23% ± 2"' },
      { label: 'T.O. Attitude', value: '-10°, 0° @ TDP' },
      { label: 'TDP / TDPE', value: '_400_ / 85 ft' },
      { label: 'VTOSS', value: '40 KIAS' },
      { label: 'Climb Attitude', value: '~+5°' },
      { label: 'VY', value: '80 KIAS – NR SW 100%' },
      { label: 'VY & 200 ft ATS*', value: 'LDG GEAR UP' },
    ],
    rto: [
      { label: 'Prior TDP – Collective', value: '100% NR' },
      { label: 'Cyclic', value: '-2° / 3° NOSE DN – Mantain HPAD in Chin Window' },
      { label: 'Cushion Touchdown', value: '5–10 ft – 5 KTS GS MAX' },
      { label: 'Attitude', value: '-10°, 0°' },
      { label: 'Collective', value: 'DROOP TO MIN 90% NR – 2.5\' OEI – 160% PI' },
      { label: 'VTOSS', value: '40 KIAS' },
    ],
    cto: [
      { label: 'Positive ROC', value: 'NR to 102% – Climb 200 ft – Accel to VY – 5° Nose Up' },
      { label: 'VY', value: '80 KIAS – MCP OEI 140% PI – Climb to 1000 ft' },
      { label: 'Gear', value: 'UP' },
      { label: 'NR Switch', value: '100%' },
    ],
  },
  confined: {
    name: 'CAT A – CONFINED AREA', color: '#c9a84c', badge: '#3a2800',
    params: [
      { label: 'NR Switch', value: '102%' },
      { label: 'PARK BRK', value: 'ON' },
      { label: 'T.O. PWR', value: '+10% (sin IBF) / +12% (con IBF) – MÁX +23%' },
      { label: 'T.O. Attitude', value: '-10°, 0° @ TDP' },
      { label: 'TDP / TDPE', value: '_400_ / 100 ft' },
      { label: 'VTOSS', value: '40 KIAS' },
      { label: 'Climb Attitude', value: '+5°' },
      { label: 'VY', value: '80 KIAS* – 100% NR' },
      { label: 'VY & 200 ft ATS*', value: 'LDG GEAR UP' },
    ],
    rto: [
      { label: 'Prior TDP – Collective', value: '100% NR' },
      { label: 'Cyclic', value: '-20° MAX NOSE DN @ 50 (20) ft ATS – 20° MAX NOSEUP CUSHION' },
      { label: 'Cushion Touchdown', value: '10–15 ft – 5 KTS GS MAX' },
      { label: 'Attitude', value: '-10°, 0°' },
      { label: 'Collective', value: 'SET 2.5 MIN PWR (PI 160) – DROOP MIN 90% NR' },
      { label: 'VTOSS', value: '40 KIAS' },
    ],
    cto: [
      { label: 'Positive ROC', value: 'NR to 102% – Climb 200 ft – 5° Nose Up' },
      { label: 'VY', value: '80 KIAS* – 100% NR – Gear UP' },
    ],
  },
  short: {
    name: 'CAT A – SHORT FIELD', color: '#c9a84c', badge: '#3a2800',
    params: [
      { label: 'NR Switch', value: '102%' },
      { label: 'PARK BRK', value: 'OFF' },
      { label: 'T.O. PWR', value: '5 ft HOV +23% ± 2"' },
      { label: 'T.O. Attitude', value: '-10°, 0° @ TDP / TDPE' },
      { label: 'TDP / TDPE', value: '_400_ / 35 ft' },
      { label: 'VTOSS', value: '40 KIAS' },
      { label: 'Climb Attitude', value: '~+5°' },
      { label: 'VY', value: '80 KIAS – NR SW 100%' },
      { label: 'VY & 200 ft ATS*', value: 'LDG GEAR UP' },
    ],
    rto: [
      { label: 'Prior TDP – Collective', value: '90% NR' },
      { label: 'Cyclic', value: '15° MAX NOSEUP – Running LDG 5–10 ft – 5 KTS GS MAX' },
      { label: 'Cushion Touchdown', value: '5–10 ft – 5 KTS GS MAX – MAX 15° NOSEUP – Running LDG' },
      { label: 'Attitude', value: '-10°, 0°' },
      { label: 'Collective', value: 'DROOP TO MIN 90% NR – 2.5\' OEI – 160% PI' },
      { label: 'VTOSS', value: '40 KIAS' },
    ],
    cto: [
      { label: 'Positive ROC', value: 'NR to 102% – Climb 200 ft – Accel to VY – 5° Nose Up' },
      { label: 'VY', value: '80 KIAS – MCP OEI 140% PI – Climb to 1000 ft' },
      { label: 'Gear', value: 'UP' },
      { label: 'NR Switch', value: '100%' },
    ],
  },
};

const LDG_PROFILES = {
  catb: {
    name: 'CAT B', color: '#6a8aaa', badge: '#1a3a5a',
    params: [
      { label: 'NR Switch', value: '100%' },
      { label: 'PARK BRK', value: 'A/R' },
      { label: 'Initial Point', value: '200 ft ALS' },
      { label: 'ROD', value: '< 500 fpm' },
      { label: 'LDP', value: '50 ft ALS – 30 KIAS' },
      { label: 'Land', value: 'TO HIGE – MAX 15° NOSE UP' },
      { label: 'Touchdown Speed', value: 'Running or HOV – MAX 30 KTS GS' },
    ],
    oei: null,
    balked: null,
  },
  clear: {
    name: 'CAT A – CLEAR AREA', color: '#c9a84c', badge: '#3a2800',
    params: [
      { label: 'NR Switch', value: '102%' },
      { label: 'PARK BRK', value: 'OFF' },
      { label: 'Initial Point', value: '200 ft AGL' },
      { label: 'ROD', value: '< 500 fpm' },
      { label: 'LDP', value: '50 ft AGL – 50 KIAS – ROD < 350 fpm' },
      { label: 'Land', value: 'TO HIGE – MAX 15° NOSE UP' },
      { label: 'Touchdown Speed', value: 'MAX 5 KTS GS' },
    ],
    prior: [
      { label: 'Collective', value: 'DROOP TO MIN 90% NR' },
      { label: 'Attitude', value: '5° NOSE UP' },
      { label: 'VBLSS', value: '50 KIAS' },
    ],
    oei: [
      { label: 'Positive ROC', value: 'NR to 102% – Climb 200 ft AGL – Accel to VY' },
      { label: 'VY', value: '80 KIAS – Climb to 1000 ft – MCP OEI 140% PI' },
      { label: 'Gear', value: 'UP' },
      { label: 'NR Switch', value: '100%' },
    ],
    balked: [
      { label: 'Attitude', value: '0°' },
      { label: 'Speed', value: '40 KIAS' },
      { label: 'Nose', value: '5° NOSE UP' },
      { label: 'NR', value: '102%' },
      { label: 'Altitude', value: '200 ft OR LDP +100 ALS' },
      { label: 'Accelerate', value: 'To Vy' },
      { label: 'Power', value: '140 PI – to 1000 ft' },
      { label: 'NR Switch', value: '100%' },
      { label: 'Gear', value: 'UP' },
    ],
  },
  heli: {
    name: 'CAT A – HELIPORT', color: '#c9a84c', badge: '#3a2800',
    params: [
      { label: 'NR Switch', value: '102%' },
      { label: 'PARK BRK', value: 'ON' },
      { label: 'Initial Point', value: '200 ft ALS' },
      { label: 'ROD', value: '< 500 fpm' },
      { label: 'LDP', value: '50 ft ALS – 20 KIAS – ROD < 350 fpm' },
      { label: 'Land', value: 'TO HIGE – MAX 5 KTS GS at TCHDN' },
      { label: 'Cushion', value: '20 ft ALS – MAX 15° NOSE UP' },
      { label: 'Touchdown Speed', value: 'MAX 5 KTS GS' },
    ],
    prior: [
      { label: 'Collective', value: 'DROOP TO MIN 90% NR' },
      { label: 'Attitude', value: '5° NOSE UP' },
      { label: 'VBLSS', value: '40 KIAS' },
    ],
    oei: [
      { label: 'Positive ROC', value: 'NR to 102% – Climb 200 ft – Accel to VY' },
      { label: 'VY', value: '80 KIAS – Climb to 1000 ft – MCP OEI 140% PI' },
      { label: 'Gear', value: 'UP' },
      { label: 'NR Switch', value: '100%' },
    ],
    balked: [
      { label: 'Attitude', value: '0°' },
      { label: 'Speed', value: '40 KIAS' },
      { label: 'Nose', value: '5° NOSE UP' },
      { label: 'NR', value: '102%' },
      { label: 'Altitude', value: '200 ft OR LDP +100 ALS' },
      { label: 'Accelerate', value: 'To Vy' },
      { label: 'Power', value: '140 PI – to 1000 ft' },
      { label: 'NR Switch', value: '100%' },
      { label: 'Gear', value: 'UP' },
    ],
  },
  heliv: {
    name: 'CAT A – HELIPORT VARIABLE LDP', color: '#c9a84c', badge: '#3a2800',
    params: [
      { label: 'NR Switch', value: '102%' },
      { label: 'PARK BRK', value: 'ON' },
      { label: 'Initial Point', value: '150 ft + LDPv' },
      { label: 'ROD', value: '< 500 fpm' },
      { label: 'LDP', value: '_400_ 50 ft – 20 KIAS – ROD < 350 fpm' },
      { label: 'Land', value: 'TO HIGE – MAX 5 KTS GS at TCHDN' },
      { label: 'Cushion', value: '20 ft ALS – MIN 90% NR – MAX 15° NOSE UP' },
      { label: 'Touchdown Speed', value: 'MAX 5 KTS GS' },
    ],
    prior: [
      { label: 'Collective', value: 'DROOP TO MIN 90% NR' },
      { label: 'Attitude', value: '5° NOSE UP' },
      { label: 'VBLSS', value: '40 KIAS' },
    ],
    oei: [
      { label: 'Positive ROC', value: 'NR to 102% – Climb LDPv + 150 ft ALS' },
      { label: '200 ft ALS (LDPv+150ft)', value: '2° Nose Up – Accelerate to VY' },
      { label: 'VY', value: '80 KIAS – Climb to 1000 ft – MCP OEI 140% PI' },
      { label: 'Gear', value: 'UP' },
      { label: 'NR Switch', value: '100%' },
    ],
    balked: [
      { label: 'Attitude', value: '0°' },
      { label: 'Speed', value: '40 KIAS' },
      { label: 'Nose', value: '5° NOSE UP' },
      { label: 'NR', value: '102%' },
      { label: 'Altitude', value: '200 ft OR LDP +100 ALS' },
      { label: 'Accelerate', value: 'To Vy' },
      { label: 'Power', value: '140 PI – to 1000 ft' },
      { label: 'NR Switch', value: '100%' },
      { label: 'Gear', value: 'UP' },
    ],
  },
  conf250: {
    name: 'CAT A – CONFINED LDP = 250 ft ALS', color: '#c9a84c', badge: '#3a2800',
    params: [
      { label: 'NR Switch', value: '102%' },
      { label: 'PARK BRK', value: 'ON' },
      { label: 'Initial Point', value: '350 ft ALS' },
      { label: 'ROD', value: '400 to 500 fpm' },
      { label: 'Speed', value: 'Decel 30 KTS GS' },
      { label: 'LDP', value: '_400_ 250 ft ALS – 15/20 KTS GS' },
      { label: 'Land', value: 'TO HIGE – MAX 5 KTS GS at TCHDN' },
      { label: 'Cushion', value: '20 ft ALS – MIN 90% NR – MAX 15° NOSE UP' },
      { label: 'Touchdown Speed', value: 'MAX 5 KTS GS' },
    ],
    prior: [
      { label: 'Collective', value: 'DROOP TO MIN 90% NR' },
      { label: 'Attitude', value: '0°' },
      { label: 'VBLSS', value: '40 KIAS' },
    ],
    oei: [
      { label: 'OEI – Continue Descent', value: '4/500 fpm – 100% NR ±1%' },
      { label: '15 ft ALS Cushion', value: '90% NR MIN – 15° NOSE UP – MAX 5 KTS GS' },
    ],
    balked: [
      { label: 'Nose', value: '5° NOSE UP – NR 102%' },
      { label: 'Altitude', value: '200 ft OR LDP +100 ALS' },
      { label: 'Accelerate to VY', value: 'Power 140 PI – to 1000 ft' },
      { label: 'NR Switch', value: '100%' },
      { label: 'Gear', value: 'UP' },
    ],
  },
  confabv: {
    name: 'CAT A – CONFINED LDP > 250 ft ALS', color: '#c9a84c', badge: '#3a2800',
    params: [
      { label: 'NR Switch', value: '102%' },
      { label: 'PARK BRK', value: 'ON' },
      { label: 'Initial Point', value: 'LDP + 100 ft ALS' },
      { label: 'ROD', value: '400 to 500 fpm' },
      { label: 'Speed', value: 'Decel 30 KTS GS' },
      { label: 'LDP', value: '_400_ 250 ft – 15/20 KTS GS' },
      { label: 'Land', value: 'TO HIGE – MAX 5 KTS GS at TCHDN' },
      { label: 'Cushion', value: '15 ft ALS – 90% NR MIN – 15° NOSE UP' },
      { label: 'Touchdown Speed', value: 'MAX 5 KTS GS' },
    ],
    prior: [
      { label: 'Collective', value: 'DROOP TO MIN 90% NR' },
      { label: 'Attitude', value: '0°' },
      { label: 'VBLSS', value: '40 KIAS' },
    ],
    oei: [
      { label: 'OEI – Continue Descent', value: '4/500 fpm – 100% NR ±1%' },
      { label: '15 ft ALS Cushion', value: '90% NR MIN – 15° NOSE UP – MAX 5 KTS GS' },
    ],
    balked: [
      { label: 'Nose', value: '5° NOSE UP – NR 102%' },
      { label: 'Altitude', value: '200 ft OR LDP +100 ALS' },
      { label: 'Accelerate to VY', value: 'Power 140 PI – to 1000 ft' },
      { label: 'NR Switch', value: '100%' },
      { label: 'Gear', value: 'UP' },
    ],
  },
};

// -- RENDER HELPERS -------------------------------------

function makeParamGrid(items) {
  if (!items || !items.length) return '<div class="prof-note">– No aplica para este perfil –</div>';
  return `<div class="param-grid">${items.map(p =>
    `<div class="param-item"><div class="param-label">${p.label}</div><div class="param-value ${p.cls||''}">${p.value}</div></div>`
  ).join('')}</div>`;
}

function makePhase(badgeText, badgeStyle, titleText, items) {
  return `<div class="phase-block">
    <div class="phase-header">
      <span class="phase-badge" style="background:${badgeStyle};color:#fff;">${badgeText}</span>
      <span class="phase-title">${titleText}</span>
    </div>
    <div class="phase-body">${makeParamGrid(items)}</div>
  </div>`;
}

function renderTO(key) {
  const p = TO_PROFILES[key];
  if (!p) return;
  // Mark card active
  document.querySelectorAll('#to-cards .prof-card').forEach(b => b.classList.remove('active'));
  document.getElementById('tocard-'+key).classList.add('active');

  const detail = document.getElementById('to-detail');
  detail.style.display = 'block';

  // Header
  let html = `<div style="display:flex;align-items:center;gap:12px;margin-bottom:6px;padding-top:4px;">
    <span style="font-family:'Bebas Neue',sans-serif;font-size:20px;letter-spacing:3px;color:${p.color};">${p.name}</span>
    <span style="font-family:'Share Tech Mono',monospace;font-size:9px;color:var(--dim);letter-spacing:1px;">PMC-39-A0126-CP001-00 – Issue 002</span>
  </div>
  <div style="font-family:'Share Tech Mono',monospace;font-size:9px;color:#3a5a70;letter-spacing:0.5px;margin-bottom:10px;">
    * ATS = Above Terrain Surface &nbsp;|&nbsp; ALS = Above Landing Surface &nbsp;|&nbsp; AGL = Above Ground Level &nbsp;|&nbsp; HIGE = Hover In Ground Effect
  </div>`;
  html += makePhase('T/O', '#1a3a60', 'TAKE-OFF PARAMETERS', p.params);

  // Contingency tabs
  const hasCTO = !!p.cto;
  html += `<div class="phase-block">
    <div class="phase-header" style="padding:0;">
      <div class="cont-tabs" style="width:100%;">
        <button class="cont-tab rto active" id="totab-rto-${key}" onclick="contTab('to','${key}','rto')">▶ RTO – REJECTED T/O</button>
        ${hasCTO ? `<button class="cont-tab cto" id="totab-cto-${key}" onclick="contTab('to','${key}','cto')">▶ CTO – CONTINUED T/O</button>` : ''}
      </div>
    </div>
    <div class="phase-body" style="padding-top:0;">
      <div class="cont-pane active" id="topane-rto-${key}">
        <div class="phase-divider">AT OR BEFORE TDP</div>
        ${makeParamGrid(p.rto)}
      </div>
      ${hasCTO ? `<div class="cont-pane" id="topane-cto-${key}">
        <div class="phase-divider">AT OR AFTER TDP</div>
        ${makeParamGrid(p.cto)}
      </div>` : ''}
    </div>
  </div>`;

  detail.innerHTML = html;
}

function renderLDG(key) {
  const p = LDG_PROFILES[key];
  if (!p) return;
  document.querySelectorAll('#ldg-cards .prof-card').forEach(b => b.classList.remove('active'));
  document.getElementById('ldgcard-'+key).classList.add('active');

  const detail = document.getElementById('ldg-detail');
  detail.style.display = 'block';

  let html = `<div style="display:flex;align-items:center;gap:12px;margin-bottom:6px;padding-top:4px;">
    <span style="font-family:'Bebas Neue',sans-serif;font-size:20px;letter-spacing:3px;color:${p.color};">${p.name}</span>
    <span style="font-family:'Share Tech Mono',monospace;font-size:9px;color:var(--dim);letter-spacing:1px;">PMC-39-A0126-CP001-00 – Issue 002</span>
  </div>
  <div style="font-family:'Share Tech Mono',monospace;font-size:9px;color:#3a5a70;letter-spacing:0.5px;margin-bottom:10px;">
    * ATS = Above Terrain Surface &nbsp;|&nbsp; ALS = Above Landing Surface &nbsp;|&nbsp; AGL = Above Ground Level &nbsp;|&nbsp; LDPv = LDP Variable
  </div>`;

  // Main approach params
  html += makePhase('LDG', '#1a3a60', 'LANDING PARAMETERS', p.params);

  // Prior to LDP
  if (p.prior) {
    html += makePhase('PRIOR LDP', '#1a2a40', 'PRIOR TO LDP', p.prior);
  }

  // Contingency tabs
  const hasOEI   = !!p.oei;
  const hasBalked = !!p.balked;
  if (hasOEI || hasBalked) {
    html += `<div class="phase-block">
      <div class="phase-header" style="padding:0;">
        <div class="cont-tabs" style="width:100%;">
          ${hasOEI    ? `<button class="cont-tab oei active" id="ldgtab-oei-${key}"    onclick="contTab('ldg','${key}','oei')">▶ OEI – ONE ENG INOP</button>` : ''}
          ${hasBalked ? `<button class="cont-tab blk ${hasOEI?'':'active'}" id="ldgtab-blk-${key}" onclick="contTab('ldg','${key}','blk')">▶ BALKED LANDING</button>` : ''}
        </div>
      </div>
      <div class="phase-body" style="padding-top:0;">
        ${hasOEI ? `<div class="cont-pane active" id="ldgpane-oei-${key}">
          <div class="phase-divider">AT OR AFTER LDP – OEI</div>
          ${makeParamGrid(p.oei)}
        </div>` : ''}
        ${hasBalked ? `<div class="cont-pane ${hasOEI?'':'active'}" id="ldgpane-blk-${key}">
          <div class="phase-divider">BALKED LANDING</div>
          ${makeParamGrid(p.balked)}
        </div>` : ''}
      </div>
    </div>`;
  }

  detail.innerHTML = html;
}

function contTab(mode, key, sub) {
  // Deactivate all tabs and panes for this key/mode
  const prefix = mode === 'to' ? `totab-` : `ldgtab-`;
  const panePrefix = mode === 'to' ? `topane-` : `ldgpane-`;

  document.querySelectorAll(`[id^="${prefix}"][id$="-${key}"]`).forEach(t => t.classList.remove('active'));
  document.querySelectorAll(`[id^="${panePrefix}"][id$="-${key}"]`).forEach(p => p.classList.remove('active'));

  const tabEl  = document.getElementById(`${prefix}${sub}-${key}`);
  const paneEl = document.getElementById(`${panePrefix}${sub}-${key}`);
  if (tabEl)  tabEl.classList.add('active');
  if (paneEl) paneEl.classList.add('active');
}

function profTab(tab) {
  document.getElementById('prof-to').style.display  = tab === 'to'  ? 'block' : 'none';
  document.getElementById('prof-ldg').style.display = tab === 'ldg' ? 'block' : 'none';
  document.getElementById('ptab-to').classList.toggle('active',  tab === 'to');
  document.getElementById('ptab-ldg').classList.toggle('active', tab === 'ldg');
}

function selectTO(key)  { renderTO(key);  }
function selectLDG(key) { renderLDG(key); }

// --- SPLASH SCREEN DISMISS ---
window.addEventListener('load', () => {
  setTimeout(() => {
    const splash = document.getElementById('splash');
    if (splash) {
      splash.classList.add('hidden');
      setTimeout(() => splash.remove(), 700);
    }
  }, 1600); // show for 1.6s then fade
});

// --- OFFLINE FONT FALLBACK ---
// If Google Fonts fails (offline), inject local-equivalent stack
(function() {
  const testEl = document.createElement('span');
  testEl.style.cssText = 'font-family:"Bebas Neue";font-size:72px;visibility:hidden;position:absolute';
  testEl.textContent = 'W';
  document.body.appendChild(testEl);
  const bebasW = testEl.offsetWidth;
  testEl.style.fontFamily = 'Arial';
  const arialW = testEl.offsetWidth;
  document.body.removeChild(testEl);
  if (bebasW === arialW) {
    // Bebas Neue not loaded – inject CSS fallback
    const style = document.createElement('style');
    style.textContent = `
      .section-title, .cl-section-header, .phase-badge,
      .splash-title, .prof-card, .nav-btn {
        font-family: 'Arial Narrow', 'Impact', 'Arial', sans-serif !important;
        letter-spacing: 2px !important;
      }
      .cl-table td, .param-value, .param-label {
        font-family: 'Courier New', 'Courier', monospace !important;
      }
    `;
    document.head.appendChild(style);
    console.log('AW139 Checklist: offline mode – using system fonts');
  }
})();

// -------------------------------------------------------
// SISTEMA DE MODOS: DÍA / NOCHE / NVG
// NVG: paleta MIL-STD-3009 Clase A – R=0 en todos
//      los colores base, rango 450-580nm seguro para
//      intensificadores Gen III GaAs (600-930nm).
// -------------------------------------------------------

const MODES = { NIGHT: 'night', DAY: 'day', NVG: 'nvg' };

function applyMode(mode) {
  const root  = document.documentElement;
  const icon  = document.getElementById('mode-icon');
  const label = document.getElementById('mode-label');
  const nvgBtn = document.getElementById('nvg-toggle');

  // Limpiar atributos anteriores
  root.removeAttribute('data-mode');
  nvgBtn && nvgBtn.classList.remove('nvg-on');

  if (mode === MODES.DAY) {
    root.setAttribute('data-mode', 'day');
    if (icon)  icon.innerHTML   = `<svg class="m-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"> <circle cx="12" cy="12" r="4" stroke="currentColor" stroke-width="1.5"/> <line x1="12" y1="2" x2="12" y2="4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/> <line x1="12" y1="20" x2="12" y2="22" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/> <line x1="2" y1="12" x2="4" y2="12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/> <line x1="20" y1="12" x2="22" y2="12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/> <line x1="4.93" y1="4.93" x2="6.34" y2="6.34" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/> <line x1="17.66" y1="17.66" x2="19.07" y2="19.07" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/> <line x1="4.93" y1="19.07" x2="6.34" y2="17.66" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/> <line x1="17.66" y1="6.34" x2="19.07" y2="4.93" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>        </svg>`;
    if (label) label.textContent = 'DÍA';
  } else if (mode === MODES.NVG) {
    root.setAttribute('data-mode', 'nvg');
    if (icon)  icon.innerHTML   = `<svg class="m-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> <line x1="17" y1="4" x2="17" y2="4.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/> <line x1="20" y1="7" x2="20.5" y2="7" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/> <line x1="19" y1="3" x2="19.5" y2="2.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>        </svg>`;
    if (label) label.textContent = 'NOCHE';
    nvgBtn && nvgBtn.classList.add('nvg-on');
  } else {
    // NIGHT (default)
    if (icon)  icon.innerHTML   = `<svg class="m-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> <line x1="17" y1="4" x2="17" y2="4.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/> <line x1="20" y1="7" x2="20.5" y2="7" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/> <line x1="19" y1="3" x2="19.5" y2="2.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>        </svg>`;
    if (label) label.textContent = 'NOCHE';
  }

  localStorage.setItem('aw139-mode', mode);
}

function toggleMode() {
  const current = localStorage.getItem('aw139-mode') || MODES.NIGHT;
  // Ciclo: NOCHE ? DÍA ? NOCHE (NVG es toggle independiente)
  if (current === MODES.NVG) {
    applyMode(MODES.NIGHT);   // salir de NVG también con este botón
  } else if (current === MODES.DAY) {
    applyMode(MODES.NIGHT);
  } else {
    applyMode(MODES.DAY);
  }
}

function toggleNVG() {
  const current = localStorage.getItem('aw139-mode') || MODES.NIGHT;
  if (current === MODES.NVG) {
    applyMode(MODES.NIGHT);   // desactivar NVG ? volver a noche
  } else {
    applyMode(MODES.NVG);     // activar NVG desde cualquier modo
  }
}

// Restaurar modo guardado al cargar
(function initMode() {
  const saved = localStorage.getItem('aw139-mode') || MODES.NIGHT;
  applyMode(saved);
})();

// Init progress
Object.keys(labels).forEach(id => updateProgress(id));

// Update banner control
const updateBanner = document.getElementById('update-banner');
const updateBtn = document.getElementById('update-btn');
let pendingSW = null;

function showUpdateBanner() {
  if (updateBanner) updateBanner.classList.add('show');
}

if (updateBtn) {
  updateBtn.addEventListener('click', () => {
    if (pendingSW) {
      pendingSW.postMessage({ type: 'SKIP_WAITING' });
    }
  });
}

// --- SERVICE WORKER REGISTRATION ---
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('./sw.js')
      .then(reg => {
        if (reg.waiting) {
          pendingSW = reg.waiting;
          showUpdateBanner();
        }

        reg.addEventListener('updatefound', () => {
          const newSW = reg.installing;
          if (!newSW) return;
          newSW.addEventListener('statechange', () => {
            if (newSW.state === 'installed' && navigator.serviceWorker.controller) {
              pendingSW = newSW;
              showUpdateBanner();
            }
          });
        });
      })
      .catch(err => console.warn('AW139 SW registration failed:', err));

    let refreshing = false;
    navigator.serviceWorker.addEventListener('controllerchange', () => {
      if (refreshing) return;
      refreshing = true;
      window.location.reload();
    });
  });
}
</script>
</body>
</html>







