<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>AW139 ÁGUILA 1 – Checklist</title>

<!-- --- PWA MANIFEST --- -->
<link rel="manifest" href="/aw139_CheckList/manifest.json">

<!-- --- PWA / iOS HOME SCREEN --- -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="ÁGUILA-1 AW139">
<meta name="mobile-web-app-capable" content="yes">
<meta name="theme-color" content="#0a0d14">

<!-- App icons + favicon -->
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" href="favicon.ico">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="192x192" href="icon-192.png">
<link rel="icon" type="image/png" sizes="512x512" href="icon-512.png">



<style>
  /* --- SPLASH SCREEN --- */
  #splash {
    position: fixed; inset: 0; z-index: 9999;
    background: #0a0d14;
    display: flex; flex-direction: column;
    align-items: center; justify-content: center; gap: 20px;
    transition: opacity 0.6s ease;
  }
  #splash.hidden { opacity: 0; pointer-events: none; }
  .splash-helo {
    width: 120px; height: 120px;
    object-fit: contain;
    filter: drop-shadow(0 0 12px rgba(201,168,76,0.35));
  }
  .splash-title {
    font-family: 'Bebas Neue', 'Arial Narrow', sans-serif;
    font-size: 36px; letter-spacing: 6px; color: #c9a84c;
    text-align: center;
  }
  .splash-sub {
    font-family: 'Courier New', monospace;
    font-size: 11px; letter-spacing: 3px;
    color: #3a5070; text-align: center; line-height: 1.8;
  }
  .splash-bar-wrap {
    width: 160px; height: 3px; background: #1a2535; border-radius: 2px; overflow: hidden;
  }
  .splash-bar {
    height: 100%; width: 0%; background: linear-gradient(90deg, #c9a84c, #ffdd80);
    border-radius: 2px; animation: splashload 1.4s ease forwards;
  }
  @keyframes splashload { to { width: 100%; } }

  /* --- iOS SAFE AREA --- */
  body { padding-top: env(safe-area-inset-top); }
  #sidebar { padding-bottom: env(safe-area-inset-bottom); }
</style>

<style>
  @import url('https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Share+Tech+Mono&family=Barlow+Condensed:wght@400;600;700&display=swap');

  /* --- PALETA NOCTURNA (defecto) --- */
  :root {
    --bg: #1a1f2e;
    --panel: #1e2538;
    --border: #2e3a50;
    --gold: #e8c060;
    --red: #dd2222;
    --amber: #f09800;
    --green: #2a8a3b;
    --text: #eef2ff;
    --dim: #8a96b0;
    --header-bg: #111828;
    --row-alt: #1e2638;
    --row-hover: #252e42;
    --accent: #4a6abf;
    --white: #ffffff;
    --title: #c8dd40;
    --update-bg: #0f1522;
    --update-text: #d8dde8;
    --update-border: #24304a;
    --update-btn-text: #0a0d14;
    --prof-tabs-bg: #070e18;
    --prof-tabs-border: #1a2a3a;
    --prof-meta: #4a6080;
    --prof-meta-muted: #3a5a70;
    --prof-help-bg: #0d1a06;
    --prof-help-border: #4a6a1a;
    --prof-help-accent: #7a9a2a;
    --prof-help-text: #8ab840;
    --prof-help-strong: #b8d44a;
    --prof-tab-hover-bg: #0d1520;
    --prof-tab-active-bg: #0d1a06;
    --prof-tab-active-text: #b8d44a;
    --prof-tab-active-border: #7a9a2a;
    --prof-card-bg: #0d1520;
    --prof-card-hover-bg: #111a06;
    --prof-card-hover-border: #7a9a2a;
    --prof-card-active-bg: #7a9a2a;
    --prof-card-active-border: #9ac030;
    --prof-card-active-text: #ffffff;
    --prof-card-active-subtext: #d4f08a;
    --prof-card-cat-a-border: #2a4a6a;
    --prof-card-cat-a-hover-border: #4a8aaa;
    --prof-title-catb: #6a8aaa;
    --prof-title-cata: #c9a84c;
    --phase-badge: #1a3a60;
    --phase-badge-alt: #1a2a40;
    --phase-badge-text: #ffffff;
    --phase-bg: #0a1220;
    --phase-border: #1a2a3a;
    --phase-header-bg: #0d1828;
    --phase-header-border: #1a2a3a;
    --param-item-bg: #060e18;
    --param-item-border: #1a2535;
    --param-value: #c9a84c;
    --param-value-green: #4adf70;
    --param-value-red: #ff6b6b;
    --param-value-blue: #7ab0ff;
    --param-value-white: #eef2ff;
    --cont-tab-hover-bg: #0d1828;
    --cont-tab-rto-bg: #1a0e00;
    --cont-tab-rto-text: #ffb940;
    --cont-tab-rto-border: #e88f00;
    --cont-tab-cto-bg: #041208;
    --cont-tab-cto-text: #4adf70;
    --cont-tab-cto-border: #2a7a3b;
    --cont-tab-oei-bg: #180800;
    --cont-tab-oei-text: #ff9a4a;
    --cont-tab-oei-border: #c05020;
    --cont-tab-blk-bg: #060e20;
    --cont-tab-blk-text: #7ab0ff;
    --cont-tab-blk-border: #3a6abf;
    --prof-note-bg: #08121e;
    --prof-note-border: #2a4a6a;
    --prof-note-text: #5a7a9a;
    --phase-divider-text: #2a4a5a;
    --phase-divider-line: #1a2a3a;
    --pac-header-border: #1a9a8a;
    --pac-panel-bg: #0c1520;
    --pac-panel-border: #1a2535;
    --pac-field-bg: #1a2236;
    --pac-field-text: #eef2ff;
    --pac-field-border: #2e3a50;
    --pac-label: #8a96b0;
    --pac-btn-primary-bg: #1a9a8a;
    --pac-btn-primary-text: #ffffff;
    --pac-btn-secondary-border: #2e3a50;
    --pac-btn-secondary-text: #8a96b0;
    --pac-btn-tertiary-border: #253050;
    --pac-btn-tertiary-text: #4a6a9c;
    --pac-canvas-bg: #060d18;
    --pac-chart-text: #4a6070;
    --pac-chart-subtext: #3a4a5a;
    --pac-log-bg: #0a1020;
    --pac-log-header-bg: #111828;
    --pac-ok: #2adf60;
    --pac-bad: #ff4444;
    --pac-limit: #c9a84c;
    --pac-eng1: #c9a84c;
    --pac-eng2: #7ab0ff;
    --pac-chart-bg: #050e1a;
    --pac-chart-grid-major: #1a2a40;
    --pac-chart-grid-minor: #111e30;
    --pac-chart-sep: #253555;
    --pac-chart-axis-text: #4a6080;
    --pac-chart-axis-label: #3a5070;
    --pac-chart-header: #6a8aaa;
    --pac-chart-curve: #1e5aa0;
    --pac-chart-curve-label: #3a608a;
    --pac-chart-limit: #cc2222;
    --pac-banner-ok-bg: #051508;
    --pac-banner-ok-border: #2adf60;
    --pac-banner-ok-text: #2adf60;
    --pac-banner-bad-bg: #150303;
    --pac-banner-bad-border: #ff4444;
    --pac-banner-bad-text: #ff8888;
    --abort-caution-bg: #1a0800;
    --abort-caution-border: #e88f00;
    --abort-caution-title: #ffb940;
    --abort-caution-text: #d4a060;
    --abort-context-bg: #0d1520;
    --abort-context-border: #c9a84c;
    --abort-context-text: #7a9aaa;
    --abort-context-accent: #c9a84c;
    --abort-list-bg: #080f1a;
    --abort-list-border: #1a2a3a;
    --abort-list-row-bg: #0d1828;
    --abort-list-text: #ff9a4a;
    --abort-list-accent: #ffb940;
    --abort-list-bullet: #ff4444;
    --abort-ff-text: #c65a41;
    --abort-ff-accent: #ff9a4a;
  }

  /* --- PALETA DIURNA --- */
  :root[data-mode="day"] {
    --bg: #d8dce8;
    --panel: #e4e8f0;
    --border: #a0aabf;
    --gold: #7a5a00;
    --red: #b81010;
    --amber: #b06000;
    --green: #1a6828;
    --text: #0a0e1a;
    --dim: #3a4460;
    --header-bg: #bcc4d8;
    --row-alt: #b1b8ca;
    --row-hover: #a8b2c8;
    --accent: #1a40a0;
    --white: #0a0e1a;
    --title: #1a4a00;
    --update-bg: #eef1f7;
    --update-text: #1a2336;
    --update-border: #7d8fb3;
    --update-btn-text: #0a0d14;
    --prof-tabs-bg: #c9d2e4;
    --prof-tabs-border: #8ea0c4;
    --prof-meta: #3a4a68;
    --prof-meta-muted: #4a5875;
    --prof-help-bg: #dfe8c4;
    --prof-help-border: #8aa64a;
    --prof-help-accent: #7a9a2a;
    --prof-help-text: #3a5a10;
    --prof-help-strong: #2f5c00;
    --prof-tab-hover-bg: #d5deef;
    --prof-tab-active-bg: #dfe8c4;
    --prof-tab-active-text: #2a4a00;
    --prof-tab-active-border: #7a9a2a;
    --prof-card-bg: #e6eaf5;
    --prof-card-hover-bg: #dde4f2;
    --prof-card-hover-border: #7a9a2a;
    --prof-card-active-bg: #7a9a2a;
    --prof-card-active-border: #6f8d24;
    --prof-card-active-text: #ffffff;
    --prof-card-active-subtext: #e8f5b6;
    --prof-card-cat-a-border: #5a7aa0;
    --prof-card-cat-a-hover-border: #4a6a9c;
    --prof-title-catb: #1a40a0;
    --prof-title-cata: #7a5a00;
    --phase-badge: #2a4a7a;
    --phase-badge-alt: #233a60;
    --phase-badge-text: #ffffff;
    --phase-bg: #eef2fb;
    --phase-border: #a8b7d2;
    --phase-header-bg: #e1e8f6;
    --phase-header-border: #a8b7d2;
    --param-item-bg: #f4f6fb;
    --param-item-border: #b4c0d8;
    --param-value: #7a5a00;
    --param-value-green: #1a6828;
    --param-value-red: #b81010;
    --param-value-blue: #1a40a0;
    --param-value-white: #0a0e1a;
    --cont-tab-hover-bg: #dbe3f2;
    --cont-tab-rto-bg: #f7e0b0;
    --cont-tab-rto-text: #7a4a00;
    --cont-tab-rto-border: #c27a00;
    --cont-tab-cto-bg: #d8f0d6;
    --cont-tab-cto-text: #1a6828;
    --cont-tab-cto-border: #2a8a3b;
    --cont-tab-oei-bg: #f8d0b0;
    --cont-tab-oei-text: #8a3a10;
    --cont-tab-oei-border: #c05020;
    --cont-tab-blk-bg: #d2dff8;
    --cont-tab-blk-text: #1a40a0;
    --cont-tab-blk-border: #3a6abf;
    --prof-note-bg: #e5ecf7;
    --prof-note-border: #7a90b0;
    --prof-note-text: #3a4e6a;
    --phase-divider-text: #51607a;
    --phase-divider-line: #a8b7d2;
    --pac-header-border: #1a7a6a;
    --pac-panel-bg: #e6edf7;
    --pac-panel-border: #a8b7d2;
    --pac-field-bg: #f5f7fb;
    --pac-field-text: #0a0e1a;
    --pac-field-border: #a0aabf;
    --pac-label: #3a4460;
    --pac-btn-primary-bg: #1a7a6a;
    --pac-btn-primary-text: #ffffff;
    --pac-btn-secondary-border: #8ea0c4;
    --pac-btn-secondary-text: #2a3858;
    --pac-btn-tertiary-border: #8ea0c4;
    --pac-btn-tertiary-text: #1a40a0;
    --pac-canvas-bg: #eef2fb;
    --pac-chart-text: #3a4e6a;
    --pac-chart-subtext: #55657d;
    --pac-log-bg: #e9edf6;
    --pac-log-header-bg: #d4dbea;
    --pac-ok: #1a6828;
    --pac-bad: #b81010;
    --pac-limit: #7a5a00;
    --pac-eng1: #7a5a00;
    --pac-eng2: #1a40a0;
    --pac-chart-bg: #eef2fb;
    --pac-chart-grid-major: #9fb0cc;
    --pac-chart-grid-minor: #c0cbe0;
    --pac-chart-sep: #7a90b0;
    --pac-chart-axis-text: #3a4e6a;
    --pac-chart-axis-label: #4a5875;
    --pac-chart-header: #1a40a0;
    --pac-chart-curve: #2a5fa0;
    --pac-chart-curve-label: #2a4f85;
    --pac-chart-limit: #b81010;
    --pac-banner-ok-bg: #e3f3e0;
    --pac-banner-ok-border: #1a6828;
    --pac-banner-ok-text: #1a6828;
    --pac-banner-bad-bg: #f7d7d7;
    --pac-banner-bad-border: #b81010;
    --pac-banner-bad-text: #7a2020;
    --abort-caution-bg: #fbe2c2;
    --abort-caution-border: #d28a2a;
    --abort-caution-title: #7a4a00;
    --abort-caution-text: #6a4a20;
    --abort-context-bg: #e6edf7;
    --abort-context-border: #7a5a00;
    --abort-context-text: #3a4e6a;
    --abort-context-accent: #7a5a00;
    --abort-list-bg: #eef2fb;
    --abort-list-border: #a8b7d2;
    --abort-list-row-bg: #e1e8f6;
    --abort-list-text: #7a4a00;
    --abort-list-accent: #b06000;
    --abort-list-bullet: #b81010;
    --abort-ff-text: #7a3a20;
    --abort-ff-accent: #b06000;
  }

  /* Ajustes día para colores hardcoded */
  :root[data-mode="day"] .nav-btn.blue.active  { background: #b0c0e0 !important; color: #0a2060 !important; }
  :root[data-mode="day"] .nav-btn.teal.active  { background: #a0d4cc !important; color: #004438 !important; }
  :root[data-mode="day"] .nav-btn.olive.active { background: #c0d880 !important; color: #1a3800 !important; }
  :root[data-mode="day"] .nav-btn.amber.active { background: #f0c860 !important; color: #3a1800 !important; }
  :root[data-mode="day"] .nav-btn.red.active   { background: #f0a0a0 !important; color: #3a0000 !important; }
  :root[data-mode="day"] .row-repeat           { background: linear-gradient(90deg,#f8e090,#ffe8a0,#f8e090) !important; }
  :root[data-mode="day"] .row-repeat td        { color: #92540e !important; }
  :root[data-mode="day"] .banner.note          { background: #c8d8f0 !important; color: #1a3080 !important; border-color: #6090d0 !important; }
  :root[data-mode="day"] .row-note td          { color: #3a4460 !important; background: #ccd4e4 !important; }
  :root[data-mode="day"] .info-block           { background: #c8d4ec !important; border-color: #3a60b0 !important; }
  :root[data-mode="day"] .cl-table tr:nth-child(odd) { background: #dfe4f1; }
  :root[data-mode="day"] .info-link            { color: #1a3d00 !important; }
  /* -------------------------------------------------------
     PALETA NVG – MIL-STD-3009 Clase A compatible
     Principio: Canal R=0 en todos los colores base.
     Rango espectral seguro: 450–580 nm (azul-verde).
     Los intensificadores Gen III (GaAs) son sensibles
     600–930 nm – fuera de este rango = NVG-safe.
     Luminancia mínima para preservar adaptación escotópica.
  -------------------------------------------------------- */
  :root[data-mode="nvg"] {
    /* Fondos – negro puro + azul profundo ~460nm, R=0 */
    --bg:        #000000;   /* Cero emisión total */
    --panel:     #000810;   /* Azul muy oscuro, R=0 */
    --border:    #002818;   /* Verde oscuro ~535nm, R=0 */
    --header-bg: #000510;   /* Azul-negro, R=0 */
    --row-alt:   #000C10;   /* Fondo alterno sutil, R=0 */
    --row-hover: #001A14;   /* Hover verde-negro, R=0 */

    /* Texto – verde NVIS Green A (~530nm), R=0 */
    --text:   #00AA44;      /* Texto principal – pico bastones ~507nm */
    --dim:    #005522;      /* Texto secundario – luminancia reducida */
    --white:  #55AA77;      /* NVIS White equiv. – azul-verde, R=0 */
    --title:  #00CC44;      /* TÍtulos – verde brillante, R=0 */

    /* Colores funcionales – todos R=0 */
    --gold:   #00AA00;      /* Reemplaza dorado ? verde NVIS */
    --green:  #008833;      /* Verde confirmación */
    --accent: #0055AA;      /* Azul ~470nm – fuera banda NVG completamente */
    --amber:  #00BB00;      /* Reemplaza ámbar ? verde intenso */

    /* WARNING: verde intenso + pulso. Rojo PROHIBIDO con NVG */
    --red:    #00CC22;      /* Reemplaza rojo ? verde brillante pulsante */
    --update-bg: #000810;
    --update-text: #00AA44;
    --update-border: #003388;
    --update-btn-text: #001200;
    --prof-tabs-bg: #000810;
    --prof-tabs-border: #003388;
    --prof-meta: #0077CC;
    --prof-meta-muted: #0060aa;
    --prof-help-bg: #001200;
    --prof-help-border: #00AA22;
    --prof-help-accent: #00AA22;
    --prof-help-text: #00AA44;
    --prof-help-strong: #00DD22;
    --prof-tab-hover-bg: #000C18;
    --prof-tab-active-bg: #001800;
    --prof-tab-active-text: #00CC22;
    --prof-tab-active-border: #00AA22;
    --prof-card-bg: #000810;
    --prof-card-hover-bg: #001200;
    --prof-card-hover-border: #00AA22;
    --prof-card-active-bg: #002200;
    --prof-card-active-border: #00CC22;
    --prof-card-active-text: #00EE33;
    --prof-card-active-subtext: #00AA44;
    --prof-card-cat-a-border: #003388;
    --prof-card-cat-a-hover-border: #0055AA;
    --prof-title-catb: #0077CC;
    --prof-title-cata: #00CC44;
    --phase-badge: #003388;
    --phase-badge-alt: #002244;
    --phase-badge-text: #00CC22;
    --phase-bg: #000810;
    --phase-border: #003388;
    --phase-header-bg: #000C18;
    --phase-header-border: #003388;
    --param-item-bg: #000510;
    --param-item-border: #003388;
    --param-value: #00AA44;
    --param-value-green: #00CC44;
    --param-value-red: #00CC22;
    --param-value-blue: #0055AA;
    --param-value-white: #55AA77;
    --cont-tab-hover-bg: #000C18;
    --cont-tab-rto-bg: #001800;
    --cont-tab-rto-text: #00CC22;
    --cont-tab-rto-border: #00AA22;
    --cont-tab-cto-bg: #001400;
    --cont-tab-cto-text: #00BB33;
    --cont-tab-cto-border: #008833;
    --cont-tab-oei-bg: #001400;
    --cont-tab-oei-text: #00CC22;
    --cont-tab-oei-border: #00AA22;
    --cont-tab-blk-bg: #000C18;
    --cont-tab-blk-text: #0077CC;
    --cont-tab-blk-border: #003388;
    --prof-note-bg: #000810;
    --prof-note-border: #003388;
    --prof-note-text: #005599;
    --phase-divider-text: #005599;
    --phase-divider-line: #003388;
    --pac-header-border: #00AA44;
    --pac-panel-bg: #000810;
    --pac-panel-border: #003388;
    --pac-field-bg: #000510;
    --pac-field-text: #00AA44;
    --pac-field-border: #003388;
    --pac-label: #005522;
    --pac-btn-primary-bg: #008833;
    --pac-btn-primary-text: #001200;
    --pac-btn-secondary-border: #003388;
    --pac-btn-secondary-text: #005522;
    --pac-btn-tertiary-border: #003388;
    --pac-btn-tertiary-text: #0077CC;
    --pac-canvas-bg: #000810;
    --pac-chart-text: #005599;
    --pac-chart-subtext: #004466;
    --pac-log-bg: #000810;
    --pac-log-header-bg: #000510;
    --pac-ok: #00CC44;
    --pac-bad: #00CC22;
    --pac-limit: #00AA44;
    --pac-eng1: #00AA44;
    --pac-eng2: #0077CC;
    --pac-chart-bg: #000810;
    --pac-chart-grid-major: #003388;
    --pac-chart-grid-minor: #002244;
    --pac-chart-sep: #003388;
    --pac-chart-axis-text: #005599;
    --pac-chart-axis-label: #004466;
    --pac-chart-header: #0077CC;
    --pac-chart-curve: #0055AA;
    --pac-chart-curve-label: #0077CC;
    --pac-chart-limit: #00CC22;
    --pac-banner-ok-bg: #001200;
    --pac-banner-ok-border: #00CC44;
    --pac-banner-ok-text: #00CC44;
    --pac-banner-bad-bg: #001800;
    --pac-banner-bad-border: #00CC22;
    --pac-banner-bad-text: #00CC22;
    --abort-caution-bg: #001800;
    --abort-caution-border: #00AA22;
    --abort-caution-title: #00CC22;
    --abort-caution-text: #00AA44;
    --abort-context-bg: #000810;
    --abort-context-border: #00AA22;
    --abort-context-text: #005599;
    --abort-context-accent: #00AA44;
    --abort-list-bg: #000810;
    --abort-list-border: #003388;
    --abort-list-row-bg: #000C18;
    --abort-list-text: #00CC22;
    --abort-list-accent: #00AA44;
    --abort-list-bullet: #00CC22;
    --abort-ff-text: #00AA44;
    --abort-ff-accent: #00CC22;
  }

  /* Overrides hardcoded para NVG – R=0 absoluto */
  :root[data-mode="nvg"] .nav-btn.blue.active  { background: #001830 !important; color: #0077CC !important; }
  :root[data-mode="nvg"] .nav-btn.teal.active  { background: #001A14 !important; color: #00AA77 !important; }
  :root[data-mode="nvg"] .nav-btn.olive.active { background: #001400 !important; color: #00BB33 !important; }
  :root[data-mode="nvg"] .nav-btn.amber.active { background: #001800 !important; color: #00DD22 !important; }
  :root[data-mode="nvg"] .nav-btn.red.active   { background: #001800 !important; color: #00EE33 !important; border-left-color: #00CC22 !important; }
  :root[data-mode="nvg"] .nav-btn.red          { border-left-color: #00AA22 !important; }
  :root[data-mode="nvg"] .nav-btn              { color: #005522; }
  :root[data-mode="nvg"] .nav-btn:hover        { color: #00AA44; }

  /* Filas especiales NVG */
  :root[data-mode="nvg"] .row-repeat {
    background: linear-gradient(90deg, #001800, #002200, #001800) !important;
    border-top: 1px solid #00AA00 !important;
    border-bottom: 1px solid #00AA00 !important;
  }
  :root[data-mode="nvg"] .row-repeat td        { color: #00DD22 !important; }
  :root[data-mode="nvg"] .banner.red           { background: #001800 !important; color: #00EE33 !important; animation: nvgPulse 1.2s ease-in-out infinite; }
  :root[data-mode="nvg"] .banner.amber         { background: #001400 !important; color: #00CC22 !important; animation: nvgPulse 2s ease-in-out infinite; }
  :root[data-mode="nvg"] .banner.note          { background: #000C18 !important; color: #0077CC !important; border-color: #003388 !important; }
  :root[data-mode="nvg"] .row-note td          { color: #005522 !important; background: #000810 !important; }
  :root[data-mode="nvg"] .info-block           { background: #000810 !important; border-color: #003388 !important; color: #005599 !important; }
  :root[data-mode="nvg"] .info-link            { color: #0077CC !important; }
  :root[data-mode="nvg"] .cl-table tr.checked .item-name { color: #003318 !important; }
  :root[data-mode="nvg"] .cl-table tr.checked .check-box { background: #005522 !important; border-color: #008833 !important; }
  :root[data-mode="nvg"] .ff-row               { border-left-color: #00AA22 !important; background: #001200 !important; }
  :root[data-mode="nvg"] .cl-table tr.ff-row td.item-name { color: #00CC44 !important; }
  :root[data-mode="nvg"] .first-flight-badge   {
    background: linear-gradient(90deg, #001800, #003300, #001800) !important;
    border-color: #00AA22 !important;
    color: #00EE33 !important;
  }
  :root[data-mode="nvg"] #topbar               { border-bottom-color: #00AA44 !important; }
  :root[data-mode="nvg"] .cl-section-header    { border-bottom-color: #008833 !important; }
  :root[data-mode="nvg"] .sidebar-logo .aircraft { color: #00AA44 !important; }
  :root[data-mode="nvg"] .sidebar-logo .aircraft span { color: #00CC22 !important; }
  :root[data-mode="nvg"] .progress-fill        { background: linear-gradient(90deg, #008833, #00CC44) !important; }

  /* Animación pulso NVG para warnings */
  @keyframes nvgPulse {
    0%, 100% { opacity: 1; box-shadow: 0 0 0px #00CC22; }
    50%       { opacity: 0.6; box-shadow: 0 0 8px #00AA0066; }
  }

  /* Topbar NVG badge */
  :root[data-mode="nvg"] #topbar .meta         { color: #005522 !important; }
  :root[data-mode="nvg"] #topbar .section-title { color: #00AA44 !important; }
  :root[data-mode="nvg"] .check-box            { border-color: #003318 !important; }
  :root[data-mode="nvg"] .reset-btn            { color: #005522 !important; border-color: #003318 !important; }
  :root[data-mode="nvg"] .reset-btn:hover      { background: #001800 !important; color: #00CC22 !important; border-color: #00AA22 !important; }
  :root[data-mode="nvg"] .check-all-btn        { color: #005522 !important; border-color: #003318 !important; }
  :root[data-mode="nvg"] .check-all-btn:hover  { background: #001800 !important; color: #00CC22 !important; border-color: #00AA22 !important; }
  :root[data-mode="nvg"] .progress-label       { color: #005522 !important; }

  /* Indicador NVG en el topbar */
  .nvg-badge {
    display: none;
    font-family: 'Share Tech Mono', monospace;
    font-size: 9px;
    letter-spacing: 2px;
    color: #00AA44;
    border: 1px solid #008833;
    padding: 2px 8px;
    border-radius: 2px;
    animation: nvgPulse 3s ease-in-out infinite;
  }
  :root[data-mode="nvg"] .nvg-badge { display: inline-block; }



  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'Barlow Condensed', sans-serif;
    font-size: 18px;
    display: flex;
    height: 100vh;
    overflow: hidden;
  }

  .update-banner {
    position: fixed;
    left: 50%;
    bottom: calc(env(safe-area-inset-bottom) + 16px);
    transform: translateX(-50%);
    display: none;
    align-items: center;
    gap: 10px;
    padding: 8px 12px;
    background: var(--update-bg);
    color: var(--update-text);
    border: 1px solid var(--update-border);
    border-radius: 10px;
    box-shadow: 0 10px 24px rgba(0,0,0,0.35);
    z-index: 10000;
    font-size: 12px;
    letter-spacing: 0.4px;
  }
  .update-banner.show { display: inline-flex; }
  .update-banner button {
    background: var(--gold);
    color: var(--update-btn-text);
    border: none;
    padding: 6px 10px;
    border-radius: 8px;
    font-weight: 700;
    cursor: pointer;
  }
  .update-banner button:hover { filter: brightness(1.05); }
  .update-banner button:active { transform: translateY(1px); }
  @media (max-width: 520px) {
    .update-banner { width: calc(100% - 24px); justify-content: space-between; }
  }

  /* -- SIDEBAR -- */
  #sidebar {
    width: 138px;
    min-width: 138px;
    background: var(--header-bg);
    border-right: 2px solid var(--border);
    display: flex;
    flex-direction: column;
    align-items: stretch;
    overflow-y: auto;
    z-index: 10;
  }

  .sidebar-logo {
    padding: 10px 8px 8px;
    text-align: center;
    border-bottom: 1px solid var(--border);
    flex-shrink: 0;
  }
  .sidebar-logo .shield {
    width: 56px;
    height: 56px;
    object-fit: contain;
    margin: 2px auto 6px;
    filter: drop-shadow(0 0 10px rgba(201,168,76,0.35));
    display: block;
  }
  .sidebar-logo .aircraft {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 26px;
    color: var(--text);
    letter-spacing: 2px;
  }
  .sidebar-logo .aircraft span { color: var(--red); }
  .sidebar-logo .sub {
    font-family: 'Share Tech Mono', monospace;
    font-size: 8px;
    color: var(--dim);
    letter-spacing: 1px;
    margin-top: 2px;
  }

  .nav-btn {
    width: 100%;
    padding: 0;
    flex: 1;
    min-height: 52px;
    background: transparent;
    border: none;
    border-bottom: 1px solid var(--border);
    color: var(--dim);
    font-family: 'Barlow Condensed', sans-serif;
    font-size: 14px;
    font-weight: 700;
    letter-spacing: 0.8px;
    text-transform: uppercase;
    text-align: center;
    cursor: pointer;
    transition: all 0.15s;
    line-height: 1.25;
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .nav-btn::before {
    content: '';
    position: absolute;
    left: 0; top: 0; bottom: 0;
    width: 3px;
    background: transparent;
    transition: background 0.15s;
  }
  .nav-btn:hover {
    background: var(--row-hover);
    color: var(--text);
  }
  .nav-btn:hover::before { background: var(--accent); }
  .nav-btn.active {
    background: #1a2236;
    color: var(--white);
  }
  .nav-btn.active::before { background: var(--gold); }

  .nav-btn.olive  { border-left: 3px solid #7a9a2a; }
  .nav-btn.olive.active  { background: #111a04; color: #b8d44a; }
  .nav-btn.olive.active::before { background: #7a9a2a; }
  .nav-btn.blue   { border-left: 3px solid #3a6abf; }
  .nav-btn.teal   { border-left: 3px solid #1a9a8a; }
  .nav-btn.amber  { border-left: 3px solid var(--amber); }
  .nav-btn.red    { border-left: 3px solid var(--red); }

  .nav-btn.blue.active  { background: #0e1a30; color: #7ab0ff; }
  .nav-btn.blue.active::before { background: #3a6abf; }
  .nav-btn.teal.active  { background: #061e1b; color: #3de0cc; }
  .nav-btn.teal.active::before { background: #1a9a8a; }
  .nav-btn.amber.active { background: #2a1a00; color: #ffb940; }
  .nav-btn.amber.active::before { background: var(--amber); }
  .nav-btn.red.active   { background: #2a0a0a; color: #ff6b6b; }
  .nav-btn.red.active::before   { background: var(--red); }

  /* -- MAIN -- */
  #main {
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }

  #topbar {
    background: var(--header-bg);
    border-bottom: 2px solid var(--gold);
    padding: 10px 20px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-shrink: 0;
  }
  #topbar .section-title {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 26px;
    letter-spacing: 3px;
    color: var(--white);
  }
  #topbar .meta {
    font-family: 'Share Tech Mono', monospace;
    font-size: 12px;
    color: var(--dim);
    text-align: right;
    line-height: 1.6;
  }
  #topbar .pilot-cols {
    font-family: 'Share Tech Mono', monospace;
    font-size: 10px;
    color: var(--dim);
    letter-spacing: 2px;
  }

  #content {
    flex: 1;
    overflow-y: auto;
    padding: 0;
  }

  /* -- SECTION PANELS -- */
  .section-panel { display: none; }
  .section-panel.active { display: block; }

  /* -- CHECKLIST TABLE -- */
  .cl-section {
    margin: 16px 20px;
  }
  .cl-section-header {
    background: var(--header-bg);
    border: 1px solid var(--border);
    border-bottom: 2px solid var(--gold);
    padding: 9px 14px;
    font-family: 'Bebas Neue', sans-serif;
    font-size: 19px;
    letter-spacing: 2px;
    color: var(--title);
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0;
  }
  .cl-section-header .sub-note {
    font-family: 'Barlow Condensed', sans-serif;
    font-size: 13px;
    font-weight: 400;
    color: var(--gold);
    letter-spacing: 1px;
  }

  .cl-table {
    width: 100%;
    border-collapse: collapse;
  }
  .cl-table tr {
    border-bottom: 1px solid #1e2535;
    cursor: pointer;
    transition: background 0.1s;
  }
  .cl-table tr:nth-child(even) { background: var(--row-alt); }
  .cl-table tr:hover { background: var(--row-hover); }
  .cl-table tr.checked .item-num { color: var(--green); }
  .cl-table tr.checked .item-name { text-decoration: line-through; color: var(--dim); opacity: 0.6; }
  .cl-table tr.checked .item-action { color: var(--green); opacity: 0.7; }
  .cl-table tr.checked .check-box { background: var(--green); border-color: var(--green); }
  .cl-table tr.checked .check-box::after { content: '✓'; color: white; font-size: 10px; }

  .cl-table td {
    padding: 9px 10px;
    font-size: 16px;
    vertical-align: middle;
  }
  .item-num {
    width: 34px;
    text-align: right;
    color: var(--dim);
    font-family: 'Share Tech Mono', monospace;
    font-size: 13px;
    padding-right: 6px;
  }
  .item-name {
    color: var(--text);
    font-weight: 600;
    letter-spacing: 0.3px;
  }
  .item-name .note {
    font-weight: 400;
    font-size: 13px;
    color: var(--dim);
    font-style: italic;
  }
  .item-action {
    text-align: right;
    color: var(--gold);
    font-family: 'Share Tech Mono', monospace;
    font-size: 14px;
    letter-spacing: 0.5px;
    font-weight: 700;
    padding-right: 12px;
  }
  .check-col {
    width: 36px;
    text-align: center;
  }
  .check-box {
    width: 18px;
    height: 18px;
    border: 1.5px solid var(--border);
    border-radius: 2px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-size: 0;
    transition: all 0.15s;
    margin: auto;
  }

  /* special rows */
  .row-note {
    background: #0f1520 !important;
    border-top: 1px solid #253050;
    border-bottom: 1px solid #253050;
  }
  .row-note td {
    color: var(--dim);
    font-size: 11px;
    font-style: italic;
    text-align: center;
    padding: 5px 14px;
    letter-spacing: 0.5px;
    font-family: 'Share Tech Mono', monospace;
  }
  /* -- REPEAT ENGINE row – high visibility -- */
  .row-repeat {
    background: linear-gradient(90deg, #1a0e00, #2a1800, #1a0e00) !important;
    border-top: 1px solid #e88f00 !important;
    border-bottom: 1px solid #e88f00 !important;
    animation: repeatPulse 3s ease-in-out infinite;
  }
  .row-repeat td {
    color: #ffb940;
    font-size: 12px;
    font-family: 'Barlow Condensed', sans-serif;
    font-weight: 700;
    font-style: normal;
    text-align: center;
    letter-spacing: 2px;
    padding: 7px 5px;
    text-transform: uppercase;
  }
  .row-repeat td::before { content: '↻ '; font-size: 13px; }
  @keyframes repeatPulse {
    0%, 100% { box-shadow: inset 0 0 0px #e88f00; }
    50%       { box-shadow: inset 0 0 10px #e88f0044; }
  }

  .cl-table tr:has(.item-name:-webkit-contains("→")) {
    background: #160e03 !important;
  }
  /* Target rows whose item-name starts with → */
  .cl-table td.item-name[data-ff="1"] {
    color: #ffb060;
    font-weight: 600;
  }
  .cl-table tr.ff-row {
    background: #160e03 !important;
    border-left: 2px solid #c94400;
  }
  .cl-table tr.ff-row td.item-name {
    color: #ffb060;
    font-weight: 600;
  }
  .cl-table tr.ff-row td.item-num {
    color: #ff7a30;
    font-weight: 700;
  }
  .first-flight-badge {
    display: inline-flex;
    align-items: center;
    gap: 5px;
    background: linear-gradient(90deg, #7a2a00, #c94400, #7a2a00);
    color: #fff;
    font-family: 'Barlow Condensed', sans-serif;
    font-size: 11px;
    font-weight: 700;
    letter-spacing: 2px;
    padding: 2px 10px 2px 8px;
    border-radius: 2px;
    text-transform: uppercase;
    border: 1px solid #ff6a20;
    animation: ffPulse 2.5s ease-in-out infinite;
    white-space: nowrap;
    vertical-align: middle;
    margin-left: 6px;
  }
  @keyframes ffPulse {
    0%, 100% { opacity: 1; box-shadow: 0 0 0px #ff6a20; }
    50%       { opacity: 0.85; box-shadow: 0 0 8px #ff6a2088; }
  }

  /* banner rows */
  .banner {
    margin: 8px 20px 0;
    padding: 8px 14px;
    font-family: 'Bebas Neue', sans-serif;
    font-size: 14px;
    letter-spacing: 2px;
    text-align: center;
    border-radius: 2px;
  }
  .banner.red    { background: var(--red); color: #fff; }
  .banner.amber  { background: var(--amber); color: #0a0800; }
  .banner.note   { background: #1a2236; color: var(--gold); border: 1px solid var(--accent); }

  /* reset bar */
  .reset-bar {
    display: flex;
    justify-content: flex-end;
    padding: 8px 20px 4px;
    gap: 10px;
  }
  .reset-btn, .check-all-btn {
    font-family: 'Barlow Condensed', sans-serif;
    font-size: 11px;
    font-weight: 700;
    letter-spacing: 1px;
    text-transform: uppercase;
    padding: 5px 14px;
    border: 1px solid var(--border);
    border-radius: 2px;
    cursor: pointer;
    transition: all 0.15s;
    background: transparent;
  }
  .reset-btn { color: var(--dim); }
  .reset-btn:hover { background: var(--red); color: #fff; border-color: var(--red); }
  .check-all-btn { color: var(--dim); }
  .check-all-btn:hover { background: var(--green); color: #fff; border-color: var(--green); }

  /* Progress bar */
  .progress-bar-wrap {
    padding: 0 20px 12px;
    display: flex;
    align-items: center;
    gap: 12px;
  }
  .progress-bar {
    flex: 1;
    height: 4px;
    background: var(--border);
    border-radius: 2px;
    overflow: hidden;
  }
  .progress-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--green), #4adf70);
    transition: width 0.3s;
  }
  .progress-label {
    font-family: 'Share Tech Mono', monospace;
    font-size: 10px;
    color: var(--dim);
    white-space: nowrap;
  }

  /* -- PROFILES -- */
  .prof-tab {
    flex: 1; padding: 10px 8px;
    background: transparent; border: none; border-bottom: 3px solid transparent;
    color: var(--dim); font-family: 'Barlow Condensed', sans-serif;
    font-size: 13px; font-weight: 700; letter-spacing: 1.5px; text-transform: uppercase;
    cursor: pointer; transition: all 0.15s;
  }
  .prof-tabs {
    display: flex;
    background: var(--prof-tabs-bg);
    border-bottom: 2px solid var(--prof-tabs-border);
    flex-shrink: 0;
  }
  .prof-meta {
    padding: 10px 16px 0;
    font-family: 'Share Tech Mono', monospace;
    font-size: 9px;
    color: var(--prof-meta);
    letter-spacing: 1px;
  }
  .prof-help {
    margin: 6px 16px 0;
    padding: 8px 12px;
    background: var(--prof-help-bg);
    border: 1px solid var(--prof-help-border);
    border-left: 3px solid var(--prof-help-accent);
    font-family: 'Share Tech Mono', monospace;
    font-size: 10px;
    color: var(--prof-help-text);
    line-height: 1.7;
    letter-spacing: 0.5px;
  }
  .prof-help strong { color: var(--prof-help-strong); }
  .prof-tab:hover { color: var(--text); background: var(--prof-tab-hover-bg); }
  .prof-tab.active { color: var(--prof-tab-active-text); border-bottom-color: var(--prof-tab-active-border); background: var(--prof-tab-active-bg); }

  .prof-card {
    min-width: 80px; padding: 8px 10px;
    background: var(--prof-card-bg); border: 1px solid var(--border);
    color: var(--dim); font-family: 'Barlow Condensed', sans-serif;
    font-size: 12px; font-weight: 700; letter-spacing: 0.8px; text-transform: uppercase;
    text-align: center; cursor: pointer; border-radius: 3px; line-height: 1.4;
    transition: all 0.15s;
  }
  .prof-card small { font-size: 9px; font-weight: 400; letter-spacing: 0.5px; display: block; color: var(--dim); }
  .prof-card:hover { border-color: var(--prof-card-hover-border); color: var(--text); background: var(--prof-card-hover-bg); }
  .prof-card.active { background: var(--prof-card-active-bg); border-color: var(--prof-card-active-border); color: var(--prof-card-active-text); }
  .prof-card.active small { color: var(--prof-card-active-subtext); }
  .prof-card.cat-a { border-color: var(--prof-card-cat-a-border); }
  .prof-card.cat-a:hover { border-color: var(--prof-card-cat-a-hover-border); }

  /* phase blocks */
  .phase-block {
    background: var(--phase-bg); border: 1px solid var(--phase-border);
    border-radius: 3px; margin-bottom: 10px; overflow: hidden;
  }
  .phase-header {
    display: flex; align-items: center; gap: 10px;
    padding: 8px 12px; background: var(--phase-header-bg);
    border-bottom: 1px solid var(--phase-header-border);
  }
  .phase-badge {
    font-family: 'Bebas Neue', sans-serif; font-size: 11px;
    letter-spacing: 2px; padding: 2px 8px; border-radius: 2px;
    white-space: nowrap;
  }
  .phase-title {
    font-family: 'Barlow Condensed', sans-serif; font-size: 13px;
    font-weight: 700; letter-spacing: 1px; color: var(--text); text-transform: uppercase;
  }
  .phase-body { padding: 10px 12px; }
  .param-grid {
    display: grid; grid-template-columns: repeat(auto-fill, minmax(170px, 1fr));
    gap: 8px;
  }
  .param-item {
    background: var(--param-item-bg); border: 1px solid var(--param-item-border);
    border-radius: 2px; padding: 7px 10px;
  }
  .param-label {
    font-family: 'Share Tech Mono', monospace; font-size: 9px;
    color: var(--dim); letter-spacing: 1px; margin-bottom: 3px; text-transform: uppercase;
  }
  .param-value {
    font-family: 'Barlow Condensed', sans-serif; font-size: 15px;
    font-weight: 700; color: var(--param-value); letter-spacing: 0.5px;
  }
  .param-value.green { color: var(--param-value-green); }
  .param-value.red   { color: var(--param-value-red); }
  .param-value.blue  { color: var(--param-value-blue); }
  .param-value.white { color: var(--param-value-white); }

  /* contingency sub-tabs */
  .cont-tabs { display: flex; gap:0; border-bottom: 1px solid var(--phase-header-border); margin-bottom: 0; }
  .cont-tab {
    flex: 1; padding: 6px 4px; background: transparent; border: none;
    border-bottom: 2px solid transparent; color: var(--dim);
    font-family: 'Barlow Condensed', sans-serif; font-size: 11px;
    font-weight: 700; letter-spacing: 1px; cursor: pointer; transition: all 0.15s;
    text-transform: uppercase;
  }
  .cont-tab:hover { background: var(--cont-tab-hover-bg); color: var(--text); }
  .cont-tab.rto { border-bottom-color: transparent; }
  .cont-tab.rto.active { color: var(--cont-tab-rto-text); border-bottom-color: var(--cont-tab-rto-border); background: var(--cont-tab-rto-bg); }
  .cont-tab.cto { border-bottom-color: transparent; }
  .cont-tab.cto.active { color: var(--cont-tab-cto-text); border-bottom-color: var(--cont-tab-cto-border); background: var(--cont-tab-cto-bg); }
  .cont-tab.oei { border-bottom-color: transparent; }
  .cont-tab.oei.active { color: var(--cont-tab-oei-text); border-bottom-color: var(--cont-tab-oei-border); background: var(--cont-tab-oei-bg); }
  .cont-tab.blk { border-bottom-color: transparent; }
  .cont-tab.blk.active { color: var(--cont-tab-blk-text); border-bottom-color: var(--cont-tab-blk-border); background: var(--cont-tab-blk-bg); }
  .cont-pane { display: none; padding: 10px 0 0; }
  .cont-pane.active { display: block; }

  .prof-note {
    margin: 6px 0; padding: 6px 10px; background: var(--prof-note-bg);
    border-left: 2px solid var(--prof-note-border); font-family: 'Share Tech Mono', monospace;
    font-size: 10px; color: var(--prof-note-text); line-height: 1.6; letter-spacing: 0.3px;
  }
  .phase-divider {
    display: flex; align-items: center; gap: 8px;
    margin: 6px 0; font-family: 'Share Tech Mono', monospace;
    font-size: 9px; color: var(--phase-divider-text); letter-spacing: 2px;
  }
  .phase-divider::before, .phase-divider::after {
    content: ''; flex: 1; height: 1px; background: var(--phase-divider-line);
  }

  @media (max-width: 700px) {
    .param-grid { grid-template-columns: repeat(2, 1fr); }
    .prof-card { min-width: 60px; font-size: 10px; }
  }

  /* scrollbar */
  #content::-webkit-scrollbar { width: 6px; }
  #content::-webkit-scrollbar-track { background: var(--bg); }
  #content::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }
  #sidebar::-webkit-scrollbar { width: 4px; }
  #sidebar::-webkit-scrollbar-track { background: var(--header-bg); }
  #sidebar::-webkit-scrollbar-thumb { background: var(--border); }

  /* -- TOGGLES DÍA / NOCHE / NVG -- */
  .mode-btn-wrap {
    display: flex;
    flex-direction: column;
    flex-shrink: 0;
    margin-top: auto;
    border-top: 2px solid var(--border);
  }
  .mode-btn {
    width: 100%;
    padding: 8px 6px;
    background: transparent;
    border: none;
    border-bottom: 1px solid var(--border);
    cursor: pointer;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 3px;
    transition: background 0.2s;
  }
  .mode-btn:last-child { border-bottom: none; }
  .mode-btn:hover { background: var(--row-hover); }
  .mode-btn .m-svg {
    width: 20px;
    height: 20px;
    color: var(--dim);
    transition: color 0.2s ease, transform 0.3s ease;
    flex-shrink: 0;
  }
  .mode-btn:hover .m-svg { transform: scale(1.12); color: var(--text); }
  #nvg-toggle.nvg-on .m-svg { color: #00AA44; }
  :root[data-mode="day"] #mode-toggle .m-svg { color: var(--gold); }
  .mode-btn .m-label {
    font-family: 'Share Tech Mono', monospace;
    font-size: 8px;
    letter-spacing: 1px;
    color: var(--dim);
    text-transform: uppercase;
  }
  /* Botón NVG – estado activo */
  #nvg-toggle.nvg-on {
    background: #001800;
    border-left: 3px solid #00AA44;
  }
  #nvg-toggle.nvg-on .m-label { color: #00AA44; }
  :root[data-mode="nvg"] #mode-toggle .m-label { color: var(--dim); }

  /* Transición suave al cambiar modo */
  body, #sidebar, #topbar, .cl-table td, .nav-btn, .cl-section-header {
    transition: background 0.3s ease, color 0.3s ease, border-color 0.3s ease;
  }

  /* info note block */
  .info-block {
    margin: 0 20px 12px;
    padding: 10px 14px;
    background: #0f1825;
    border-left: 3px solid var(--accent);
    font-size: 11px;
    color: var(--dim);
    font-family: 'Share Tech Mono', monospace;
    line-height: 1.6;
    letter-spacing: 0.3px;
  }
  .info-link {
    color: #b8d44a;
    letter-spacing: 1px;
  }
  .abort-caution {
    margin: 12px 20px 0;
    padding: 10px 14px;
    background: var(--abort-caution-bg);
    border: 2px solid var(--abort-caution-border);
    border-radius: 2px;
  }
  .abort-caution-title {
    font-family: 'Barlow Condensed', sans-serif;
    font-size: 13px;
    font-weight: 700;
    color: var(--abort-caution-title);
    letter-spacing: 2px;
    text-align: center;
    margin-bottom: 6px;
  }
  .abort-caution-text {
    font-family: 'Share Tech Mono', monospace;
    font-size: 10px;
    color: var(--abort-caution-text);
    line-height: 1.7;
    letter-spacing: 0.3px;
  }
  .abort-context {
    margin: 10px 20px 0;
    padding: 10px 14px;
    background: var(--abort-context-bg);
    border-left: 3px solid var(--abort-context-border);
    font-family: 'Share Tech Mono', monospace;
    font-size: 10px;
    color: var(--abort-context-text);
    line-height: 1.8;
    letter-spacing: 0.3px;
  }
  .abort-context-accent { color: var(--abort-context-accent); font-weight: 700; }
  .abort-list {
    margin: 0 20px 10px;
    padding: 10px 14px;
    background: var(--abort-list-bg);
    border: 1px solid var(--abort-list-border);
    border-top: none;
  }
  .abort-list table { width: 100%; border-collapse: collapse; font-family: 'Share Tech Mono', monospace; font-size: 10px; }
  .abort-list-row { background: var(--abort-list-row-bg); }
  .abort-list-cell { padding: 6px 10px; color: var(--abort-list-text); border-bottom: 1px solid var(--abort-list-border); }
  .abort-bullet { color: var(--abort-list-bullet); margin-right: 8px; }
  .abort-accent { color: var(--abort-list-accent); }
  .abort-ff-note { text-align: center; }
  .abort-ff-text { color: var(--abort-ff-text); }
  .abort-ff-accent { color: var(--abort-ff-accent); }

  /* pilot header row */
  .pilot-header {
    display: flex;
    padding: 4px 46px 4px 14px;
    background: var(--header-bg);
    border-bottom: 1px solid var(--border);
    font-family: 'Share Tech Mono', monospace;
    font-size: 9px;
    color: var(--dim);
    letter-spacing: 2px;
    justify-content: space-between;
  }

  /* two-column layout for compact sections */
  .two-col {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 0 20px;
    padding: 0 20px;
  }
  .two-col .cl-section { margin: 16px 0; }

  @media (max-width: 700px) {
    #sidebar { width: 80px; min-width: 80px; }
    .nav-btn { font-size: 10px; }
    .two-col { grid-template-columns: 1fr; }
  }
</style>
</head>
<body>

<!-- --- SPLASH SCREEN --- -->
<div id="splash">
  <img class="splash-helo" src="imagen.jpeg" alt="Escudo Águila Uno">
  <div class="splash-title">AW139<br><span style="font-size:18px;letter-spacing:4px;color:#4a7aaa;">CHECKLIST</span></div>
  <div class="splash-sub">
    FUERZA AEROESPACIAL COLOMBIANA<br>
    AW-139
  
  </div>
  <div class="splash-bar-wrap"><div class="splash-bar"></div></div>
  <div style="font-family:'Courier New',monospace;font-size:9px;color:#1a2a3a;letter-spacing:2px;margin-top:4px;">LOADING SYSTEMS...</div>
  <div style="position:absolute;bottom:20px;font-family:'Share Tech Mono',monospace;font-size:10px;color:#1a2a3a;letter-spacing:1px;color:#005522;">DESIGNED BY ANTHRAX</div>
</div>

<!-- SIDEBAR -->
<nav id="sidebar">
  <div class="sidebar-logo">
    <img class="shield" src="imagen.jpeg" alt="Escudo Águila Uno">
    <div class="aircraft">AW139 <span>ÁGUILA</span> 1</div>
    <div class="sub">FAC 0008 • CHECKLIST</div>
  </div>

  <button class="nav-btn blue active" onclick="show('cockpit')" id="btn-cockpit">COCKPIT<br>SAFETY<br>PRE-START</button>
  <button class="nav-btn blue" onclick="show('start')" id="btn-start">ENGINE<br>START</button>
  <button class="nav-btn blue" onclick="show('syschecks')" id="btn-syschecks">SYS<br>CHECKS</button>
  <button class="nav-btn blue" onclick="show('taxi')" id="btn-taxi">TAXI &amp;<br>TAKE OFF</button>
  <button class="nav-btn blue" onclick="show('cruise')" id="btn-cruise">CRUISE<br>LANDING</button>
  <button class="nav-btn blue" onclick="show('shutdown')" id="btn-shutdown">SHUT<br>DOWN</button>
  <button class="nav-btn blue" onclick="show('ifr')" id="btn-ifr">IFR<br>DEP/APP</button>
  <button class="nav-btn blue" onclick="show('subsequent')" id="btn-subsequent">SUBSEQ.<br>STARTS</button>
  <button class="nav-btn teal" onclick="show('pac')" id="btn-pac">POWER<br>ASSURANCE</button>
  <button class="nav-btn olive" onclick="show('profiles')" id="btn-profiles">T/O &amp; LDG<br>PROFILES</button>
  <button class="nav-btn amber" onclick="show('abort')" id="btn-abort">ABORT<br>START</button>
  <button class="nav-btn amber" onclick="show('drymot')" id="btn-drymot">DRY<br>MOTOR</button>
  <button class="nav-btn red" onclick="show('exhaust')" id="btn-exhaust">EXHAUST<br>FIRE</button>

  <!-- TOGGLES DÍA / NOCHE / NVG -->
  <div class="mode-btn-wrap">
    <button id="mode-toggle" class="mode-btn" onclick="toggleMode()" title="Cambiar modo día / noche">
      <span id="mode-icon"><svg class="m-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          <line x1="17" y1="4" x2="17" y2="4.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
          <line x1="20" y1="7" x2="20.5" y2="7" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
          <line x1="19" y1="3" x2="19.5" y2="2.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
        </svg></span>
      <span class="m-label" id="mode-label">NOCHE</span>
    </button>
    <button id="nvg-toggle" class="mode-btn" onclick="toggleNVG()" title="Modo NVG – MIL-STD-3009 Clase A">
      <svg class="m-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <rect x="2" y="9" width="8" height="7" rx="3" stroke="currentColor" stroke-width="1.5"/>
          <rect x="14" y="9" width="8" height="7" rx="3" stroke="currentColor" stroke-width="1.5"/>
          <path d="M10 12.5h4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
          <circle cx="6" cy="12.5" r="1.5" fill="currentColor" opacity="0.6"/>
          <circle cx="18" cy="12.5" r="1.5" fill="currentColor" opacity="0.6"/>
          <path d="M7 9V7" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
          <path d="M17 9V7" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
        </svg>
      <span class="m-label" id="nvg-label">NVG</span>
    </button>
  </div>
</nav>

<!-- MAIN -->
<div id="main">
  <div id="topbar">
    <div class="section-title" id="section-label">COCKPIT SAFETY / PRE-START</div>
    <span class="nvg-badge">● NVG MODE – MIL-STD-3009</span>
    <div class="meta">ISSUE 6 &nbsp;|&nbsp; 20-AUG-2025<br>AW-139 – FAC 0008</div>
  </div>

  <div id="content">

    <!-- ------------------ COCKPIT SAFETY / PRE-START ------------------ -->
    <div class="section-panel active" id="panel-cockpit">
      <div class="reset-bar">
        <button class="check-all-btn" onclick="checkAll('cockpit')">CHECK ALL</button>
        <button class="reset-btn" onclick="resetSection('cockpit')">RESET</button>
      </div>
      <div class="progress-bar-wrap">
        <div class="progress-bar"><div class="progress-fill" id="prog-cockpit" style="width:0%"></div></div>
        <div class="progress-label" id="label-cockpit">0 / 0</div>
      </div>

      <!-- Cockpit Safety Check -->
      <div class="cl-section" data-section="cockpit">
        <div class="cl-section-header">COCKPIT / SAFETY CHECK</div>
        <div class="pilot-header"><span>LHP</span><span>RHP</span></div>
        <table class="cl-table" id="tbl-cockpit-safety">
          <tr onclick="toggle(this)"><td class="item-num">1</td><td class="item-name">Ties &amp; Covers</td><td class="item-action">REMOVED</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">2</td><td class="item-name">Belt / Seat / Pedals</td><td class="item-action">ADJUST</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">3</td><td class="item-name">Circuit Breakers</td><td class="item-action">IN</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">4</td><td class="item-name">ECL's</td><td class="item-action">FLIGHT</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">5</td><td class="item-name">Rotor Brake</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">6</td><td class="item-name">Overhead Switches</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">7</td><td class="item-name">Static Sources</td><td class="item-action">GUARDED</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">8</td><td class="item-name">ELT</td><td class="item-action">ARM</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">9</td><td class="item-name">Fire Panel</td><td class="item-action">CENTER/GUARDED</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">10</td><td class="item-name">Fuel Panel</td><td class="item-action">OFF/CLOSED</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">11</td><td class="item-name">ENG MODE Switch</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">12</td><td class="item-name">Radio Master</td><td class="item-action">ON</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">13</td><td class="item-name">Pedestal Switches</td><td class="item-action">OFF / SET</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">14</td><td class="item-name">Landing Gear Lever / DAS</td><td class="item-action">DOWN / 03 PINS</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">15</td><td class="item-name">Parking Brake</td><td class="item-action">ON / PRESS</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">16</td><td class="item-name">Chocks</td><td class="item-action">REMOVE</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">17</td><td class="item-name">ENG GOV Switches</td><td class="item-action">AUTO</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">18</td><td class="item-name">RPM Switch</td><td class="item-action">100%</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">19</td><td class="item-name">Collective / Cyclic Switches</td><td class="item-action">GUARDED</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">20</td><td class="item-name">Liferaft Release</td><td class="item-action">PIN SECURED</td><td class="check-col"><div class="check-box"></div></td></tr>
        </table>
      </div>

      <!-- Pre-Start Checks -->
      <div class="cl-section" data-section="cockpit">
        <div class="cl-section-header">PRE-START CHECKS</div>
        <div class="pilot-header"><span>LHP</span><span>RHP</span></div>
                <div class="cl-section-header"><span class="first-flight-badge">→ FIRST FLIGHT OF THE DAY</span></div>
        <table class="cl-table">
          <tr onclick="toggle(this)"><td class="item-num">1</td><td class="item-name">Headset</td><td class="item-action">PUT ON</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">2</td><td class="item-name">Electrical Switches</td><td class="item-action">ON (VOLTS)</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">3</td><td class="item-name">External Power</td><td class="item-action"> A/R</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">4</td><td class="item-name">Bus Tie</td><td class="item-action">(1) AUTO / (2) ON / EPU AUTO</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">5</td><td class="item-name">MFD</td><td class="item-action">CHECK VOLT / FUEL</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">6</td><td class="item-name">CAS MESSAGES</td><td class="item-action">CHECK</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">7</td><td class="item-name">PFD</td><td class="item-action">BRG/ LNAV / DH / HDG</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">8</td><td class="item-name">5th Display / DAS</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">9</td><td class="item-name">FD / AFCS</td><td class="item-action">STBY / OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">10</td><td class="item-name">→ Flight Controls</td><td class="item-action">2'Elec Pump / CHECK</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">11</td><td class="item-name">→ Test Panel</td><td class="item-action">CHECK</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">12</td><td class="item-name">Caliper</td><td class="item-action">UP / NO PRESSURE</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">13</td><td class="item-name">Landing Gear Panel</td><td class="item-action">3 GREEN</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">14</td><td class="item-name">→ ENG TRIM Beep</td><td class="item-action"> TEST</td><td class="check-col"><div class="check-box"></div></td></tr>
        </table>
      </div>
    </div>

    <!-- ------------------ ENGINE START ------------------ -->
    <div class="section-panel" id="panel-start">
      <div class="reset-bar">
        <button class="check-all-btn" onclick="checkAll('start')">CHECK ALL</button>
        <button class="reset-btn" onclick="resetSection('start')">RESET</button>
      </div>
      <div class="progress-bar-wrap">
        <div class="progress-bar"><div class="progress-fill" id="prog-start" style="width:0%"></div></div>
        <div class="progress-label" id="label-start">0 / 0</div>
      </div>

      <div class="cl-section" data-section="start">
        <div class="cl-section-header">ENGINE START</div>
        <div class="pilot-header"><span>LHP</span><span>RHP</span></div>
        <table class="cl-table">
          <tr onclick="toggle(this)"><td class="item-num">1</td><td class="item-name">ATIS / Clearance</td><td class="item-action">OBTAIN</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">2</td><td class="item-name">Baro Selec. / Xpndr</td><td class="item-action">ESIS SET / SET-ON</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">3</td><td class="item-name">Anti-COL. / Position / Strobe LT</td><td class="item-action">ON</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">4</td><td class="item-name">Main Bus</td><td class="item-action">&gt; 23V</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">5</td><td class="item-name">Bus Tie (2) / PFD BRIGHT</td><td class="item-action">ON / INCREASE</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">6</td><td class="item-name">ENG 1(2) FUEL Switch</td><td class="item-action">ON</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">7</td><td class="item-name">ENG 1(2) FUEL PUMP</td><td class="item-action">ON / CHECK PRESS</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">8</td><td class="item-name">ENG 1(2) MODE Switch</td><td class="item-action">IDLE</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">9</td><td class="item-name">T's &amp; P's</td><td class="item-action">MONITOR</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">10</td><td class="item-name">NR / NF</td><td class="item-action">65% ± 1%</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">11</td><td class="item-name">ENG 1(2) MODE Switch</td><td class="item-action">FLIGHT</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">12</td><td class="item-name">GEN 1(2)</td><td class="item-action">ON LINE / Check load</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="row-repeat" onclick="repeatReset(this, 'start', 5, 12)"><td colspan="4">REPEAT ITEMS 5 TO 12 FOR 2nd ENGINE</td></tr>
          <tr onclick="toggle(this)"><td class="item-num">13</td><td class="item-name">NR / NF</td><td class="item-action">100%</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">14</td><td class="item-name">External Power</td><td class="item-action">OFF / Disconnect</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">15</td><td class="item-name">GEN 1 &amp; 2</td><td class="item-action">Confirm ON LINE</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">16</td><td class="item-name">Bus Tie</td><td class="item-action">AUTO</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">17</td><td class="item-name">Air Conditioning</td><td class="item-action">ON / Close Doors</td><td class="check-col"><div class="check-box"></div></td></tr>
        </table>
      </div>
    </div>

    <!-- ------------------ SYSTEM CHECKS ------------------ -->
    <div class="section-panel" id="panel-syschecks">
      <div class="reset-bar">
        <button class="check-all-btn" onclick="checkAll('syschecks')">CHECK ALL</button>
        <button class="reset-btn" onclick="resetSection('syschecks')">RESET</button>
      </div>
      <div class="progress-bar-wrap">
        <div class="progress-bar"><div class="progress-fill" id="prog-syschecks" style="width:0%"></div></div>
        <div class="progress-label" id="label-syschecks">0 / 0</div>
      </div>

      <div class="cl-section" data-section="syschecks">
        <div class="cl-section-header">SYSTEM CHECKS <span class="first-flight-badge">→ FIRST FLIGHT OF THE DAY</span></div>
        <div class="pilot-header"><span>LHP</span><span>RHP</span></div>
        <table class="cl-table">
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">1</td><td class="item-name">→ Hydraulic</td><td class="item-action">CHECK</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">2</td><td class="item-name">→ FUEL Panel</td><td class="item-action">TEST</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">3</td><td class="item-name">→ AFCS</td><td class="item-action">TEST</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">4</td><td class="item-name">→ RAD ALT</td><td class="item-action">TEST</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">5</td><td class="item-name">Altimeters</td><td class="item-action">SET / X CHECK</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">6</td><td class="item-name">5th Display / DAS / Wx Radar</td><td class="item-action">A/R</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">7</td><td class="item-name">MCDU</td><td class="item-action">PERF. INIT / RAD / NAV</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">8</td><td class="item-name">MFD</td><td class="item-action">MAP / PLAN Boxes SET</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">9</td><td class="item-name">PFD</td><td class="item-action">(BEAR / HSI / ALTA) SET</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">10</td><td class="item-name">Emergency & External Lights</td><td class="item-action">TEST / ARM</td><td class="check-col"><div class="check-box"></div></td></tr>

        </table>
      </div>

    </div>

    <!-- ------------------ TAXI / TAKE OFF ------------------ -->
    <div class="section-panel" id="panel-taxi">
      <div class="reset-bar">
        <button class="check-all-btn" onclick="checkAll('taxi')">CHECK ALL</button>
        <button class="reset-btn" onclick="resetSection('taxi')">RESET</button>
      </div>
      <div class="progress-bar-wrap">
        <div class="progress-bar"><div class="progress-fill" id="prog-taxi" style="width:0%"></div></div>
        <div class="progress-label" id="label-taxi">0 / 0</div>
      </div>

      <div class="cl-section" data-section="taxi">
        <div class="cl-section-header">TAXIING</div>
        <div class="pilot-header"><span>PM</span><span>PF</span></div>
        <table class="cl-table">
          <tr onclick="toggle(this)"><td class="item-num">1</td><td class="item-name">Air Conditioning / Vent</td><td class="item-action">A/R</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">2</td><td class="item-name">Doors</td><td class="item-action">CLOSED</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">3</td><td class="item-name">Autopilots</td><td class="item-action">ON</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">4</td><td class="item-name">Chocks – Verify</td><td class="item-action">REMOVED</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">5</td><td class="item-name">Nose Wheel</td><td class="item-action">UNLOCK</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">6</td><td class="item-name">Parking Brake</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">7</td><td class="item-name">ATC Clearance</td><td class="item-action"><Obj>OBTAIN</Obj></td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">8</td><td class="item-name">Pedal Control &amp; Brakes</td><td class="item-action">CHECK</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">9</td><td class="item-name">Fuel XFEED</td><td class="item-action">NORMAL</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">10</td><td class="item-name">T's & P's / CAS</td><td class="item-action">CHECK</td><td class="check-col"><div class="check-box"></div></td></tr>


        </table>
      </div>

      <div class="cl-section" data-section="taxi">
        <div class="cl-section-header">PRE TAKE-OFF (Line Up)</div>
        <table class="cl-table">
          <tr onclick="toggle(this)"><td class="item-num">1</td><td class="item-name">Autopilots</td><td class="item-action">ON</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">2</td><td class="item-name">NR / NF</td><td class="item-action">100 / CAT A 102%</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">3</td><td class="item-name">Parking Brake</td><td class="item-action">A/R</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">4</td><td class="item-name">Nose Wheel</td><td class="item-action">LOCKED</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">5</td><td class="item-name">XPDR / TCAS</td><td class="item-action">ON</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">6</td><td class="item-name">Wx Radar</td><td class="item-action">ON</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">7</td><td class="item-name">Heading</td><td class="item-action">SET</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">8</td><td class="item-name">Take Off Briefing / TEM</td><td class="item-action">PERFORM</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">9</td><td class="item-name">Landing Lights</td><td class="item-action">ON</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">10</td><td class="item-name">ATC Clearance</td><td class="item-action">OBTAIN</td><td class="check-col"><div class="check-box"></div></td></tr>

        </table>
      </div>

      <div class="cl-section" data-section="taxi">
        <div class="cl-section-header">AFTER TAKE OFF (Vy &amp; 150 ft AGL) GA</div>
        <table class="cl-table">
          <tr onclick="toggle(this)"><td class="item-num">1</td><td class="item-name">NR</td><td class="item-action">100%</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">2</td><td class="item-name">Landing Gear</td><td class="item-action">A/R</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">3</td><td class="item-name">Flight Director Modes</td><td class="item-action">MANUAL / HDG / NAV</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">4</td><td class="item-name">T's &amp; P's / CAS</td><td class="item-action">CHECK</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">5</td><td class="item-name">Parking Brake</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">6</td><td class="item-name">Landing Lights</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
        </table>
      </div>
    </div>

    <!-- ------------------ CRUISE / LANDING ------------------ -->
    <div class="section-panel" id="panel-cruise">
      <div class="reset-bar">
        <button class="check-all-btn" onclick="checkAll('cruise')">CHECK ALL</button>
        <button class="reset-btn" onclick="resetSection('cruise')">RESET</button>
      </div>
      <div class="progress-bar-wrap">
        <div class="progress-bar"><div class="progress-fill" id="prog-cruise" style="width:0%"></div></div>
        <div class="progress-label" id="label-cruise">0 / 0</div>
      </div>

      <div class="cl-section" data-section="cruise">
        <div class="cl-section-header">CLIMB / CRUISE / DESCENT</div>
        <div class="pilot-header"><span>PM</span><span>PF</span></div>
        <table class="cl-table">
          <tr onclick="toggle(this)"><td class="item-num">1</td><td class="item-name">Altimeters</td><td class="item-action">SET X CHECK</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">2</td><td class="item-name">T's &amp; P's / CAS</td><td class="item-action">CHECK</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">3</td><td class="item-name">Fuel / Systems</td><td class="item-action">CHECK </td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">4</td><td class="item-name">Flight Instruments</td><td class="item-action">NORMAL OPERAT.</td><td class="check-col"><div class="check-box"></div></td></tr>
        </table>
      </div>

      <div class="cl-section" data-section="cruise">
        <div class="cl-section-header">PRE LANDING</div>
        <table class="cl-table">
          <tr onclick="toggle(this)"><td class="item-num">1</td><td class="item-name">T's &amp; P's / CAS</td><td class="item-action">CHECK</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">2</td><td class="item-name">Landing Gear</td><td class="item-action">IAS -150K /DOWN &amp; LOCKED</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">3</td><td class="item-name">Nose Wheel</td><td class="item-action">LOCKED</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">4</td><td class="item-name">Parking Brake</td><td class="item-action">A/R</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">5</td><td class="item-name">Wx Radar</td><td class="item-action">A/R</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">6</td><td class="item-name">Landing Lights</td><td class="item-action">ON</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">7</td><td class="item-name">Approach Briefing / TEM</td><td class="item-action">PERFORM</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">8</td><td class="item-name">Sterile Cockpit</td><td class="item-action">BEGIN</td><td class="check-col"><div class="check-box"></div></td></tr>
        </table>
      </div>

      <div class="cl-section" data-section="cruise">
        <div class="cl-section-header">FINAL (Final HDG &amp; 400 ft AGL)</div>
        <table class="cl-table">
          <tr onclick="toggle(this)"><td class="item-num">1</td><td class="item-name">Landing Gear</td><td class="item-action">3 GREEN</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">2</td><td class="item-name">NR</td><td class="item-action">100% (CAT A 102% -90KT)</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">3</td><td class="item-name">MFD</td><td class="item-action">POWERPLANT</td><td class="check-col"><div class="check-box"></div></td></tr>
        </table>
      </div>

      <div class="cl-section" data-section="cruise">
        <div class="cl-section-header">POST LANDING</div>
        <table class="cl-table">
          <tr onclick="toggle(this)"><td class="item-num">1</td><td class="item-name">Nose Wheel</td><td class="item-action">A/R</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">2</td><td class="item-name">Parking Brake</td><td class="item-action">A/R</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">3</td><td class="item-name">NR</td><td class="item-action">100%</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">4</td><td class="item-name">External Lights</td><td class="item-action">A/R</td><td class="check-col"><div class="check-box"></div></td></tr>
        </table>
      </div>
    </div>

    <!-- ------------------ SHUTDOWN ------------------ -->
    <div class="section-panel" id="panel-shutdown">
      <div class="reset-bar">
        <button class="check-all-btn" onclick="checkAll('shutdown')">CHECK ALL</button>
        <button class="reset-btn" onclick="resetSection('shutdown')">RESET</button>
      </div>
      <div class="progress-bar-wrap">
        <div class="progress-bar"><div class="progress-fill" id="prog-shutdown" style="width:0%"></div></div>
        <div class="progress-label" id="label-shutdown">0 / 0</div>
      </div>

      <div class="cl-section" data-section="shutdown">
        <div class="cl-section-header">SHUTDOWN</div>
        <div class="pilot-header"><span>LHP</span><span>RHP</span></div>
        <table class="cl-table">
          <tr onclick="toggle(this)"><td class="item-num">1</td><td class="item-name">Flight Controls</td><td class="item-action">CENTER / MPOG</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">2</td><td class="item-name">Parking Brake</td><td class="item-action">ON</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">3</td><td class="item-name">Nose Wheel</td><td class="item-action">LOCKED</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">4</td><td class="item-name">Autopilots</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">5</td><td class="item-name">Air Conditioning</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">6</td><td class="item-name">ENG MODE Switches</td><td class="item-action">IDLE (1')</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">7</td><td class="item-name">5th Display / DAS / Wx Rad / Wiper</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">8</td><td class="item-name">Bus Tie</td><td class="item-action">ON</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">9</td><td class="item-name">FUEL PUMP's</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">10</td><td class="item-name">ENG MODE Switches</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">11</td><td class="item-name">Rotor Brake</td><td class="item-action">A/R (NR &lt;30%)</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">12</td><td class="item-name">ENG FUEL Valves</td><td class="item-action">OFF (0% NG)</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">13</td><td class="item-name">Fuel XFEED Switch</td><td class="item-action">CLOSED</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">14</td><td class="item-name">Ext. Lights / PFD Bright</td><td class="item-action">OFF / MIN</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">15</td><td class="item-name">Bus Tie</td><td class="item-action">AUTO</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">16</td><td class="item-name">Emergency Lights</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">17</td><td class="item-name">Electrical Switches</td><td class="item-action">OFF (15")</td><td class="check-col"><div class="check-box"></div></td></tr>
        </table>
      </div>
    </div>

    <!-- ------------------ IFR ------------------ -->
    <div class="section-panel" id="panel-ifr">
      <div class="reset-bar">
        <button class="check-all-btn" onclick="checkAll('ifr')">CHECK ALL</button>
        <button class="reset-btn" onclick="resetSection('ifr')">RESET</button>
      </div>
      <div class="progress-bar-wrap">
        <div class="progress-bar"><div class="progress-fill" id="prog-ifr" style="width:0%"></div></div>
        <div class="progress-label" id="label-ifr">0 / 0</div>
      </div>

      <div class="cl-section" data-section="ifr">
        <div class="cl-section-header">IFR DEPARTURE BRIEFING</div>
        <table class="cl-table">
          <tr onclick="toggle(this)"><td class="item-num">1</td><td class="item-name">TEM Brief</td><td class="item-action">PERFORM</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">2</td><td class="item-name">Departure Plate</td><td class="item-action">REVIEW</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">3</td><td class="item-name">Nav Aids</td><td class="item-action">TUNED / AUTO</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">4</td><td class="item-name">MCDU/ PFD / MFD / ESIS</td><td class="item-action">DEPTARTURE / ALTA / CRS SET</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">5</td><td class="item-name">Altimeters</td><td class="item-action">3 SET / X CHECK</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">6</td><td class="item-name">ATC Clearance</td><td class="item-action">OBTAINE</td><td class="check-col"><div class="check-box"></div></td></tr>
        </table>
      </div>

      <div class="cl-section" data-section="ifr">
        <div class="cl-section-header">IFR ARRIVAL BRIEFING</div>
        <table class="cl-table">
          <tr onclick="toggle(this)"><td class="item-num">1</td><td class="item-name">WHOLDS</td><td class="item-action">COMPLETE</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">2</td><td class="item-name">TEM Brief</td><td class="item-action"> PERFORM</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">3</td><td class="item-name">Nav Aids</td><td class="item-action">TUNED / AUTO / RAIM</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">4</td><td class="item-name">MCDU</td><td class="item-action">ARRIVAL</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">5</td><td class="item-name">Nav Source / PFD / ESIS</td><td class="item-action">(NAV / PREVIEW / LNAV) / CRS / DH</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">6</td><td class="item-name">Altimeters</td><td class="item-action">SET / X CHECK</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">7</td><td class="item-name">APP Button</td><td class="item-action">PRESS (-5NM /30°)</td><td class="check-col"><div class="check-box"></div></td></tr>


        </table>
      </div>

      <div class="cl-section" data-section="ifr">
        <div class="cl-section-header">IFR DEP / APP CHECKS</div>
        <div class="pilot-header"><span>LHP</span><span>RHP</span></div>
        <table class="cl-table">
          <tr onclick="toggle(this)"><td class="item-num">1</td><td class="item-name">WX / ATIS</td><td class="item-action">QNH (L/C/R)</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">2</td><td class="item-name">MCDU / FMS</td><td class="item-action">SET / RAIM</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">3</td><td class="item-name">NAV Aids</td><td class="item-action">TUNE ~ IDENT.</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">4</td><td class="item-name">PFD / MFD / ESIS</td><td class="item-action">SET</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">5</td><td class="item-name">Departure / Approach Plate</td><td class="item-action">REVIEW / BRIEF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">6</td><td class="item-name">IFR DEP / APP Checks</td><td class="item-action">COMPLETE</td><td class="check-col"><div class="check-box"></div></td></tr>
        </table>
      </div>
    </div>

    <!-- ------------------ SUBSEQUENT STARTS ------------------ -->
    <div class="section-panel" id="panel-subsequent">
      <div class="reset-bar">
        <button class="check-all-btn" onclick="checkAll('subsequent')">CHECK ALL</button>
        <button class="reset-btn" onclick="resetSection('subsequent')">RESET</button>
      </div>
      <div class="progress-bar-wrap">
        <div class="progress-bar"><div class="progress-fill" id="prog-subsequent" style="width:0%"></div></div>
        <div class="progress-label" id="label-subsequent">0 / 0</div>
      </div>
      <div class="cl-section" data-section="subsequent">
        <div class="cl-section-header">BEFORE STARTING ENGINES – Subsequent Starts</div>
        <div class="pilot-header"><span>LHP</span><span>RHP</span></div>
        <table class="cl-table">
          <tr onclick="toggle(this)"><td class="item-num">1</td><td class="item-name">CBs / Switches / Rotor Brake</td><td class="item-action">SET</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">2</td><td class="item-name">pedestal Switches</td><td class="item-action">SET</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">3</td><td class="item-name">LDG Lever / DAS</td><td class="item-action">DOWN / 3 PINS</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">4</td><td class="item-name">ENG GOV Switches</td><td class="item-action">SET</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">5</td><td class="item-name">Parking Brake</td><td class="item-action">SET</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">6</td><td class="item-name">Chocks</td><td class="item-action">REMOVED</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">7</td><td class="item-name">Electrical Switches</td><td class="item-action">ON</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">8</td><td class="item-name">External Lights</td><td class="item-action">ON (A/R)</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">9</td><td class="item-name">Chocks</td><td class="item-action">REMOVED</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">10</td><td class="item-name">CAS Messages</td><td class="item-action">CHECK</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">11</td><td class="item-name">MFD</td><td class="item-action">MAP / PLAN BOXES SET</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">12</td><td class="item-name">PFD</td><td class="item-action">(BEAR / HSI / ALTA) SET</td><td class="check-col"><div class="check-box"></div></td></tr>



        </table>
      </div>

      <div class="cl-section" data-section="subsequent">
        <div class="cl-section-header">ENGINE START – Subsequent Starts</div>
        <div class="pilot-header"><span>LHP</span><span>RHP</span></div>
        <table class="cl-table">
          <tr onclick="toggle(this)"><td class="item-num">1</td><td class="item-name">ATIS / Clearance</td><td class="item-action">OBTAIN</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row"onclick="toggle(this)"><td class="item-num" style="color:var(--gold)">2</td><td class="item-name">Bus Tie (2) / PFD Bright</td><td class="item-action">ON / INCREASE</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row"onclick="toggle(this)"><td class="item-num" style="color:var(--gold)">3</td><td class="item-name">ENG FUEL Switch</td><td class="item-action">ON</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row"onclick="toggle(this)"><td class="item-num" style="color:var(--gold)">4</td><td class="item-name">ENG FUEL PUMP</td><td class="item-action">ON / CHECK PRESS</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row"onclick="toggle(this)"><td class="item-num" style="color:var(--gold)">5</td><td class="item-name">Main Bus</td><td class="item-action">MINIMUM 23V</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row"onclick="toggle(this)"><td class="item-num" style="color:var(--gold)">6</td><td class="item-name">ENG MODE Switch</td><td class="item-action">IDLE</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row"onclick="toggle(this)"><td class="item-num" style="color:var(--gold)">7</td><td class="item-name">ENG MODE Switch</td><td class="item-action">FLIGHT (at 65% ± 1%)</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row"onclick="toggle(this)"><td class="item-num" style="color:var(--gold)">8</td><td class="item-name">GEN</td><td class= "item-action">ON LINE / CHECK LOAD</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row"onclick="toggle(this)"><td class="item-num" style="color:var(--gold)">9</td><td class="item-name">Bus Tie</td><td class="item-action">AUTO</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="row-repeat" onclick="repeatReset(this, 'subsequent', 2, 9)"><td colspan="4">REPEAT ITEMS 2 TO 9 FOR 2nd ENGINE</td></tr>
          <tr class="info-block" onclick="show('syschecks')" style="cursor:pointer;"><td colspan="3" style="text-align: center;"><strong class="info-link">GO TO SYS CHECKS MENU</strong></td></tr>
        </table>
      </div>
    </div>

    <!-- ------------------ POWER ASSURANCE CHECK ------------------ -->
    <div class="section-panel" id="panel-pac">
      <div class="reset-bar">
        <button class="check-all-btn" onclick="checkAll('pac')">CHECK ALL</button>
        <button class="reset-btn" onclick="resetSection('pac')">RESET</button>
      </div>
      <div class="progress-bar-wrap">
        <div class="progress-bar"><div class="progress-fill" id="prog-pac" style="width:0%"></div></div>
        <div class="progress-label" id="label-pac">0 / 0</div>
      </div>

      <div class="info-block">
        <strong style="color:var(--gold);">POWER ASSURANCE CHECK in HOVER FLIGHT (NR=100%)</strong><br>
        Área despejada – Nariz al viento – HEATER/COND OFF – GEN LOAD = 17%<br>
        Aumentar colectivo hasta liviano en ruedas o hover a 5 ft – NO EXCEDER TQ 105% – ITT 775°C – NG 102.4%<br>
        Estabilizar 1 minuto • registrar PA, OAT, TQ, ITT, NG • comparar con carta.<br>
        Los Ítems marcados con <strong style="color:var(--gold)"></strong> se repiten para el 2do motor.
      </div>

      <!-- CHECKLIST STEPS -->
      <div class="cl-section" data-section="pac">
        <div class="cl-section-header">PROCEDIMIENTO – Fig. 4-5  PWC PT6C-67C</div>
        <div class="pilot-header"><span>LHP</span><span>RHP</span></div>
        <table class="cl-table">
          <tr onclick="toggle(this)"><td class="item-num">1</td><td class="item-name">Posicionar aeronave enfrentada al viento</td><td class="item-action">AREA CLEAR</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">2</td><td class="item-name">HEATER / COND</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">3</td><td class="item-name">Nose Wheel</td><td class="item-action">LOCKED</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">4</td><td class="item-name">Altimeter</td><td class="item-action">STANDARD 1013mb</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">5</td><td class="item-name">Autopilots</td><td class="item-action">ON</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">6</td><td class="item-name">Bus Tie / GEN Load</td><td class="item-action">ON / = 17%</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">7</td><td class="item-name">NR</td><td class="item-action">100% (CAT A 102%)</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num" style="color:var(--gold)">8</td><td class="item-name">ENG MODE Switch (Motor a Probar)</td><td class="item-action">FLIGHT</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num" style="color:var(--gold)">9</td><td class="item-name">ENG MODE Switch (otro motor)</td><td class="item-action">IDLE</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num" style="color:var(--gold)">10</td><td class="item-name">Collective</td><td class="item-action">TQ = 90%</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num" style="color:var(--gold)">11</td><td class="item-name">Stabilize 1 min • Record PA, OAT, TQ, ITT, NG</td><td class="item-action">RECORD</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num" style="color:var(--gold)">12</td><td class="item-name">Collective → MPOG – ENG MODE (otro motor)</td><td class="item-action">FLIGHT</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="row-repeat" onclick="repeatReset(this, 'pac', 8, 12)"><td colspan="4">REPEAT ITEMS 8 TO 12 FOR 2nd ENGINE</td></tr>
          <tr onclick="toggle(this)"><td class="item-num">13</td><td class="item-name">Bus Tie</td><td class="item-action">AUTO</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">14</td><td class="item-name">Altimeter</td><td class="item-action">SET / X-CHECK QNH</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">15</td><td class="item-name">Ajustar Valores en la sección de abajo</td><td class="item-action">Ver abajo ↓</td><td class="check-col"><div class="check-box"></div></td></tr>
        </table>
      </div>

      <!-- --- POWER ASSURANCE APP (CALIBRADO) --- -->
      <div class="cl-section" style="margin-top:0;">
        <div class="cl-section-header" style="border-bottom-color:var(--pac-header-border);">
          POWER ASSURANCE DIGITAL (CALIBRADO)
        </div>
        <div style="background:var(--pac-panel-bg); padding:12px 16px; border-bottom:1px solid var(--pac-panel-border);">
          <div style="font-family:'Share Tech Mono',monospace; font-size:10px; color:var(--pac-label); letter-spacing:0.6px; line-height:1.6;">
            Se integra el modulo calibrado de Power Assurance con trazado y validacion de limites.
            Si necesitas recalibrar, usa el modo Admin dentro del modulo.
          </div>
        </div>
        <div style="background:var(--pac-panel-bg); padding:10px 16px; border-bottom:1px solid var(--pac-panel-border);">
          <div style="display:flex; gap:8px; flex-wrap:wrap;">
            <button type="button" style="font-family:'Barlow Condensed',sans-serif; font-size:11px; letter-spacing:1px; padding:6px 12px; border-radius:2px; border:1px solid var(--pac-btn-secondary-border); background:var(--pac-field-bg); color:var(--pac-field-text);">
              POWER ASSURANCE
            </button>
          </div>
        </div>
        <div style="background:var(--pac-canvas-bg); padding:12px 16px;">
          <div id="calc-host-pac" data-calc-tool-host data-tool-id="pac"></div>
        </div>
      </div>
</div><!-- /panel-pac -->

    <!-- ------------------ T/O & LANDING CAT PROFILES ------------------ -->
    <div class="section-panel" id="panel-profiles">
      <!-- sub-tab bar -->
      <div id="prof-tabs" class="prof-tabs">
        <button class="prof-tab active" id="ptab-to" onclick="profTab('to')">
          ▶ &nbsp;TAKE-OFF PROFILES
        </button>
        <button class="prof-tab" id="ptab-ldg" onclick="profTab('ldg')">
          ▶ &nbsp;LANDING PROFILES
        </button>
      </div>

      <!-- -- TAKE-OFF -- -->
      <div id="prof-to" class="prof-pane">
        <div class="prof-meta">
          PMC-39-A0126-CP001-00 – Issue 002 – 2025.02.28 – Leonardo Training Academy – Selecciona un perfil:
        </div>
        <div class="prof-help">
          • Selecciona el tipo de <strong>despegue</strong> a realizar para verificar los parámetros operacionales, límites de potencia y procedimientos de contingencia (RTO / CTO) antes de la maniobra.
        </div>
        <!-- Profile selector cards -->
        <div id="to-cards" style="display:flex; gap:8px; padding:10px 16px; flex-wrap:wrap;">
          <button class="prof-card" onclick="selectTO('catb')"     id="tocard-catb">CAT B</button>
          <button class="prof-card" onclick="selectTO('clear')"    id="tocard-clear">CAT A<br><small>CLEAR AREA</small></button>
          <button class="prof-card cat-a" onclick="selectTO('vertical')"  id="tocard-vertical">CAT A<br><small>G&amp;E H/H<br>VERTICAL</small></button>
          <button class="prof-card cat-a" onclick="selectTO('backup')"    id="tocard-backup">CAT A<br><small>G&amp;E H/H<br>BACK-UP</small></button>
          <button class="prof-card cat-a" onclick="selectTO('confined')"  id="tocard-confined">CAT A<br><small>CONFINED<br>AREA</small></button>
          <button class="prof-card cat-a" onclick="selectTO('short')"     id="tocard-short">CAT A<br><small>SHORT<br>FIELD</small></button>
        </div>
        <!-- Detail panel -->
        <div id="to-detail" style="display:none; padding:0 16px 16px;"></div>
      </div>

      <!-- -- LANDING -- -->
      <div id="prof-ldg" class="prof-pane" style="display:none;">
        <div class="prof-meta">
          PMC-39-A0126-CP001-00 – Issue 002 – 2025.02.28 – Leonardo Training Academy – Selecciona un perfil:
        </div>
        <div class="prof-help">
          • Selecciona el tipo de <strong>aterrizaje</strong> a realizar para verificar los parámetros operacionales, velocidades de referencia y procedimientos de contingencia (OEI / Balked Landing) antes de la maniobra.
        </div>
        <div id="ldg-cards" style="display:flex; gap:8px; padding:10px 16px; flex-wrap:wrap;">
          <button class="prof-card" onclick="selectLDG('catb')"          id="ldgcard-catb">CAT B</button>
          <button class="prof-card cat-a" onclick="selectLDG('clear')"   id="ldgcard-clear">CAT A<br><small>CLEAR AREA</small></button>
          <button class="prof-card cat-a" onclick="selectLDG('heli')"    id="ldgcard-heli">CAT A<br><small>HELIPORT</small></button>
          <button class="prof-card cat-a" onclick="selectLDG('heliv')"   id="ldgcard-heliv">CAT A<br><small>HELIPORT<br>VAR. LDP</small></button>
          <button class="prof-card cat-a" onclick="selectLDG('conf250')" id="ldgcard-conf250">CAT A<br><small>CONFINED<br>LDP =250ft</small></button>
          <button class="prof-card cat-a" onclick="selectLDG('confabv')" id="ldgcard-confabv">CAT A<br><small>CONFINED<br>LDP &gt;250ft</small></button>
        </div>
        <div id="ldg-detail" style="display:none; padding:0 16px 16px;"></div>
      </div>
    </div><!-- /panel-profiles -->

    <!-- ------------------ ABORT START ------------------ -->
    <div class="section-panel" id="panel-abort">
      <div class="banner amber">ABORTED ENGINE START PROCEDURES</div>

      <!-- CAUTION block -->
      <div class="abort-caution">
        <div class="abort-caution-title">⚠ CAUTION</div>
        <div class="abort-caution-text">
          Failure to follow the appropriate Abort Procedure may cause damage to the engine.
        </div>
      </div>

      <!-- Context / conditions block -->
      <div class="abort-context">
        Engine starting malfunctions are most likely to occur during the engine acceleration cycle to IDLE speed.<br><br>
        <span class="abort-context-accent">Monitor engine start and abort if any of the following occur:</span>
      </div>

      <!-- Abort trigger conditions -->
      <div class="abort-list">
        <table>
          <tr class="abort-list-row">
            <td class="abort-list-cell">
              <span class="abort-bullet">–</span>Light up is NOT within 10 seconds of ENG MODE to IDLE
            </td>
          </tr>
          <tr>
            <td class="abort-list-cell">
              <span class="abort-bullet">–</span>Abnormal noise heard
            </td>
          </tr>
          <tr class="abort-list-row">
            <td class="abort-list-cell">
              <span class="abort-bullet">–</span>ITT increases beyond engine limits <span class="abort-accent">(HOT START caution illuminated)</span>
            </td>
          </tr>
          <tr>
            <td class="abort-list-cell">
              <span class="abort-bullet">–</span>Engine hangs <span class="abort-accent">(stagnation in NG below 54%)</span>
            </td>
          </tr>
          <tr class="abort-list-row">
            <td class="abort-list-cell">
              <span class="abort-bullet">–</span>Main rotor has NOT begun to rotate when gas generator (NG) reaches 40%
            </td>
          </tr>
          <tr>
            <td class="abort-list-cell" style="border-bottom:none;">
              <span class="abort-bullet">–</span>Engine starter fails to disengage by <span class="abort-accent">49% NG</span>
            </td>
          </tr>
        </table>
      </div>

      <!-- Checklist -->
      <div class="cl-section" data-section="abort" style="margin-top:4px;">
        <div class="cl-section-header" style="border-bottom-color: var(--amber);">SHUT DOWN ENGINE – PROCEDURE</div>
        <table class="cl-table">
          <tr onclick="toggle(this)"><td class="item-num">1</td><td class="item-name">ENG MODE Switch</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row"><td colspan="5" class="abort-ff-note"><strong class="abort-ff-text">If Engine Does Not Shut Down</strong>  <span style="display:inline-block; width:16px;"></span><strong class="abort-ff-accent">ECL -OFF</strong></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">2</td><td class="item-name">FUEL PUMP Switch</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">3</td><td class="item-name">ENG FUEL Switch</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">4</td><td class="item-name">Perform Dry Motoring</td><td class="item-action">30 sec.</td><td class="check-col"><div class="check-box"></div></td></tr>
        </table>
      </div>

      <div class="reset-bar">
        <button class="check-all-btn" onclick="checkAll('abort')">CHECK ALL</button>
        <button class="reset-btn" onclick="resetSection('abort')">RESET</button>
      </div>
      <div class="progress-bar-wrap">
        <div class="progress-bar"><div class="progress-fill" id="prog-abort" style="width:0%"></div></div>
        <div class="progress-label" id="label-abort">0 / 0</div>
      </div>
    </div>

    <!-- ------------------ DRY MOTORING ------------------ -->
    <div class="section-panel" id="panel-drymot">
      <div class="banner green"> DRY MOTORING RUN</div>
      <div class="cl-section" data-section="drymot" style="margin-top:12px;">
        <div class="cl-section-header" style="border-bottom-color: var(--green);">DRY MOTORING RUN</div>
        <table class="cl-table">
          <tr class="ff-row"onclick="toggle(this)"><td class="item-num">1</td><td class="item-name">ENG GOV Switch</td><td class="item-action">AUTO</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">2</td><td class="item-name">ENG MODE Switch</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">3</td><td class="item-name">ECL</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">4</td><td class="item-name">FUEL PUMP Switch</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">5</td><td class="item-name">ENG FUEL Switch</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">6</td><td class="item-name">ENG IGN CB (White Ring)</td><td class="item-action">OUT</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">7</td><td class="item-name">ENG MODE Switch (45" max)</td><td class="item-action">IDLE</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">8</td><td class="item-name">NG</td><td class="item-action">Increasing</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">9</td><td class="item-name">ENG MODE Switch</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="ff-row" onclick="toggle(this)"><td class="item-num">10</td><td class="item-name">ENG IGN CB (White Ring)</td><td class="item-action">IN</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr class="row-repeat"><td colspan="4">REPEAT ALL ITEMS FOR 2nd ENGINE</td></tr>
        </table>
      </div>
      <div class="reset-bar">
        <button class="check-all-btn" onclick="checkAll('drymot')">CHECK ALL</button>
        <button class="reset-btn" onclick="resetSection('drymot')">RESET</button>
      </div>
      <div class="progress-bar-wrap">
        <div class="progress-bar"><div class="progress-fill" id="prog-drymot" style="width:0%"></div></div>
        <div class="progress-label" id="label-drymot">0 / 0</div>
      </div>
    </div>

    <!-- ------------------ EXHAUST FIRE ------------------ -->
    <div class="section-panel" id="panel-exhaust">
      <div class="banner red">⚠ AFTER SHUTDOWN – ENGINE EXHAUST FIRE</div>
      <div class="info-block">
        Confirm Fire Warnings NOT illuminated before proceeding.<br>
        If fire persists after motoring – EVACUATE AIRCRAFT immediately.
      </div>
      <div class="cl-section" data-section="exhaust">
        <div class="cl-section-header" style="border-bottom-color: var(--red);">AFTER SHUTDOWN – ENGINE EXHAUST FIRE</div>
        <table class="cl-table">
          <tr onclick="toggle(this)"><td class="item-num">1</td><td class="item-name">Fire Warnings</td><td class="item-action">Confirm NOT Illuminated</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">2</td><td class="item-name">ENG GOV Switch</td><td class="item-action">MAN</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">3</td><td class="item-name">ENG IGN CB (White Ring)</td><td class="item-action">OUT</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">4</td><td class="item-name">BUS TIE Switch</td><td class="item-action">ON</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">5</td><td class="item-name">ECL</td><td class="item-action">OFF</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">6</td><td class="item-name">ECL Starter Pushbutton</td><td class="item-action">PUSH</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">7</td><td class="item-name">Gas Generator (NG)</td><td class="item-action">Note increasing</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)"><td class="item-num">8</td><td class="item-name">ECL Starter Pushbutton</td><td class="item-action">Push to STOP</td><td class="check-col"><div class="check-box"></div></td></tr>
          <tr onclick="toggle(this)" style="background:#2a0a0a;"><td class="item-num">9</td><td class="item-name" style="color:#ff6b6b; font-weight:700;">Rotors stopped → EVACUATE AIRCRAFT</td><td class="item-action" style="color:#ff6b6b;">⚠ EVACUATE</td><td class="check-col"><div class="check-box"></div></td></tr>
        </table>
      </div>
      <div class="reset-bar">
        <button class="reset-btn" onclick="resetSection('exhaust')">RESET</button>
      </div>
      <div class="progress-bar-wrap">
        <div class="progress-bar"><div class="progress-fill" id="prog-exhaust" style="width:0%"></div></div>
        <div class="progress-label" id="label-exhaust">0 / 0</div>
      </div>
    </div>

  </div><!-- /content -->
</div><!-- /main -->

  <!-- Update banner -->
  <div id="update-banner" class="update-banner" role="status" aria-live="polite">
    <span>Hay una nueva versión disponible.</span>
    <button id="update-btn" type="button">Actualizar</button>
  </div>

<script>
const labels = {
  cockpit: 'COCKPIT SAFETY / PRE-START',
  start: 'ENGINE START',
  syschecks: 'SYSTEM CHECKS',
  taxi: 'TAXI / TAKE-OFF',
  cruise: 'CRUISE / LANDING',
  shutdown: 'SHUT DOWN',
  ifr: 'IFR DEP / APP',
  subsequent: 'SUBSEQUENT STARTS',
  pac: 'POWER ASSURANCE CHECK',
  profiles: 'T/O & LANDING CATEGORY PROFILES',
  abort: 'ABORTED ENGINE START',
  drymot: 'DRY MOTORING RUN',
  exhaust: 'AFTER SHUTDOWN – EXHAUST FIRE'
};

// Registro escalable de modulos de calculo por carta.
// Para agregar otra carta: crear nuevo toolId con su src y altura.
const CALC_TOOL_REGISTRY = {
  pac: {
    title: 'AW139 Power Assurance',
    src: 'pac/index.html?module=pac',
    height: 'clamp(700px, 86vh, 1120px)'
  }
};

function getCurrentModeForIframes() {
  return localStorage.getItem('aw139-mode') || 'night';
}

function broadcastModeToCalcFrames(mode) {
  const next = mode || getCurrentModeForIframes();
  document.querySelectorAll('iframe[id^="calc-frame-"]').forEach((frame) => {
    try {
      frame.contentWindow?.postMessage({ type: 'AW139_MODE', mode: next }, '*');
    } catch (err) {
      // Ignore and continue with remaining frames.
    }
  });
}

function mountCalcToolHost(host) {
  if (!host) return;
  const toolId = host.dataset.toolId;
  const tool = CALC_TOOL_REGISTRY[toolId];
  if (!tool) {
    host.innerHTML = '<div style="padding:12px;color:var(--dim);font-family:\'Share Tech Mono\',monospace;">Tool no registrado.</div>';
    return;
  }
  if (host.dataset.mounted === '1') return;
  const frame = document.createElement('iframe');
  frame.id = `calc-frame-${toolId}`;
  frame.title = tool.title;
  frame.src = tool.src;
  frame.loading = 'lazy';
  frame.referrerPolicy = 'no-referrer';
  frame.style.display = 'block';
  frame.style.width = '100%';
  frame.style.height = tool.height;
  frame.style.border = '1px solid var(--pac-panel-border)';
  frame.style.borderRadius = '2px';
  frame.style.background = 'var(--pac-canvas-bg)';
  frame.addEventListener('load', () => {
    broadcastModeToCalcFrames(getCurrentModeForIframes());
  });
  host.innerHTML = '';
  host.appendChild(frame);
  host.dataset.mounted = '1';
}

function initCalcTools() {
  document.querySelectorAll('[data-calc-tool-host]').forEach(mountCalcToolHost);
}

function show(id) {
  document.querySelectorAll('.section-panel').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
  document.getElementById('panel-' + id).classList.add('active');
  document.getElementById('btn-' + id).classList.add('active');
  document.getElementById('section-label').textContent = labels[id];
  if (id === 'pac') setTimeout(initCalcTools, 50);
  updateProgress(id);
}

function toggle(row) {
  if (!row.onclick) return;
  row.classList.toggle('checked');
  const section = row.closest('[data-section]');
  if (section) updateProgressForSection(section.dataset.section);
}

function updateProgress(id) {
  const panel = document.getElementById('panel-' + id);
  const allClickable = panel.querySelectorAll('tr[onclick]');
  const checked = panel.querySelectorAll('tr.checked');
  const pct = allClickable.length ? (checked.length / allClickable.length * 100) : 0;
  const fill = document.getElementById('prog-' + id);
  const lbl = document.getElementById('label-' + id);
  if (fill) fill.style.width = pct + '%';
  if (lbl) lbl.textContent = checked.length + ' / ' + allClickable.length;
}

function updateProgressForSection(id) {
  // find the active panel
  const activePanel = document.querySelector('.section-panel.active');
  if (!activePanel) return;
  const panelId = activePanel.id.replace('panel-', '');
  updateProgress(panelId);
}

function resetSection(id) {
  const panel = document.getElementById('panel-' + id);
  panel.querySelectorAll('tr.checked').forEach(r => r.classList.remove('checked'));
  updateProgress(id);
}

function repeatReset(row, id, from, to) {
  const table = row.closest('table');
  if (!table) return;
  table.querySelectorAll('tr[onclick]').forEach(r => {
    const numEl = r.querySelector('.item-num');
    if (!numEl) return;
    const num = parseInt(numEl.textContent, 10);
    if (!Number.isNaN(num) && num >= from && num <= to) {
      r.classList.remove('checked');
    }
  });
  updateProgress(id);
}

function checkAll(id) {
  const panel = document.getElementById('panel-' + id);
  panel.querySelectorAll('tr[onclick]').forEach(r => r.classList.add('checked'));
  updateProgress(id);
}
// -------------------------------------------------------
// T/O & LANDING CAT PROFILES ENGINE
// Source: PMC-39-A0126-CP001-00 Issue 002 – 2025.02.28
// -------------------------------------------------------

const TO_PROFILES = {
  catb: {
    name: 'CAT B', color: 'var(--prof-title-catb)', badge: '#1a3a5a',
    params: [
      { label: 'NR Switch', value: '100%' },
      { label: 'PARK BRK', value: 'OFF' },
      { label: 'T.O. PWR', value: '5 ft HOV +5%' },
      { label: 'T.O. Attitude', value: 'CHANGE -7°' },
      { label: 'TDP', value: '50 ft / 50 KIAS (GATE)' },
      { label: 'VTOSS', value: '–' },
      { label: 'Climb Attitude', value: '–' },
      { label: 'VY', value: '80 KIAS' },
      { label: 'VY & 200 ft ATS*', value: 'LDG GEAR UP' },
    ],
    rto: [
      { label: 'Prior TDP – Collective', value: '100% NR' },
      { label: 'Cyclic', value: 'Flare to Reduce GS' },
      { label: 'Cushion Touchdown', value: '15° MAX NOSEUP – Running LDG' },
      { label: 'Attitude', value: '–' },
      { label: 'Collective', value: '–' },
    ],
    cto: null,
  },
  clear: {
    name: 'CAT A – CLEAR AREA', color: 'var(--prof-title-cata)', badge: '#3a2800',
    params: [
      { label: 'NR Switch', value: '102%' },
      { label: 'PARK BRK', value: 'OFF' },
      { label: 'T.O. PWR', value: '5 ft HOV +18%' },
      { label: 'T.O. Attitude', value: '-5°' },
      { label: 'TDP', value: '30 ft (50 KIAS achieved)' },
      { label: 'VTOSS', value: '50 KIAS' },
      { label: 'Climb Attitude', value: '~+5°' },
      { label: 'VY', value: '80 KIAS – NR SW 100%' },
      { label: 'VY & 200 ft ATS*', value: 'LDG GEAR UP' },
    ],
    rto: [
      { label: 'Prior TDP – Collective', value: '90% NR' },
      { label: 'Cyclic', value: 'Speed < 30 KTS GS' },
      { label: 'Cushion Touchdown', value: '5–10 ft – MAX 15° NOSEUP – Running LDG' },
      { label: 'Attitude', value: '+5°' },
      { label: 'Collective', value: 'DROOP TO MIN 90% NR – 2.5\' OEI – 160% PI' },
      { label: 'VTOSS', value: '50 KIAS' },
    ],
    cto: [
      { label: 'Positive ROC', value: 'NR to 102% – Climb 200 ft – Accel to VY – 5° Nose Up' },
      { label: 'VY', value: '80 KIAS – MCP OEI 140% PI – Climb to 1000 ft' },
      { label: 'Gear', value: 'UP' },
      { label: 'NR Switch', value: '100%' },
    ],
  },
  vertical: {
    name: 'CAT A – G&E H/H VERTICAL', color: 'var(--prof-title-cata)', badge: '#3a2800',
    params: [
      { label: 'NR Switch', value: '102%' },
      { label: 'PARK BRK', value: 'ON' },
      { label: 'T.O. PWR', value: '5 ft HOV +23% ± 2"' },
      { label: 'T.O. Attitude', value: '-10°, 0° @ TDP' },
      { label: 'TDP / TDPE', value: '_70_ / 35 ft' },
      { label: 'VTOSS', value: '40 KIAS' },
      { label: 'Climb Attitude', value: '~+5°' },
      { label: 'VY', value: '80 KIAS – NR SW 100%' },
      { label: 'VY & 200 ft ATS*', value: 'LDG GEAR UP' },
    ],
    rto: [
      { label: 'Prior TDP – Collective', value: '100% NR' },
      { label: 'Cyclic', value: 'Mantain Position over HPAD – -10° NOSE DN' },
      { label: 'Cushion Touchdown', value: '5–10 ft – 5 KTS GS MAX' },
      { label: 'Attitude', value: '-10°, 0°' },
      { label: 'Collective', value: 'DROOP TO MIN 90% NR – 2.5\' OEI – 160% PI' },
      { label: 'VTOSS', value: '40 KIAS' },
    ],
    cto: [
      { label: 'Positive ROC', value: 'NR to 102% – Climb 200 ft – Accel to VY – 5° Nose Up' },
      { label: 'VY', value: '80 KIAS – MCP OEI 140% PI – Climb to 1000 ft' },
      { label: 'Gear', value: 'UP' },
      { label: 'NR Switch', value: '100%' },
    ],
  },
  backup: {
    name: 'CAT A – G&E H/H BACK-UP', color: 'var(--prof-title-cata)', badge: '#3a2800',
    params: [
      { label: 'NR Switch', value: '102%' },
      { label: 'PARK BRK', value: 'ON' },
      { label: 'T.O. PWR', value: '5 ft HOV +23% ± 2"' },
      { label: 'T.O. Attitude', value: '-10°, 0° @ TDP' },
      { label: 'TDP / TDPE', value: '_400_ / 85 ft' },
      { label: 'VTOSS', value: '40 KIAS' },
      { label: 'Climb Attitude', value: '~+5°' },
      { label: 'VY', value: '80 KIAS – NR SW 100%' },
      { label: 'VY & 200 ft ATS*', value: 'LDG GEAR UP' },
    ],
    rto: [
      { label: 'Prior TDP – Collective', value: '100% NR' },
      { label: 'Cyclic', value: '-2° / 3° NOSE DN – Mantain HPAD in Chin Window' },
      { label: 'Cushion Touchdown', value: '5–10 ft – 5 KTS GS MAX' },
      { label: 'Attitude', value: '-10°, 0°' },
      { label: 'Collective', value: 'DROOP TO MIN 90% NR – 2.5\' OEI – 160% PI' },
      { label: 'VTOSS', value: '40 KIAS' },
    ],
    cto: [
      { label: 'Positive ROC', value: 'NR to 102% – Climb 200 ft – Accel to VY – 5° Nose Up' },
      { label: 'VY', value: '80 KIAS – MCP OEI 140% PI – Climb to 1000 ft' },
      { label: 'Gear', value: 'UP' },
      { label: 'NR Switch', value: '100%' },
    ],
  },
  confined: {
    name: 'CAT A – CONFINED AREA', color: 'var(--prof-title-cata)', badge: '#3a2800',
    params: [
      { label: 'NR Switch', value: '102%' },
      { label: 'PARK BRK', value: 'ON' },
      { label: 'T.O. PWR', value: '+10% (sin IBF) / +12% (con IBF) – MÁX +23%' },
      { label: 'T.O. Attitude', value: '-10°, 0° @ TDP' },
      { label: 'TDP / TDPE', value: '_400_ / 100 ft' },
      { label: 'VTOSS', value: '40 KIAS' },
      { label: 'Climb Attitude', value: '+5°' },
      { label: 'VY', value: '80 KIAS* – 100% NR' },
      { label: 'VY & 200 ft ATS*', value: 'LDG GEAR UP' },
    ],
    rto: [
      { label: 'Prior TDP – Collective', value: '100% NR' },
      { label: 'Cyclic', value: '-20° MAX NOSE DN @ 50 (20) ft ATS – 20° MAX NOSEUP CUSHION' },
      { label: 'Cushion Touchdown', value: '10–15 ft – 5 KTS GS MAX' },
      { label: 'Attitude', value: '-10°, 0°' },
      { label: 'Collective', value: 'SET 2.5 MIN PWR (PI 160) – DROOP MIN 90% NR' },
      { label: 'VTOSS', value: '40 KIAS' },
    ],
    cto: [
      { label: 'Positive ROC', value: 'NR to 102% – Climb 200 ft – 5° Nose Up' },
      { label: 'VY', value: '80 KIAS* – 100% NR – Gear UP' },
    ],
  },
  short: {
    name: 'CAT A – SHORT FIELD', color: 'var(--prof-title-cata)', badge: '#3a2800',
    params: [
      { label: 'NR Switch', value: '102%' },
      { label: 'PARK BRK', value: 'OFF' },
      { label: 'T.O. PWR', value: '5 ft HOV +23% ± 2"' },
      { label: 'T.O. Attitude', value: '-10°, 0° @ TDP / TDPE' },
      { label: 'TDP / TDPE', value: '_400_ / 35 ft' },
      { label: 'VTOSS', value: '40 KIAS' },
      { label: 'Climb Attitude', value: '~+5°' },
      { label: 'VY', value: '80 KIAS – NR SW 100%' },
      { label: 'VY & 200 ft ATS*', value: 'LDG GEAR UP' },
    ],
    rto: [
      { label: 'Prior TDP – Collective', value: '90% NR' },
      { label: 'Cyclic', value: '15° MAX NOSEUP – Running LDG 5–10 ft – 5 KTS GS MAX' },
      { label: 'Cushion Touchdown', value: '5–10 ft – 5 KTS GS MAX – MAX 15° NOSEUP – Running LDG' },
      { label: 'Attitude', value: '-10°, 0°' },
      { label: 'Collective', value: 'DROOP TO MIN 90% NR – 2.5\' OEI – 160% PI' },
      { label: 'VTOSS', value: '40 KIAS' },
    ],
    cto: [
      { label: 'Positive ROC', value: 'NR to 102% – Climb 200 ft – Accel to VY – 5° Nose Up' },
      { label: 'VY', value: '80 KIAS – MCP OEI 140% PI – Climb to 1000 ft' },
      { label: 'Gear', value: 'UP' },
      { label: 'NR Switch', value: '100%' },
    ],
  },
};

const LDG_PROFILES = {
  catb: {
    name: 'CAT B', color: 'var(--prof-title-catb)', badge: '#1a3a5a',
    params: [
      { label: 'NR Switch', value: '100%' },
      { label: 'PARK BRK', value: 'A/R' },
      { label: 'Initial Point', value: '200 ft ALS' },
      { label: 'ROD', value: '< 500 fpm' },
      { label: 'LDP', value: '50 ft ALS – 30 KIAS' },
      { label: 'Land', value: 'TO HIGE – MAX 15° NOSE UP' },
      { label: 'Touchdown Speed', value: 'Running or HOV – MAX 30 KTS GS' },
    ],
    oei: null,
    balked: null,
  },
  clear: {
    name: 'CAT A – CLEAR AREA', color: 'var(--prof-title-cata)', badge: '#3a2800',
    params: [
      { label: 'NR Switch', value: '102%' },
      { label: 'PARK BRK', value: 'OFF' },
      { label: 'Initial Point', value: '200 ft AGL' },
      { label: 'ROD', value: '< 500 fpm' },
      { label: 'LDP', value: '50 ft AGL – 50 KIAS – ROD < 350 fpm' },
      { label: 'Land', value: 'TO HIGE – MAX 15° NOSE UP' },
      { label: 'Touchdown Speed', value: 'MAX 5 KTS GS' },
    ],
    prior: [
      { label: 'Collective', value: 'DROOP TO MIN 90% NR' },
      { label: 'Attitude', value: '5° NOSE UP' },
      { label: 'VBLSS', value: '50 KIAS' },
    ],
    oei: [
      { label: 'Positive ROC', value: 'NR to 102% – Climb 200 ft AGL – Accel to VY' },
      { label: 'VY', value: '80 KIAS – Climb to 1000 ft – MCP OEI 140% PI' },
      { label: 'Gear', value: 'UP' },
      { label: 'NR Switch', value: '100%' },
    ],
    balked: [
      { label: 'Attitude', value: '0°' },
      { label: 'Speed', value: '40 KIAS' },
      { label: 'Nose', value: '5° NOSE UP' },
      { label: 'NR', value: '102%' },
      { label: 'Altitude', value: '200 ft OR LDP +100 ALS' },
      { label: 'Accelerate', value: 'To Vy' },
      { label: 'Power', value: '140 PI – to 1000 ft' },
      { label: 'NR Switch', value: '100%' },
      { label: 'Gear', value: 'UP' },
    ],
  },
  heli: {
    name: 'CAT A – HELIPORT', color: 'var(--prof-title-cata)', badge: '#3a2800',
    params: [
      { label: 'NR Switch', value: '102%' },
      { label: 'PARK BRK', value: 'ON' },
      { label: 'Initial Point', value: '200 ft ALS' },
      { label: 'ROD', value: '< 500 fpm' },
      { label: 'LDP', value: '50 ft ALS – 20 KIAS – ROD < 350 fpm' },
      { label: 'Land', value: 'TO HIGE – MAX 5 KTS GS at TCHDN' },
      { label: 'Cushion', value: '20 ft ALS – MAX 15° NOSE UP' },
      { label: 'Touchdown Speed', value: 'MAX 5 KTS GS' },
    ],
    prior: [
      { label: 'Collective', value: 'DROOP TO MIN 90% NR' },
      { label: 'Attitude', value: '5° NOSE UP' },
      { label: 'VBLSS', value: '40 KIAS' },
    ],
    oei: [
      { label: 'Positive ROC', value: 'NR to 102% – Climb 200 ft – Accel to VY' },
      { label: 'VY', value: '80 KIAS – Climb to 1000 ft – MCP OEI 140% PI' },
      { label: 'Gear', value: 'UP' },
      { label: 'NR Switch', value: '100%' },
    ],
    balked: [
      { label: 'Attitude', value: '0°' },
      { label: 'Speed', value: '40 KIAS' },
      { label: 'Nose', value: '5° NOSE UP' },
      { label: 'NR', value: '102%' },
      { label: 'Altitude', value: '200 ft OR LDP +100 ALS' },
      { label: 'Accelerate', value: 'To Vy' },
      { label: 'Power', value: '140 PI – to 1000 ft' },
      { label: 'NR Switch', value: '100%' },
      { label: 'Gear', value: 'UP' },
    ],
  },
  heliv: {
    name: 'CAT A – HELIPORT VARIABLE LDP', color: 'var(--prof-title-cata)', badge: '#3a2800',
    params: [
      { label: 'NR Switch', value: '102%' },
      { label: 'PARK BRK', value: 'ON' },
      { label: 'Initial Point', value: '150 ft + LDPv' },
      { label: 'ROD', value: '< 500 fpm' },
      { label: 'LDP', value: '_400_ 50 ft – 20 KIAS – ROD < 350 fpm' },
      { label: 'Land', value: 'TO HIGE – MAX 5 KTS GS at TCHDN' },
      { label: 'Cushion', value: '20 ft ALS – MIN 90% NR – MAX 15° NOSE UP' },
      { label: 'Touchdown Speed', value: 'MAX 5 KTS GS' },
    ],
    prior: [
      { label: 'Collective', value: 'DROOP TO MIN 90% NR' },
      { label: 'Attitude', value: '5° NOSE UP' },
      { label: 'VBLSS', value: '40 KIAS' },
    ],
    oei: [
      { label: 'Positive ROC', value: 'NR to 102% – Climb LDPv + 150 ft ALS' },
      { label: '200 ft ALS (LDPv+150ft)', value: '2° Nose Up – Accelerate to VY' },
      { label: 'VY', value: '80 KIAS – Climb to 1000 ft – MCP OEI 140% PI' },
      { label: 'Gear', value: 'UP' },
      { label: 'NR Switch', value: '100%' },
    ],
    balked: [
      { label: 'Attitude', value: '0°' },
      { label: 'Speed', value: '40 KIAS' },
      { label: 'Nose', value: '5° NOSE UP' },
      { label: 'NR', value: '102%' },
      { label: 'Altitude', value: '200 ft OR LDP +100 ALS' },
      { label: 'Accelerate', value: 'To Vy' },
      { label: 'Power', value: '140 PI – to 1000 ft' },
      { label: 'NR Switch', value: '100%' },
      { label: 'Gear', value: 'UP' },
    ],
  },
  conf250: {
    name: 'CAT A – CONFINED LDP = 250 ft ALS', color: 'var(--prof-title-cata)', badge: '#3a2800',
    params: [
      { label: 'NR Switch', value: '102%' },
      { label: 'PARK BRK', value: 'ON' },
      { label: 'Initial Point', value: '350 ft ALS' },
      { label: 'ROD', value: '400 to 500 fpm' },
      { label: 'Speed', value: 'Decel 30 KTS GS' },
      { label: 'LDP', value: '_400_ 250 ft ALS – 15/20 KTS GS' },
      { label: 'Land', value: 'TO HIGE – MAX 5 KTS GS at TCHDN' },
      { label: 'Cushion', value: '20 ft ALS – MIN 90% NR – MAX 15° NOSE UP' },
      { label: 'Touchdown Speed', value: 'MAX 5 KTS GS' },
    ],
    prior: [
      { label: 'Collective', value: 'DROOP TO MIN 90% NR' },
      { label: 'Attitude', value: '0°' },
      { label: 'VBLSS', value: '40 KIAS' },
    ],
    oei: [
      { label: 'OEI – Continue Descent', value: '4/500 fpm – 100% NR ±1%' },
      { label: '15 ft ALS Cushion', value: '90% NR MIN – 15° NOSE UP – MAX 5 KTS GS' },
    ],
    balked: [
      { label: 'Nose', value: '5° NOSE UP – NR 102%' },
      { label: 'Altitude', value: '200 ft OR LDP +100 ALS' },
      { label: 'Accelerate to VY', value: 'Power 140 PI – to 1000 ft' },
      { label: 'NR Switch', value: '100%' },
      { label: 'Gear', value: 'UP' },
    ],
  },
  confabv: {
    name: 'CAT A – CONFINED LDP > 250 ft ALS', color: 'var(--prof-title-cata)', badge: '#3a2800',
    params: [
      { label: 'NR Switch', value: '102%' },
      { label: 'PARK BRK', value: 'ON' },
      { label: 'Initial Point', value: 'LDP + 100 ft ALS' },
      { label: 'ROD', value: '400 to 500 fpm' },
      { label: 'Speed', value: 'Decel 30 KTS GS' },
      { label: 'LDP', value: '_400_ 250 ft – 15/20 KTS GS' },
      { label: 'Land', value: 'TO HIGE – MAX 5 KTS GS at TCHDN' },
      { label: 'Cushion', value: '15 ft ALS – 90% NR MIN – 15° NOSE UP' },
      { label: 'Touchdown Speed', value: 'MAX 5 KTS GS' },
    ],
    prior: [
      { label: 'Collective', value: 'DROOP TO MIN 90% NR' },
      { label: 'Attitude', value: '0°' },
      { label: 'VBLSS', value: '40 KIAS' },
    ],
    oei: [
      { label: 'OEI – Continue Descent', value: '4/500 fpm – 100% NR ±1%' },
      { label: '15 ft ALS Cushion', value: '90% NR MIN – 15° NOSE UP – MAX 5 KTS GS' },
    ],
    balked: [
      { label: 'Nose', value: '5° NOSE UP – NR 102%' },
      { label: 'Altitude', value: '200 ft OR LDP +100 ALS' },
      { label: 'Accelerate to VY', value: 'Power 140 PI – to 1000 ft' },
      { label: 'NR Switch', value: '100%' },
      { label: 'Gear', value: 'UP' },
    ],
  },
};

// -- RENDER HELPERS -------------------------------------

function makeParamGrid(items) {
  if (!items || !items.length) return '<div class="prof-note">– No aplica para este perfil –</div>';
  return `<div class="param-grid">${items.map(p =>
    `<div class="param-item"><div class="param-label">${p.label}</div><div class="param-value ${p.cls||''}">${p.value}</div></div>`
  ).join('')}</div>`;
}

function makePhase(badgeText, badgeStyle, titleText, items) {
  return `<div class="phase-block">
    <div class="phase-header">
      <span class="phase-badge" style="background:${badgeStyle};color:var(--phase-badge-text);">${badgeText}</span>
      <span class="phase-title">${titleText}</span>
    </div>
    <div class="phase-body">${makeParamGrid(items)}</div>
  </div>`;
}

function renderTO(key) {
  const p = TO_PROFILES[key];
  if (!p) return;
  // Mark card active
  document.querySelectorAll('#to-cards .prof-card').forEach(b => b.classList.remove('active'));
  document.getElementById('tocard-'+key).classList.add('active');

  const detail = document.getElementById('to-detail');
  detail.style.display = 'block';

  // Header
  let html = `<div style="display:flex;align-items:center;gap:12px;margin-bottom:6px;padding-top:4px;">
    <span style="font-family:'Bebas Neue',sans-serif;font-size:20px;letter-spacing:3px;color:${p.color};">${p.name}</span>
    <span style="font-family:'Share Tech Mono',monospace;font-size:9px;color:var(--dim);letter-spacing:1px;">PMC-39-A0126-CP001-00 – Issue 002</span>
  </div>
  <div style="font-family:'Share Tech Mono',monospace;font-size:9px;color:var(--prof-meta-muted);letter-spacing:0.5px;margin-bottom:10px;">
    * ATS = Above Terrain Surface &nbsp;|&nbsp; ALS = Above Landing Surface &nbsp;|&nbsp; AGL = Above Ground Level &nbsp;|&nbsp; HIGE = Hover In Ground Effect
  </div>`;
  html += makePhase('T/O', 'var(--phase-badge)', 'TAKE-OFF PARAMETERS', p.params);

  // Contingency tabs
  const hasCTO = !!p.cto;
  html += `<div class="phase-block">
    <div class="phase-header" style="padding:0;">
      <div class="cont-tabs" style="width:100%;">
        <button class="cont-tab rto active" id="totab-rto-${key}" onclick="contTab('to','${key}','rto')">▶ RTO – REJECTED T/O</button>
        ${hasCTO ? `<button class="cont-tab cto" id="totab-cto-${key}" onclick="contTab('to','${key}','cto')">▶ CTO – CONTINUED T/O</button>` : ''}
      </div>
    </div>
    <div class="phase-body" style="padding-top:0;">
      <div class="cont-pane active" id="topane-rto-${key}">
        <div class="phase-divider">AT OR BEFORE TDP</div>
        ${makeParamGrid(p.rto)}
      </div>
      ${hasCTO ? `<div class="cont-pane" id="topane-cto-${key}">
        <div class="phase-divider">AT OR AFTER TDP</div>
        ${makeParamGrid(p.cto)}
      </div>` : ''}
    </div>
  </div>`;

  detail.innerHTML = html;
}

function renderLDG(key) {
  const p = LDG_PROFILES[key];
  if (!p) return;
  document.querySelectorAll('#ldg-cards .prof-card').forEach(b => b.classList.remove('active'));
  document.getElementById('ldgcard-'+key).classList.add('active');

  const detail = document.getElementById('ldg-detail');
  detail.style.display = 'block';

  let html = `<div style="display:flex;align-items:center;gap:12px;margin-bottom:6px;padding-top:4px;">
    <span style="font-family:'Bebas Neue',sans-serif;font-size:20px;letter-spacing:3px;color:${p.color};">${p.name}</span>
    <span style="font-family:'Share Tech Mono',monospace;font-size:9px;color:var(--dim);letter-spacing:1px;">PMC-39-A0126-CP001-00 – Issue 002</span>
  </div>
  <div style="font-family:'Share Tech Mono',monospace;font-size:9px;color:var(--prof-meta-muted);letter-spacing:0.5px;margin-bottom:10px;">
    * ATS = Above Terrain Surface &nbsp;|&nbsp; ALS = Above Landing Surface &nbsp;|&nbsp; AGL = Above Ground Level &nbsp;|&nbsp; LDPv = LDP Variable
  </div>`;

  // Main approach params
  html += makePhase('LDG', 'var(--phase-badge)', 'LANDING PARAMETERS', p.params);

  // Prior to LDP
  if (p.prior) {
    html += makePhase('PRIOR LDP', 'var(--phase-badge-alt)', 'PRIOR TO LDP', p.prior);
  }

  // Contingency tabs
  const hasOEI   = !!p.oei;
  const hasBalked = !!p.balked;
  if (hasOEI || hasBalked) {
    html += `<div class="phase-block">
      <div class="phase-header" style="padding:0;">
        <div class="cont-tabs" style="width:100%;">
          ${hasOEI    ? `<button class="cont-tab oei active" id="ldgtab-oei-${key}"    onclick="contTab('ldg','${key}','oei')">▶ OEI – ONE ENG INOP</button>` : ''}
          ${hasBalked ? `<button class="cont-tab blk ${hasOEI?'':'active'}" id="ldgtab-blk-${key}" onclick="contTab('ldg','${key}','blk')">▶ BALKED LANDING</button>` : ''}
        </div>
      </div>
      <div class="phase-body" style="padding-top:0;">
        ${hasOEI ? `<div class="cont-pane active" id="ldgpane-oei-${key}">
          <div class="phase-divider">AT OR AFTER LDP – OEI</div>
          ${makeParamGrid(p.oei)}
        </div>` : ''}
        ${hasBalked ? `<div class="cont-pane ${hasOEI?'':'active'}" id="ldgpane-blk-${key}">
          <div class="phase-divider">BALKED LANDING</div>
          ${makeParamGrid(p.balked)}
        </div>` : ''}
      </div>
    </div>`;
  }

  detail.innerHTML = html;
}

function contTab(mode, key, sub) {
  // Deactivate all tabs and panes for this key/mode
  const prefix = mode === 'to' ? `totab-` : `ldgtab-`;
  const panePrefix = mode === 'to' ? `topane-` : `ldgpane-`;

  document.querySelectorAll(`[id^="${prefix}"][id$="-${key}"]`).forEach(t => t.classList.remove('active'));
  document.querySelectorAll(`[id^="${panePrefix}"][id$="-${key}"]`).forEach(p => p.classList.remove('active'));

  const tabEl  = document.getElementById(`${prefix}${sub}-${key}`);
  const paneEl = document.getElementById(`${panePrefix}${sub}-${key}`);
  if (tabEl)  tabEl.classList.add('active');
  if (paneEl) paneEl.classList.add('active');
}

function profTab(tab) {
  document.getElementById('prof-to').style.display  = tab === 'to'  ? 'block' : 'none';
  document.getElementById('prof-ldg').style.display = tab === 'ldg' ? 'block' : 'none';
  document.getElementById('ptab-to').classList.toggle('active',  tab === 'to');
  document.getElementById('ptab-ldg').classList.toggle('active', tab === 'ldg');
}

function selectTO(key)  { renderTO(key);  }
function selectLDG(key) { renderLDG(key); }

// --- SPLASH SCREEN DISMISS ---
window.addEventListener('load', () => {
  setTimeout(() => {
    const splash = document.getElementById('splash');
    if (splash) {
      splash.classList.add('hidden');
      setTimeout(() => splash.remove(), 700);
    }
  }, 1600); // show for 1.6s then fade
});

// --- OFFLINE FONT FALLBACK ---
// If Google Fonts fails (offline), inject local-equivalent stack
(function() {
  const testEl = document.createElement('span');
  testEl.style.cssText = 'font-family:"Bebas Neue";font-size:72px;visibility:hidden;position:absolute';
  testEl.textContent = 'W';
  document.body.appendChild(testEl);
  const bebasW = testEl.offsetWidth;
  testEl.style.fontFamily = 'Arial';
  const arialW = testEl.offsetWidth;
  document.body.removeChild(testEl);
  if (bebasW === arialW) {
    // Bebas Neue not loaded – inject CSS fallback
    const style = document.createElement('style');
    style.textContent = `
      .section-title, .cl-section-header, .phase-badge,
      .splash-title, .prof-card, .nav-btn {
        font-family: 'Arial Narrow', 'Impact', 'Arial', sans-serif !important;
        letter-spacing: 2px !important;
      }
      .cl-table td, .param-value, .param-label {
        font-family: 'Courier New', 'Courier', monospace !important;
      }
    `;
    document.head.appendChild(style);
    console.log('AW139 Checklist: offline mode – using system fonts');
  }
})();

// -------------------------------------------------------
// SISTEMA DE MODOS: DÍA / NOCHE / NVG
// NVG: paleta MIL-STD-3009 Clase A – R=0 en todos
//      los colores base, rango 450-580nm seguro para
//      intensificadores Gen III GaAs (600-930nm).
// -------------------------------------------------------

const MODES = { NIGHT: 'night', DAY: 'day', NVG: 'nvg' };

function applyMode(mode) {
  const root  = document.documentElement;
  const icon  = document.getElementById('mode-icon');
  const label = document.getElementById('mode-label');
  const nvgBtn = document.getElementById('nvg-toggle');

  // Limpiar atributos anteriores
  root.removeAttribute('data-mode');
  nvgBtn && nvgBtn.classList.remove('nvg-on');

  if (mode === MODES.DAY) {
    root.setAttribute('data-mode', 'day');
    if (icon)  icon.innerHTML   = `<svg class="m-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"> <circle cx="12" cy="12" r="4" stroke="currentColor" stroke-width="1.5"/> <line x1="12" y1="2" x2="12" y2="4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/> <line x1="12" y1="20" x2="12" y2="22" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/> <line x1="2" y1="12" x2="4" y2="12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/> <line x1="20" y1="12" x2="22" y2="12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/> <line x1="4.93" y1="4.93" x2="6.34" y2="6.34" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/> <line x1="17.66" y1="17.66" x2="19.07" y2="19.07" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/> <line x1="4.93" y1="19.07" x2="6.34" y2="17.66" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/> <line x1="17.66" y1="6.34" x2="19.07" y2="4.93" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>        </svg>`;
    if (label) label.textContent = 'DÍA';
  } else if (mode === MODES.NVG) {
    root.setAttribute('data-mode', 'nvg');
    if (icon)  icon.innerHTML   = `<svg class="m-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> <line x1="17" y1="4" x2="17" y2="4.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/> <line x1="20" y1="7" x2="20.5" y2="7" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/> <line x1="19" y1="3" x2="19.5" y2="2.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>        </svg>`;
    if (label) label.textContent = 'NOCHE';
    nvgBtn && nvgBtn.classList.add('nvg-on');
  } else {
    // NIGHT (default)
    if (icon)  icon.innerHTML   = `<svg class="m-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> <line x1="17" y1="4" x2="17" y2="4.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/> <line x1="20" y1="7" x2="20.5" y2="7" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/> <line x1="19" y1="3" x2="19.5" y2="2.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>        </svg>`;
    if (label) label.textContent = 'NOCHE';
  }

  localStorage.setItem('aw139-mode', mode);
  broadcastModeToCalcFrames(mode);
}

function toggleMode() {
  const current = localStorage.getItem('aw139-mode') || MODES.NIGHT;
  // Ciclo: NOCHE ? DÍA ? NOCHE (NVG es toggle independiente)
  if (current === MODES.NVG) {
    applyMode(MODES.NIGHT);   // salir de NVG también con este botón
  } else if (current === MODES.DAY) {
    applyMode(MODES.NIGHT);
  } else {
    applyMode(MODES.DAY);
  }
}

function toggleNVG() {
  const current = localStorage.getItem('aw139-mode') || MODES.NIGHT;
  if (current === MODES.NVG) {
    applyMode(MODES.NIGHT);   // desactivar NVG ? volver a noche
  } else {
    applyMode(MODES.NVG);     // activar NVG desde cualquier modo
  }
}

// Restaurar modo guardado al cargar
(function initMode() {
  const saved = localStorage.getItem('aw139-mode') || MODES.NIGHT;
  applyMode(saved);
})();

// Init progress
Object.keys(labels).forEach(id => updateProgress(id));

// Update banner control
const updateBanner = document.getElementById('update-banner');
const updateBtn = document.getElementById('update-btn');
let pendingSW = null;

function showUpdateBanner() {
  if (updateBanner) updateBanner.classList.add('show');
}

if (updateBtn) {
  updateBtn.addEventListener('click', () => {
    if (pendingSW) {
      pendingSW.postMessage({ type: 'SKIP_WAITING' });
    }
  });
}

// --- SERVICE WORKER REGISTRATION ---
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('./sw.js')
      .then(reg => {
        if (reg.waiting) {
          pendingSW = reg.waiting;
          showUpdateBanner();
        }

        reg.addEventListener('updatefound', () => {
          const newSW = reg.installing;
          if (!newSW) return;
          newSW.addEventListener('statechange', () => {
            if (newSW.state === 'installed' && navigator.serviceWorker.controller) {
              pendingSW = newSW;
              showUpdateBanner();
            }
          });
        });
      })
      .catch(err => console.warn('AW139 SW registration failed:', err));

    let refreshing = false;
    navigator.serviceWorker.addEventListener('controllerchange', () => {
      if (refreshing) return;
      refreshing = true;
      window.location.reload();
    });
  });
}
</script>
</body>
</html>







